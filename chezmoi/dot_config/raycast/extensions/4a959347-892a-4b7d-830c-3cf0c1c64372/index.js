"use strict";var K=Object.create;var g=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var J=Object.getOwnPropertyNames;var Z=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty;var Y=(r,e)=>{for(var t in e)g(r,t,{get:e[t],enumerable:!0})},P=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of J(e))!q.call(r,a)&&a!==t&&g(r,a,{get:()=>e[a],enumerable:!(n=H(e,a))||n.enumerable});return r};var m=(r,e,t)=>(t=r!=null?K(Z(r)):{},P(e||!r||!r.__esModule?g(t,"default",{value:r,enumerable:!0}):t,r)),X=r=>P(g({},"__esModule",{value:!0}),r);var oe={};Y(oe,{default:()=>V});module.exports=X(oe);var w=require("@raycast/api");var f=m(require("react")),o=require("@raycast/api");var d=m(require("node:fs")),y=m(require("node:path"));var L=m(require("node:child_process")),M=require("node:buffer"),p=m(require("node:stream")),W=require("node:util");var z=require("react/jsx-runtime");var x=globalThis;function T(r,e){let t=r instanceof Error?r.message:String(r);return(0,o.showToast)({style:o.Toast.Style.Failure,title:e?.title??"Something went wrong",message:e?.message??t,primaryAction:e?.primaryAction??U(r),secondaryAction:e?.primaryAction?U(r):void 0})}var U=r=>{let e=!0,t="[Extension Name]...",n="";try{let s=JSON.parse((0,d.readFileSync)((0,y.join)(o.environment.assetsPath,"..","package.json"),"utf8"));t=`[${s.title}]...`,n=`https://raycast.com/${s.owner||s.author}/${s.name}`,(!s.owner||s.access==="public")&&(e=!1)}catch{}let a=o.environment.isDevelopment||e,i=r instanceof Error?r?.stack||r?.message||"":String(r);return{title:a?"Copy Logs":"Report Error",onAction(s){s.hide(),a?o.Clipboard.copy(i):(0,o.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(t)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${i}
\`\`\`
`)}`)}}};var $=r=>!!r&&typeof r=="object"&&typeof r.removeListener=="function"&&typeof r.emit=="function"&&typeof r.reallyExit=="function"&&typeof r.listeners=="function"&&typeof r.kill=="function"&&typeof r.pid=="number"&&typeof r.on=="function",v=Symbol.for("signal-exit emitter"),E=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),x[v])return x[v];Object.defineProperty(x,v,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(e,t){this.listeners[e].push(t)}removeListener(e,t){let n=this.listeners[e],a=n.indexOf(t);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(e,t,n){if(this.emitted[e])return!1;this.emitted[e]=!0;let a=!1;for(let i of this.listeners[e])a=i(t,n)===!0||a;return e==="exit"&&(a=this.emit("afterExit",t,n)||a),a}},A=class{onExit(){return()=>{}}load(){}unload(){}},R=class{#o;#t;#e;#s;#i;#a;#n;#r;constructor(e){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new E,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=e,this.#a={};for(let t of this.#r)this.#a[t]=()=>{let n=this.#e.listeners(t),{count:a}=this.#t,i=e;if(typeof i.__signal_exit_emitter__=="object"&&typeof i.__signal_exit_emitter__.count=="number"&&(a+=i.__signal_exit_emitter__.count),n.length===a){this.unload();let s=this.#t.emit("exit",null,t),c=t==="SIGHUP"?this.#o:t;s||e.kill(e.pid,c)}};this.#i=e.reallyExit,this.#s=e.emit}onExit(e,t){if(!$(this.#e))return()=>{};this.#n===!1&&this.load();let n=t?.alwaysLast?"afterExit":"exit";return this.#t.on(n,e),()=>{this.#t.removeListener(n,e),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let e of this.#r)try{let t=this.#a[e];t&&this.#e.on(e,t)}catch{}this.#e.emit=(e,...t)=>this.#l(e,...t),this.#e.reallyExit=e=>this.#c(e)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(e=>{let t=this.#a[e];if(!t)throw new Error("Listener not defined for signal: "+e);try{this.#e.removeListener(e,t)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(e){return $(this.#e)?(this.#e.exitCode=e||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(e,...t){let n=this.#s;if(e==="exit"&&$(this.#e)){typeof t[0]=="number"&&(this.#e.exitCode=t[0]);let a=n.call(this.#e,e,...t);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,e,...t)}},S=null,Q=(r,e)=>(S||(S=$(process)?new R(process):new A),S.onExit(r,e));function ee(r,{timeout:e}={}){let t=new Promise((c,l)=>{r.on("exit",(u,h)=>{c({exitCode:u,signal:h,timedOut:!1})}),r.on("error",u=>{l(u)}),r.stdin&&r.stdin.on("error",u=>{l(u)})}),n=Q(()=>{r.kill()});if(e===0||e===void 0)return t.finally(()=>n());let a,i=new Promise((c,l)=>{a=setTimeout(()=>{r.kill("SIGTERM"),l(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},e)}),s=t.finally(()=>{clearTimeout(a)});return Promise.race([i,s]).finally(()=>n())}var _=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function te(r){let{encoding:e}=r,t=e==="buffer",n=new p.default.PassThrough({objectMode:!1});e&&e!=="buffer"&&n.setEncoding(e);let a=0,i=[];return n.on("data",s=>{i.push(s),a+=s.length}),n.getBufferedValue=()=>t?Buffer.concat(i,a):i.join(""),n.getBufferedLength=()=>a,n}async function C(r,e){let t=te(e);return await new Promise((n,a)=>{let i=s=>{s&&t.getBufferedLength()<=M.constants.MAX_LENGTH&&(s.bufferedData=t.getBufferedValue()),a(s)};(async()=>{try{await(0,W.promisify)(p.default.pipeline)(r,t),n()}catch(s){i(s)}})(),t.on("data",()=>{t.getBufferedLength()>8e7&&i(new _)})}),t.getBufferedValue()}async function I(r,e){r.destroy();try{return await e}catch(t){return t.bufferedData}}async function re({stdout:r,stderr:e},{encoding:t},n){let a=C(r,{encoding:t}),i=C(e,{encoding:t});try{return await Promise.all([n,a,i])}catch(s){return Promise.all([{error:s,exitCode:null,signal:s.signal,timedOut:s.timedOut||!1},I(r,a),I(e,i)])}}function ne(r){let e=typeof r=="string"?`
`:10,t=typeof r=="string"?"\r":13;return r[r.length-1]===e&&(r=r.slice(0,-1)),r[r.length-1]===t&&(r=r.slice(0,-1)),r}function O(r,e){return r.stripFinalNewline?ne(e):e}function ae({timedOut:r,timeout:e,signal:t,exitCode:n}){return r?`timed out after ${e} milliseconds`:t!=null?`was killed with ${t}`:n!=null?`failed with exit code ${n}`:"failed"}function se({stdout:r,stderr:e,error:t,signal:n,exitCode:a,command:i,timedOut:s,options:c,parentError:l}){let h=`Command ${ae({timedOut:s,timeout:c?.timeout,signal:n,exitCode:a})}: ${i}`,b=t?`${h}
${t.message}`:h,k=[b,e,r].filter(Boolean).join(`
`);return t?t.originalMessage=t.message:t=l,t.message=k,t.shortMessage=b,t.command=i,t.exitCode=a,t.signal=n,t.stdout=r,t.stderr=e,"bufferedData"in t&&delete t.bufferedData,t}function ie({stdout:r,stderr:e,error:t,exitCode:n,signal:a,timedOut:i,command:s,options:c,parentError:l}){if(t||n!==0||a!==null)throw se({error:t,exitCode:n,signal:a,stdout:r,stderr:e,command:s,timedOut:i,options:c,parentError:l});return r}async function D(r,e,t){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:n,language:a,timeout:i,...s}=Array.isArray(e)?t||{}:e||{},c=n!==!1?[]:["-ss"];a==="JavaScript"&&c.push("-l","JavaScript"),Array.isArray(e)&&c.push("-",...e);let l=L.default.spawn("osascript",c,{...s,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),u=ee(l,{timeout:i??1e4});l.stdin.end(r);let[{error:h,exitCode:b,signal:k,timedOut:N},j,F]=await re(l,{encoding:"utf8"},u),B=O({stripFinalNewline:!0},j),G=O({stripFinalNewline:!0},F);return ie({stdout:B,stderr:G,error:h,exitCode:b,signal:k,timedOut:N,command:"osascript",options:t,parentError:new Error})}async function V(r){try{let t=(await(0,w.getApplications)()).find(a=>a.name==="HoudahSpot"),n=r.arguments.searchTerm||r.fallbackText||"";t?(await(0,w.closeMainWindow)(),await D(`
        tell application "HoudahSpot"
          if it is not running then launch
          activate
          search "${n}"
        end tell
    `)):await T("",{title:"HoudahSpot App is not installed"})}catch(e){await T(e,{title:"Error :("})}}
