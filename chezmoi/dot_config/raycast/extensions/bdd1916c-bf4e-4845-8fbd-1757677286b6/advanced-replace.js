"use strict";var Ae=Object.create;var Q=Object.defineProperty;var Ie=Object.getOwnPropertyDescriptor;var Te=Object.getOwnPropertyNames;var Ue=Object.getPrototypeOf,_e=Object.prototype.hasOwnProperty;var Oe=(e,t)=>{for(var r in t)Q(e,r,{get:t[r],enumerable:!0})},fe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Te(t))!_e.call(e,a)&&a!==r&&Q(e,a,{get:()=>t[a],enumerable:!(n=Ie(t,a))||n.enumerable});return e};var se=(e,t,r)=>(r=e!=null?Ae(Ue(e)):{},fe(t||!e||!e.__esModule?Q(r,"default",{value:e,enumerable:!0}):r,e)),De=e=>fe(Q({},"__esModule",{value:!0}),e);var Je={};Oe(Je,{default:()=>xe});module.exports=De(Je);var k=require("@raycast/api");var u=se(require("react")),m=require("@raycast/api");var de=Object.prototype.hasOwnProperty;function ee(e,t){var r,n;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((n=e.length)===t.length)for(;n--&&ee(e[n],t[n]););return n===-1}if(!r||typeof e=="object"){n=0;for(r in e)if(de.call(e,r)&&++n&&!de.call(t,r)||!(r in t)||!ee(e[r],t[r]))return!1;return Object.keys(t).length===n}}return e!==e&&t!==t}var V=se(require("node:fs")),te=se(require("node:path"));var pe=require("react/jsx-runtime");function Le(e){let t=(0,u.useRef)(e),r=(0,u.useRef)(0);return ee(e,t.current)||(t.current=e,r.current+=1),(0,u.useMemo)(()=>t.current,[r.current])}function U(e){let t=(0,u.useRef)(e);return t.current=e,t}function Me(e,t){let r=e instanceof Error?e.message:String(e);return(0,m.showToast)({style:m.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??he(e),secondaryAction:t?.primaryAction?he(e):void 0})}var he=e=>{let t=!0,r="[Extension Name]...",n="";try{let o=JSON.parse((0,V.readFileSync)((0,te.join)(m.environment.assetsPath,"..","package.json"),"utf8"));r=`[${o.title}]...`,n=`https://raycast.com/${o.owner||o.author}/${o.name}`,(!o.owner||o.access==="public")&&(t=!1)}catch{}let a=m.environment.isDevelopment||t,s=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:a?"Copy Logs":"Report Error",onAction(o){o.hide(),a?m.Clipboard.copy(s):(0,m.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};function H(e,t,r){let n=(0,u.useRef)(0),[a,s]=(0,u.useState)({isLoading:!0}),o=U(e),d=U(r?.abortable),c=U(t||[]),f=U(r?.onError),R=U(r?.onData),P=U(r?.onWillExecute),i=U(r?.failureToastOptions),l=U(a.data),h=(0,u.useRef)(null),v=(0,u.useRef)({page:0}),_=(0,u.useRef)(!1),S=(0,u.useRef)(!0),g=(0,u.useRef)(50),x=(0,u.useCallback)(()=>(d.current&&(d.current.current?.abort(),d.current.current=new AbortController),++n.current),[d]),C=(0,u.useCallback)((...M)=>{let T=x();P.current?.(M),s(p=>({...p,isLoading:!0}));let G=Fe(o.current)(...M);function K(p){return p.name=="AbortError"||T===n.current&&(f.current?f.current(p):m.environment.launchType!==m.LaunchType.Background&&Me(p,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(N){N.hide(),h.current?.(...c.current||[])}},...i.current}),s({error:p,isLoading:!1})),p}return typeof G=="function"?(_.current=!0,G(v.current).then(({data:p,hasMore:N,cursor:Pe})=>(T===n.current&&(v.current&&(v.current.cursor=Pe,v.current.lastItem=p?.[p.length-1]),R.current&&R.current(p,v.current),N&&(g.current=p.length),S.current=N,s(Ce=>v.current.page===0?{data:p,isLoading:!1}:{data:(Ce.data||[])?.concat(p),isLoading:!1})),p),p=>(S.current=!1,K(p)))):(_.current=!1,G.then(p=>(T===n.current&&(R.current&&R.current(p),s({data:p,isLoading:!1})),p),K))},[R,f,c,o,s,h,P,v,i,x]);h.current=C;let I=(0,u.useCallback)(()=>{v.current={page:0};let M=c.current||[];return C(...M)},[C,c]),L=(0,u.useCallback)(async(M,T)=>{let G;try{if(T?.optimisticUpdate){x(),typeof T?.rollbackOnError!="function"&&T?.rollbackOnError!==!1&&(G=structuredClone(l.current?.value));let K=T.optimisticUpdate;s(p=>({...p,data:K(p.data)}))}return await M}catch(K){if(typeof T?.rollbackOnError=="function"){let p=T.rollbackOnError;s(N=>({...N,data:p(N.data)}))}else T?.optimisticUpdate&&T?.rollbackOnError!==!1&&s(p=>({...p,data:G}));throw K}finally{T?.shouldRevalidateAfter!==!1&&(m.environment.launchType===m.LaunchType.Background||m.environment.commandMode==="menu-bar"?await I():I())}},[I,l,s,x]),ve=(0,u.useCallback)(()=>{v.current.page+=1;let M=c.current||[];C(...M)},[v,c,C]);(0,u.useEffect)(()=>{v.current={page:0},r?.execute!==!1?C(...t||[]):x()},[Le([t,r?.execute,C]),d,v]),(0,u.useEffect)(()=>()=>{x()},[x]);let Se=r?.execute!==!1?a.isLoading:!1,Ee={...a,isLoading:Se},Re=_.current?{pageSize:g.current,hasMore:S.current,onLoadMore:ve}:void 0;return{...Ee,revalidate:I,mutate:L,pagination:Re}}function Fe(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}var Z=(function(e){return e.Required="required",e})({});function ie(e,t){if(e){if(typeof e=="function")return e(t);if(e==="required"){let r=typeof t<"u"&&t!==null;if(r)switch(typeof t){case"string":r=t.length>0;break;case"object":Array.isArray(t)?r=t.length>0:t instanceof Date&&(r=t.getTime()>0);break;default:break}if(!r)return"The item is required"}}}function re(e){let{onSubmit:t,validation:r,initialValues:n={}}=e,[a,s]=(0,u.useState)(n),[o,d]=(0,u.useState)({}),c=(0,u.useRef)({}),f=U(r||{}),R=U(t),P=(0,u.useCallback)(S=>{c.current[S]?.focus()},[c]),i=(0,u.useCallback)(async S=>{let g=!1;for(let[C,I]of Object.entries(f.current)){let L=ie(I,S[C]);L&&(g||(g={},P(C)),g[C]=L)}if(g)return d(g),!1;let x=await R.current(S);return typeof x=="boolean"?x:!0},[f,R,P]),l=(0,u.useCallback)((S,g)=>{d(x=>({...x,[S]:g}))},[d]),h=(0,u.useCallback)(function(S,g){s(x=>({...x,[S]:typeof g=="function"?g(x[S]):g}))},[s]),v=(0,u.useMemo)(()=>new Proxy({},{get(S,g){let x=f.current[g],C=a[g];return{onChange(I){o[g]&&(ie(x,I)||l(g,void 0)),h(g,I)},onBlur(I){let L=ie(x,I.target.value);L&&l(g,L)},error:o[g],id:g,value:typeof C>"u"?null:C,ref:I=>{c.current[g]=I}}}}),[o,f,l,a,c,h]),_=(0,u.useCallback)(S=>{d({}),Object.entries(c.current).forEach(([g,x])=>{S?.[g]||x?.reset()}),S&&s(S)},[s,d,c]);return{handleSubmit:i,setValidationError:l,setValue:h,values:a,itemProps:v,focus:P,reset:_}}var O=require("@raycast/api");async function D(){return JSON.parse(await O.LocalStorage.getItem("regexOptions")??JSON.stringify([]))}async function W(e){if(!e){await(0,O.showToast)({style:O.Toast.Style.Failure,title:"No options",message:"Nothing was saved"});return}return O.LocalStorage.setItem("regexOptions",JSON.stringify(e))}async function oe(e,t,r){let n=await D(),a=n.length;if(a===0||e===t||e<0||e>=a||t<0||t>=a)return;let s=n.slice(),[o]=s.splice(e,1);o!==void 0&&(s.splice(t,0,o),await W(s),r?.())}async function me(e){if(await(0,O.confirmAlert)({title:"Really delete the item?",message:`You are about to delete the option ${e.title}.`})){let t=await D();W(t.filter(r=>r.id!==e.id))}else console.log("canceled")}async function ce(e){let r=(await D()).map(n=>n.id===e.id?{...n,lastUsed:new Date}:n);W(r)}var w=require("@raycast/api");var ne=require("react");var le=require("node:crypto");var ge="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var Ne=128,z,J;function Ve(e){!z||z.length<e?(z=Buffer.allocUnsafe(e*Ne),le.webcrypto.getRandomValues(z),J=0):J+e>z.length&&(le.webcrypto.getRandomValues(z),J=0),J+=e}function F(e=21){Ve(e|=0);let t="";for(let r=J-e;r<J;r++)t+=ge[z[r]&63];return t}var A=require("react/jsx-runtime");function be(){return{regex:"",key:"",id:F()}}function q({initialValues:e,isNew:t,children:r}){let{pop:n}=(0,w.useNavigation)(),{data:a,isLoading:s}=H(D),[o,d]=(0,ne.useState)(e?.regexItems||[be()]);function c(){d(i=>[...i,be()])}function f(i,l){d(h=>h.map((v,_)=>_===i?l:v))}let{handleSubmit:R,itemProps:P}=re({initialValues:e,onSubmit(i){if(t||!a||a.length<1)(a??[]).push({...i,id:F(),type:"cutPaste",regexItems:o});else{let l=a?.findIndex(h=>h.id===e.id);if(l===-1){(0,w.showToast)({style:w.Toast.Style.Failure,title:"Error",message:"Could not find item to update"});return}a[l]={...i,id:e.id,type:"cutPaste",lastUsed:new Date,regexItems:o}}W(a),(0,w.showToast)({style:w.Toast.Style.Success,title:"Success!",message:`${t?"New":"Updated"} Regex Option: ${i.title} (${i.description})`}),n()},validation:{title:Z.Required,output:Z.Required,regexItems:()=>{if(o.find(l=>!l.key||!l.regex))return"Each Regex item requires both a key and a regex pattern."}}});return(0,A.jsxs)(w.Form,{isLoading:s,actions:(0,A.jsxs)(w.ActionPanel,{children:[(0,A.jsx)(w.Action.SubmitForm,{title:"Submit",onSubmit:R}),(0,A.jsx)(w.Action,{title:"Add Replacement Item",onAction:c,shortcut:{modifiers:["cmd"],key:"n"}})]}),children:[r,(0,A.jsx)(w.Form.TextField,{title:"Title",placeholder:"My best regex ever",...P.title}),(0,A.jsx)(w.Form.TextArea,{title:"Description",placeholder:"Take the description and wrap it in a <strong> tag",...P.description}),(0,A.jsx)(w.Form.Separator,{}),o.map((i,l)=>(0,A.jsxs)(ne.Fragment,{children:[o?.length>1&&(0,A.jsx)(w.Form.Description,{text:"Item "+(l+1)}),(0,A.jsx)(w.Form.TextField,{id:i.id,title:"Key",info:"Use the Key name (e.g. KEY) without enclosing curly braces.",placeholder:"Enter key for regex item, e.g. KEY",value:i.key,onChange:h=>f(l,{...i,key:h})}),(0,A.jsx)(w.Form.TextField,{id:"regex"+l,title:"Regex",placeholder:'e.g. description="(.*)"',value:i.regex,onChange:h=>f(l,{...i,regex:h})})]},i.id)),(0,A.jsx)(w.Form.TextArea,{title:"Output",info:"Use regex capture groups to insert string that was matched.",placeholder:"<strong>{value}</strong>",...P.output})]})}var b=require("@raycast/api");var We=(e,t)=>t.reduce((r,{key:n,match:a})=>r.split(`{${n}}`).join(a),e),ue=(e,t)=>{e.type==="directReplace"?je(e,t):Be(e,t)},ze=(e,t,...r)=>{let n=e;return n=n.replace(/\$(\d+)/g,(a,s)=>{let o=parseInt(s,10)-1;return r[o]||""}),n=n.replace(/\$&/g,t),n=n.replace(/\\n/g,`
`),n=n.replace(/\\t/g,"	"),n=n.replace(/\\r/g,"\r"),n=n.replace(/\\\\/g,"\\"),n=n.replace(/\\U(.*?)\\E/g,(a,s)=>s.toUpperCase()),n=n.replace(/\\U(.*)$/g,(a,s)=>s.toUpperCase()),n=n.replace(/\\L(.*?)\\E/g,(a,s)=>s.toLowerCase()),n=n.replace(/\\L(.*)$/g,(a,s)=>s.toLowerCase()),n=n.replace(/\\u(.)/g,(a,s)=>s.toUpperCase()),n=n.replace(/\\l(.)/g,(a,s)=>s.toLowerCase()),n},je=async(e,t="copy")=>{await ce(e);try{let r=await(0,b.getSelectedText)().catch(()=>null),n=await b.Clipboard.readText(),a=r||n||"";if(!a){(0,b.showHUD)("No text found to replace.");return}let s=a;if(e.regexItems.forEach(o=>{if(!o.regex){(0,b.showToast)({title:"Action cancelled",message:"No regex was entered.",style:b.Toast.Style.Failure});return}if(!o.replacement){(0,b.showToast)({title:"Action cancelled",message:"No replacement was entered.",style:b.Toast.Style.Failure});return}let d=new RegExp(o.regex,(o.matchGlobally?"g":"")+(o.matchCaseInsensitive?"i":"")+(o.matchMultiline?"m":""));s=s.replace(d,(c,...f)=>ze(o.replacement,c,...f))}),s===a)return(0,b.showHUD)("No matches were found.");b.Clipboard[t](s),(0,b.showHUD)(t==="copy"?"Copied to clipboard.":"Pasted into place."),(0,b.popToRoot)()}catch(r){(0,b.showHUD)(`Error: ${r}`)}},Be=async(e,t="copy")=>{await ce(e);try{let r=await(0,b.getSelectedText)().catch(()=>null),n=await b.Clipboard.readText(),a=r||n||"";if(!a){(0,b.showHUD)("No text found to replace.");return}let s=[];if(e.regexItems.forEach(d=>{let c=a.match(new RegExp(d.regex,"m"));if(!c)return!1;s.push({key:d.key,match:c?.[1]??c?.[0]})}),!Array.isArray(s)||s.length<1)return(0,b.showHUD)("No matches were found.");let o=We(e.output,s);b.Clipboard[t](o),(0,b.showHUD)(t==="copy"?"Copied to clipboard.":"Pasted into place."),(0,b.popToRoot)()}catch(r){(0,b.showHUD)(`Error: ${r}`)}};var j=require("@raycast/api"),we=require("react");var $=require("@raycast/api");var ae=require("react"),E=require("react/jsx-runtime");function ye(){return{id:F(),regex:"",replacement:"",matchCaseInsensitive:!1,matchGlobally:!0,matchMultiline:!0}}function Y({initialValues:e,isNew:t,children:r}){let{pop:n}=(0,$.useNavigation)(),{data:a,isLoading:s}=H(D),[o,d]=(0,ae.useState)(e?.regexItems||[ye()]);function c(){d(i=>[...i,ye()])}function f(i,l){d(h=>h.map((v,_)=>_===i?l:v))}let{handleSubmit:R,itemProps:P}=re({initialValues:e,onSubmit(i){if(t||!a||a.length<1)(a??[]).push({...i,id:F(),type:"directReplace",lastUsed:new Date,regexItems:o});else{let l=a?.findIndex(h=>h.id===e.id);if(l===-1){(0,$.showToast)({style:$.Toast.Style.Failure,title:"Error",message:"Could not find item to update"});return}a[l]={...i,id:e.id,type:"directReplace",regexItems:o}}W(a),(0,$.showToast)({style:$.Toast.Style.Success,title:"Success!",message:`${t?"New":"Updated"} Regex Option: ${i.title} (${i.description})`}),n()},validation:{title:Z.Required,regexItems:()=>{if(o.find(l=>!l.replacement||!l.regex))return"Each Regex item requires both a replacement and a regex pattern."}}});return(0,E.jsxs)($.Form,{isLoading:s,actions:(0,E.jsxs)($.ActionPanel,{children:[(0,E.jsx)($.Action.SubmitForm,{title:"Submit",onSubmit:R}),(0,E.jsx)($.Action,{title:"Add Replacement Item",onAction:c,shortcut:{modifiers:["cmd"],key:"n"}})]}),children:[r,(0,E.jsx)($.Form.TextField,{title:"Title",placeholder:"My best regex ever",...P.title}),(0,E.jsx)($.Form.TextArea,{title:"Description",placeholder:"Take the description and wrap it in a <strong> tag",...P.description}),(0,E.jsx)($.Form.Separator,{}),o.map((i,l)=>(0,E.jsxs)(ae.Fragment,{children:[o.length>1&&(0,E.jsx)($.Form.Description,{text:"Item "+(l+1)}),(0,E.jsx)($.Form.TextField,{title:"Regex",placeholder:"e.g. \\s+",id:i.id+"regex",value:i.regex,onChange:h=>f(l,{...i,regex:h})}),(0,E.jsx)($.Form.TextArea,{title:"Replace with",placeholder:"e.g. -",id:i.id+"replacement",value:i.replacement,onChange:h=>f(l,{...i,replacement:h})}),(0,E.jsx)($.Form.Checkbox,{label:"Global match",id:i.id+"matchGlobally",value:i.matchGlobally,onChange:h=>f(l,{...i,matchGlobally:h})}),(0,E.jsx)($.Form.Checkbox,{label:"Multiline",id:i.id+"matchMultiline",value:i.matchMultiline,onChange:h=>f(l,{...i,matchMultiline:h})}),(0,E.jsx)($.Form.Checkbox,{label:"Case Insensitive",id:i.id+"matchCaseInsensitive",value:i.matchCaseInsensitive,onChange:h=>f(l,{...i,matchCaseInsensitive:h})})]},i.id))]})}var B=require("react/jsx-runtime"),$e=(e,t)=>(0,B.jsxs)(j.Form.Dropdown,{id:"type",title:"Type",defaultValue:e,onChange:r=>t(r),children:[(0,B.jsx)(j.Form.Dropdown.Item,{value:"directReplace",title:"Direct Replace",icon:j.Icon.Bolt}),(0,B.jsx)(j.Form.Dropdown.Item,{value:"cutPaste",title:"Cut Paste",icon:j.Icon.Code})]});function X({initialValues:e,isNew:t}){let[r,n]=(0,we.useState)(e?.type||"directReplace");return r==="directReplace"?(0,B.jsx)(Y,{initialValues:e,isNew:t,children:$e(r,n)}):(0,B.jsx)(q,{initialValues:e,isNew:t,children:$e(r,n)})}var ke=require("react"),y=require("react/jsx-runtime"),Ge={directReplace:{value:"Direct Replace",color:k.Color.Green},cutPaste:{value:"Cut Paste",color:k.Color.Magenta}},Ke=[{id:"recent",name:"Recent"},{id:"alphabetical",name:"Alphabetical"},{id:"manual",name:"Manual"}];function He(e){let{onOrderTypeChange:t}=e;return(0,y.jsx)(k.List.Dropdown,{tooltip:"Select Order Type",storeValue:!0,onChange:r=>{t(r)},children:Ke.map(r=>(0,y.jsx)(k.List.Dropdown.Item,{title:r.name,value:r.id},r.id))})}function xe(e){let{data:t,revalidate:r,isLoading:n}=H(D),[a,s]=(0,ke.useState)("manual");function o(c){s(c)}let d=[...t??[]];return a==="alphabetical"?d=d?.sort((c,f)=>c.title.localeCompare(f.title)):a==="recent"&&(d=d.sort((c,f)=>{if(c.lastUsed===void 0&&f.lastUsed===void 0)return 0;if(c.lastUsed===void 0)return 1;if(f.lastUsed===void 0)return-1;let R=new Date(c.lastUsed);return new Date(f.lastUsed).getTime()-R.getTime()})),(0,y.jsx)(k.List,{navigationTitle:"Regex replace options",isLoading:n,searchBarAccessory:(0,y.jsx)(He,{onOrderTypeChange:o}),actions:(0,y.jsx)(k.ActionPanel,{title:"Manage item",children:(0,y.jsx)(k.Action.Push,{title:"Create New",target:(0,y.jsx)(X,{initialValues:e.draftValues??{},isNew:!0}),shortcut:{modifiers:["cmd"],key:"n"},onPop:r})}),children:!!d&&d.map((c,f)=>(0,y.jsx)(k.List.Item,{title:c.title,subtitle:c.description,accessories:[{tag:Ge[c.type]}],actions:(0,y.jsxs)(k.ActionPanel,{title:"Manage item",children:[(0,y.jsx)(k.Action,{title:"Run and Paste",onAction:async()=>{await ue(c,"paste"),r()}}),(0,y.jsx)(k.Action,{title:"Run and Copy",onAction:async()=>{await ue(c,"copy"),r()}}),(0,y.jsx)(k.Action.Push,{title:"Create New",target:(0,y.jsx)(X,{initialValues:e.draftValues??{},isNew:!0}),shortcut:{modifiers:["cmd"],key:"n"},onPop:r}),(0,y.jsx)(k.Action.Push,{title:"Edit Item",target:c?.type==="cutPaste"?(0,y.jsx)(q,{initialValues:c}):(0,y.jsx)(Y,{initialValues:c}),shortcut:{modifiers:["cmd"],key:"e"},onPop:r}),(0,y.jsx)(k.Action.Push,{title:"Duplicate",target:(0,y.jsx)(X,{initialValues:{...c,id:F(),title:c.title+" (duplicated)"},isNew:!0}),shortcut:{modifiers:["cmd"],key:"d"},onPop:r}),a==="manual"&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(k.Action,{title:"Move up",shortcut:{modifiers:["cmd","opt"],key:"arrowUp"},onAction:async()=>{f>0&&await oe(f,f-1,r)}}),(0,y.jsx)(k.Action,{title:"Move Down",shortcut:{modifiers:["cmd","opt"],key:"arrowDown"},onAction:async()=>{f<d.length-1&&await oe(f,f+1,r)}})]}),(0,y.jsx)(k.Action,{title:"Delete",shortcut:{modifiers:["ctrl"],key:"x"},onAction:async()=>{await me(c),r()},style:k.Action.Style.Destructive})]})},c?.id??f))})}
