{
  "version": 3,
  "sources": ["../src/excel-beautifier-clipboard.tsx", "../src/parser/formula-types.ts", "../src/parser/types.ts", "../src/parser/parser.ts", "../src/parser/raw-text-formatter.ts", "../src/parser/excel-formula-parser.ts", "../src/parser/formulas-documentation.ts", "../src/parser/formula-extractor.ts"],
  "sourcesContent": ["import { Detail, Clipboard, showToast, Toast, ActionPanel, Action } from \"@raycast/api\";\nimport { useEffect, useState } from \"react\";\nimport { ExcelFormulaBeautifier } from \"./parser/excel-formula-parser\";\nimport { ExcelFormulaParser } from \"./parser/parser\";\nimport { extractFormulasFromExpression } from \"./parser/formula-extractor\";\n\nexport default function Command() {\n  const [beautified, setBeautified] = useState<string | null>(null);\n  const [formulas, setFormulas] = useState<ReturnType<typeof extractFormulasFromExpression>>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    async function getClipboardContent() {\n      try {\n        const clipboardContent = await Clipboard.readText();\n        if (!clipboardContent) {\n          showToast({\n            style: Toast.Style.Failure,\n            title: \"Error\",\n            message: \"No text found in clipboard\",\n          });\n          setIsLoading(false);\n          return;\n        }\n\n        // Check if it looks like an Excel formula\n        const trimmed = clipboardContent.trim();\n        if (!trimmed.startsWith(\"=\")) {\n          showToast({\n            style: Toast.Style.Animated,\n            title: \"Warning\",\n            message: \"Content doesn't start with '='. Treating as formula anyway.\",\n          });\n        }\n\n        try {\n          // Use our custom formatter with the new parser\n          const result = ExcelFormulaBeautifier.rawText(trimmed);\n          setBeautified(result);\n\n          // Extract formulas used in the expression\n          const parsed = ExcelFormulaParser.parse(trimmed);\n          const usedFormulas = extractFormulasFromExpression(parsed);\n          setFormulas(usedFormulas);\n\n          showToast({\n            style: Toast.Style.Success,\n            title: \"Success\",\n            message: \"Formula beautified\",\n          });\n        } catch (formulaError) {\n          showToast({\n            style: Toast.Style.Failure,\n            title: \"Invalid Excel formula\",\n            message: formulaError instanceof Error ? formulaError.message : String(formulaError),\n          });\n        }\n        setIsLoading(false);\n      } catch (err) {\n        showToast({\n          style: Toast.Style.Failure,\n          title: \"Error\",\n          message: `Failed to read clipboard: ${err}`,\n        });\n        setIsLoading(false);\n      }\n    }\n\n    getClipboardContent();\n  }, []);\n\n  if (isLoading) {\n    return <Detail isLoading={true} markdown=\"Reading from clipboard...\" />;\n  }\n\n  if (!beautified) {\n    return <Detail markdown=\"# No formula data available\" />;\n  }\n\n  const markdown = `# Beautified Formula\n\n\\`\\`\\`excel\n${beautified}\n\\`\\`\\`\n`;\n\n  const getCategoryColor = (category: string | undefined): string => {\n    const colorMap: Record<string, string> = {\n      Basic: \"#4CAF50\",\n      Conditional: \"#2196F3\",\n      Lookup: \"#FF9800\",\n      Text: \"#9C27B0\",\n      Math: \"#F44336\",\n      Date: \"#00BCD4\",\n    };\n    return colorMap[category || \"\"] || \"#9E9E9E\";\n  };\n\n  const renderDocumentation = () => {\n    const elements: React.ReactNode[] = [];\n    formulas.forEach((formula) => {\n      elements.push(\n        <Detail.Metadata.Label\n          key={`${formula.name}-desc`}\n          title={formula.name}\n          text={formula.doc?.description || \"No documentation available\"}\n        />,\n      );\n      if (formula.doc) {\n        elements.push(\n          <Detail.Metadata.TagList key={`${formula.name}-cat`} title=\"Category\">\n            <Detail.Metadata.TagList.Item text={formula.doc.category} color={getCategoryColor(formula.doc.category)} />\n          </Detail.Metadata.TagList>,\n        );\n        elements.push(<Detail.Metadata.Label key={`${formula.name}-syn`} title=\"Syntax\" text={formula.doc.syntax} />);\n        elements.push(<Detail.Metadata.Label key={`${formula.name}-ex`} title=\"Example\" text={formula.doc.example} />);\n        elements.push(<Detail.Metadata.Separator key={`${formula.name}-sep`} />);\n      }\n    });\n\n    return elements;\n  };\n\n  return (\n    <Detail\n      markdown={markdown}\n      metadata={\n        <Detail.Metadata>\n          {formulas.length > 0 && (\n            <>\n              <Detail.Metadata.TagList title=\"Formulas Used\">\n                {formulas.map((formula) => (\n                  <Detail.Metadata.TagList.Item\n                    key={formula.name}\n                    text={`${formula.name}${formula.count > 1 ? ` \u00D7${formula.count}` : \"\"}`}\n                    color={getCategoryColor(formula.doc?.category)}\n                  />\n                ))}\n              </Detail.Metadata.TagList>\n\n              <Detail.Metadata.Separator />\n\n              {renderDocumentation()}\n            </>\n          )}\n        </Detail.Metadata>\n      }\n      actions={\n        <ActionPanel>\n          <Action.CopyToClipboard\n            title=\"Copy Beautified Formula\"\n            content={beautified}\n            shortcut={{ modifiers: [\"cmd\"], key: \"c\" }}\n          />\n        </ActionPanel>\n      }\n    />\n  );\n}\n", "// Excel Formula Types Enumeration\n\nexport enum FormulaTypes {\n  // Logical functions (English)\n  IF = \"IF\",\n  IFS = \"IFS\",\n  AND = \"AND\",\n  OR = \"OR\",\n  NOT = \"NOT\",\n  IFERROR = \"IFERROR\",\n  IFNA = \"IFNA\",\n  ISERROR = \"ISERROR\",\n  ISNA = \"ISNA\",\n  ISBLANK = \"ISBLANK\",\n  ISNUMBER = \"ISNUMBER\",\n  ISTEXT = \"ISTEXT\",\n\n  // Logical functions (French)\n  SI = \"SI\",\n  SIS = \"SIS\",\n  ET = \"ET\",\n  OU = \"OU\",\n  NON = \"NON\",\n  SIERREUR = \"SIERREUR\",\n  SINA = \"SINA\",\n  ESTERREUR = \"ESTERREUR\",\n  ESTNA = \"ESTNA\",\n  ESTVIDE = \"ESTVIDE\",\n  ESTNUM = \"ESTNUM\",\n  ESTTEXTE = \"ESTTEXTE\",\n\n  // Math and statistical functions (English)\n  SUM = \"SUM\",\n  SUMIF = \"SUMIF\",\n  SUMIFS = \"SUMIFS\",\n  SUMPRODUCT = \"SUMPRODUCT\",\n  AVERAGE = \"AVERAGE\",\n  AVERAGEIF = \"AVERAGEIF\",\n  AVERAGEIFS = \"AVERAGEIFS\",\n  COUNT = \"COUNT\",\n  COUNTA = \"COUNTA\",\n  COUNTBLANK = \"COUNTBLANK\",\n  COUNTIF = \"COUNTIF\",\n  COUNTIFS = \"COUNTIFS\",\n  MAX = \"MAX\",\n  MAXA = \"MAXA\",\n  MIN = \"MIN\",\n  MINA = \"MINA\",\n  MEDIAN = \"MEDIAN\",\n  MODE = \"MODE\",\n  STDEV = \"STDEV\",\n  VAR = \"VAR\",\n\n  // Math and statistical functions (French)\n  SOMME = \"SOMME\",\n  SOMME_SI = \"SOMME.SI\",\n  SOMME_SI_ENS = \"SOMME.SI.ENS\",\n  SOMMEPROD = \"SOMMEPROD\",\n  MOYENNE = \"MOYENNE\",\n  MOYENNE_SI = \"MOYENNE.SI\",\n  MOYENNE_SI_ENS = \"MOYENNE.SI.ENS\",\n  NB = \"NB\",\n  NBVAL = \"NBVAL\",\n  NB_VIDE = \"NB.VIDE\",\n  NB_SI = \"NB.SI\",\n  NB_SI_ENS = \"NB.SI.ENS\",\n  MEDIANE = \"MEDIANE\",\n  ECARTYPE = \"ECARTYPE\",\n\n  // Math functions (English)\n  ROUND = \"ROUND\",\n  ROUNDUP = \"ROUNDUP\",\n  ROUNDDOWN = \"ROUNDDOWN\",\n  CEILING = \"CEILING\",\n  FLOOR = \"FLOOR\",\n  TRUNC = \"TRUNC\",\n  INT = \"INT\",\n  ABS = \"ABS\",\n  SQRT = \"SQRT\",\n  POWER = \"POWER\",\n  EXP = \"EXP\",\n  LN = \"LN\",\n  LOG = \"LOG\",\n  LOG10 = \"LOG10\",\n  MOD = \"MOD\",\n  RAND = \"RAND\",\n  RANDBETWEEN = \"RANDBETWEEN\",\n\n  // Math functions (French)\n  ARRONDI = \"ARRONDI\",\n  ARRONDI_SUP = \"ARRONDI.SUP\",\n  ARRONDI_INF = \"ARRONDI.INF\",\n  PLAFOND = \"PLAFOND\",\n  PLANCHER = \"PLANCHER\",\n  TRONQUE = \"TRONQUE\",\n  ENT = \"ENT\",\n  RACINE = \"RACINE\",\n  PUISSANCE = \"PUISSANCE\",\n  ALEA = \"ALEA\",\n  ALEA_ENTRE_BORNES = \"ALEA.ENTRE.BORNES\",\n\n  // Lookup and reference functions (English)\n  VLOOKUP = \"VLOOKUP\",\n  HLOOKUP = \"HLOOKUP\",\n  XLOOKUP = \"XLOOKUP\",\n  LOOKUP = \"LOOKUP\",\n  INDEX = \"INDEX\",\n  MATCH = \"MATCH\",\n  CHOOSE = \"CHOOSE\",\n  INDIRECT = \"INDIRECT\",\n  OFFSET = \"OFFSET\",\n  ROW = \"ROW\",\n  COLUMN = \"COLUMN\",\n  ROWS = \"ROWS\",\n  COLUMNS = \"COLUMNS\",\n\n  // Lookup and reference functions (French)\n  RECHERCHEV = \"RECHERCHEV\",\n  RECHERCHEH = \"RECHERCHEH\",\n  RECHERCHEX = \"RECHERCHEX\",\n  RECHERCHE = \"RECHERCHE\",\n  EQUIV = \"EQUIV\",\n  CHOISIR = \"CHOISIR\",\n  DECALER = \"DECALER\",\n  LIGNE = \"LIGNE\",\n  COLONNE = \"COLONNE\",\n  LIGNES = \"LIGNES\",\n  COLONNES = \"COLONNES\",\n\n  // Text functions (English)\n  CONCATENATE = \"CONCATENATE\",\n  CONCAT = \"CONCAT\",\n  TEXTJOIN = \"TEXTJOIN\",\n  LEFT = \"LEFT\",\n  RIGHT = \"RIGHT\",\n  MID = \"MID\",\n  LEN = \"LEN\",\n  FIND = \"FIND\",\n  SEARCH = \"SEARCH\",\n  SUBSTITUTE = \"SUBSTITUTE\",\n  REPLACE = \"REPLACE\",\n  UPPER = \"UPPER\",\n  LOWER = \"LOWER\",\n  PROPER = \"PROPER\",\n  TRIM = \"TRIM\",\n  CLEAN = \"CLEAN\",\n  VALUE = \"VALUE\",\n  TEXT = \"TEXT\",\n  CHAR = \"CHAR\",\n  CODE = \"CODE\",\n  EXACT = \"EXACT\",\n\n  // Text functions (French)\n  CONCATENER = \"CONCATENER\",\n  JOINDRE_TEXTE = \"JOINDRE.TEXTE\",\n  GAUCHE = \"GAUCHE\",\n  DROITE = \"DROITE\",\n  STXT = \"STXT\",\n  NBCAR = \"NBCAR\",\n  CHERCHE = \"CHERCHE\",\n  TROUVE = \"TROUVE\",\n  SUBSTITUE = \"SUBSTITUE\",\n  REMPLACER = \"REMPLACER\",\n  MAJUSCULE = \"MAJUSCULE\",\n  MINUSCULE = \"MINUSCULE\",\n  NOMPROPRE = \"NOMPROPRE\",\n  SUPPRESPACE = \"SUPPRESPACE\",\n  EPURAGE = \"EPURAGE\",\n  CNUM = \"CNUM\",\n  TEXTE = \"TEXTE\",\n  CAR = \"CAR\",\n\n  // Date and time functions (English)\n  TODAY = \"TODAY\",\n  NOW = \"NOW\",\n  DATE = \"DATE\",\n  TIME = \"TIME\",\n  YEAR = \"YEAR\",\n  MONTH = \"MONTH\",\n  DAY = \"DAY\",\n  HOUR = \"HOUR\",\n  MINUTE = \"MINUTE\",\n  SECOND = \"SECOND\",\n  WEEKDAY = \"WEEKDAY\",\n  WEEKNUM = \"WEEKNUM\",\n  WORKDAY = \"WORKDAY\",\n  NETWORKDAYS = \"NETWORKDAYS\",\n  EDATE = \"EDATE\",\n  EOMONTH = \"EOMONTH\",\n  DATEDIF = \"DATEDIF\",\n  DATEVALUE = \"DATEVALUE\",\n  TIMEVALUE = \"TIMEVALUE\",\n\n  // Date and time functions (French)\n  AUJOURDHUI = \"AUJOURDHUI\",\n  MAINTENANT = \"MAINTENANT\",\n  TEMPS = \"TEMPS\",\n  ANNEE = \"ANNEE\",\n  MOIS = \"MOIS\",\n  JOUR = \"JOUR\",\n  HEURE = \"HEURE\",\n  SECONDE = \"SECONDE\",\n  JOURSEM = \"JOURSEM\",\n  NO_SEMAINE = \"NO.SEMAINE\",\n  SERIE_JOUR_OUVRE = \"SERIE.JOUR.OUVRE\",\n  NB_JOURS_OUVRES = \"NB.JOURS.OUVRES\",\n  MOIS_DECALER = \"MOIS.DECALER\",\n  FIN_MOIS = \"FIN.MOIS\",\n  DATEVAL = \"DATEVAL\",\n  TEMPSVAL = \"TEMPSVAL\",\n\n  // Financial functions (English)\n  PMT = \"PMT\",\n  PV = \"PV\",\n  FV = \"FV\",\n  RATE = \"RATE\",\n  NPER = \"NPER\",\n  NPV = \"NPV\",\n  IRR = \"IRR\",\n  XIRR = \"XIRR\",\n  XNPV = \"XNPV\",\n\n  // Financial functions (French)\n  VPM = \"VPM\",\n  VA = \"VA\",\n  VC = \"VC\",\n  TAUX = \"TAUX\",\n  NPM = \"NPM\",\n  VAN = \"VAN\",\n  TRI = \"TRI\",\n  TRID = \"TRID\",\n  VAND = \"VAND\",\n\n  // Database functions (English)\n  DSUM = \"DSUM\",\n  DAVERAGE = \"DAVERAGE\",\n  DCOUNT = \"DCOUNT\",\n  DCOUNTA = \"DCOUNTA\",\n  DMAX = \"DMAX\",\n  DMIN = \"DMIN\",\n\n  // Database functions (French)\n  BDSOMME = \"BDSOMME\",\n  BDMOYENNE = \"BDMOYENNE\",\n  BDNB = \"BDNB\",\n  BDNBVAL = \"BDNBVAL\",\n  BDMAX = \"BDMAX\",\n  BDMIN = \"BDMIN\",\n\n  // Engineering functions (English)\n  CONVERT = \"CONVERT\",\n\n  // Array functions (newer Excel - English)\n  FILTER = \"FILTER\",\n  SORT = \"SORT\",\n  SORTBY = \"SORTBY\",\n  UNIQUE = \"UNIQUE\",\n  SEQUENCE = \"SEQUENCE\",\n  TRANSPOSE = \"TRANSPOSE\",\n\n  // Array functions (newer Excel - French)\n  FILTRE = \"FILTRE\",\n  TRIER = \"TRIER\",\n  TRIER_PAR = \"TRIER.PAR\",\n\n  // Exotic/Advanced functions (English)\n  LAMBDA = \"LAMBDA\",\n  LET = \"LET\",\n  MAKEARRAY = \"MAKEARRAY\",\n  MAP = \"MAP\",\n  REDUCE = \"REDUCE\",\n  SCAN = \"SCAN\",\n  RANDARRAY = \"RANDARRAY\",\n  SWITCH = \"SWITCH\",\n  AGGREGATE = \"AGGREGATE\",\n  SUBTOTAL = \"SUBTOTAL\",\n  FORECAST = \"FORECAST\",\n  TREND = \"TREND\",\n  LINEST = \"LINEST\",\n  LOGEST = \"LOGEST\",\n  GROWTH = \"GROWTH\",\n  PERCENTILE = \"PERCENTILE\",\n  QUARTILE = \"QUARTILE\",\n  RANK = \"RANK\",\n  PERCENTRANK = \"PERCENTRANK\",\n  SKEW = \"SKEW\",\n  KURT = \"KURT\",\n  COVAR = \"COVAR\",\n  CORREL = \"CORREL\",\n  RSQ = \"RSQ\",\n  INTERCEPT = \"INTERCEPT\",\n  SLOPE = \"SLOPE\",\n  STANDARDIZE = \"STANDARDIZE\",\n  PROB = \"PROB\",\n  POISSON = \"POISSON\",\n  BINOMIAL = \"BINOMIAL\",\n  COMBIN = \"COMBIN\",\n  PERMUT = \"PERMUT\",\n  BETA = \"BETA\",\n  GAMMA = \"GAMMA\",\n  WEIBULL = \"WEIBULL\",\n  LOGNORM = \"LOGNORM\",\n  HYPGEOM = \"HYPGEOM\",\n  NORMINV = \"NORMINV\",\n  NORMSDIST = \"NORMSDIST\",\n  NORMSINV = \"NORMSINV\",\n  TDIST = \"TDIST\",\n  TINV = \"TINV\",\n  FDIST = \"FDIST\",\n  FINV = \"FINV\",\n  CHITEST = \"CHITEST\",\n  CHIINV = \"CHIINV\",\n  ZTEST = \"ZTEST\",\n  TTEST = \"TTEST\",\n  T_TEST = \"T.TEST\",\n  FTEST = \"FTEST\",\n  F_TEST = \"F.TEST\",\n  CHI_TEST = \"CHI.TEST\",\n  ZTEST_ALT = \"Z.TEST\",\n  GEOMEAN = \"GEOMEAN\",\n  HARMEAN = \"HARMEAN\",\n  TRIMMEAN = \"TRIMMEAN\",\n  SMALL = \"SMALL\",\n  LARGE = \"LARGE\",\n  COUNTUNIQUE = \"COUNTUNIQUE\",\n  BYROW = \"BYROW\",\n  BYCOL = \"BYCOL\",\n  CONFIDENCE = \"CONFIDENCE\",\n  DEVSQ = \"DEVSQ\",\n  AVEDEV = \"AVEDEV\",\n  STDEVP = \"STDEVP\",\n  STDEVS = \"STDEVS\",\n  VARP = \"VARP\",\n  VARS = \"VARS\",\n  AVERAGEA = \"AVERAGEA\",\n  PRODUCT = \"PRODUCT\",\n  SUMSQ = \"SUMSQ\",\n  SUMX2MY2 = \"SUMX2MY2\",\n  SUMX2PY2 = \"SUMX2PY2\",\n  SUMXMY2 = \"SUMXMY2\",\n  MINVERSE = \"MINVERSE\",\n  MMULT = \"MMULT\",\n  MDETERM = \"MDETERM\",\n\n  // Exotic/Advanced functions (French)\n  CREER_MATRICE = \"CREER.MATRICE\",\n  APPLIQUER = \"APPLIQUER\",\n  REDUIRE = \"REDUIRE\",\n  ANALYSER = \"ANALYSER\",\n  CREER_ALEA_MATRICE = \"CREER.ALEA.MATRICE\",\n  BASCULER = \"BASCULER\",\n  SOUS_TOTAL = \"SOUS.TOTAL\",\n  PREVISION = \"PREVISION\",\n  TENDANCE = \"TENDANCE\",\n  DROITEREG = \"DROITEREG\",\n  LOGREG = \"LOGREG\",\n  CROISSANCE = \"CROISSANCE\",\n  RANG = \"RANG\",\n  PERCENTRANG = \"PERCENTRANG\",\n  CORRELATION = \"CORRELATION\",\n  COEFFICIENT_R2 = \"COEFFICIENT.R2\",\n  ORDONNEE_ORIGINE = \"ORDONNEE.ORIGINE\",\n  PENTE = \"PENTE\",\n  CENTRER_REDUIRE = \"CENTRER.REDUIRE\",\n  PROBABILITE = \"PROBABILITE\",\n  BINOM_DIST = \"BINOM.DIST\",\n  PERMUTATION = \"PERMUTATION\",\n  LOI_NORMALE_INVERSE = \"LOI.NORMALE.INVERSE\",\n  LOI_NORMALE_STANDARD = \"LOI.NORMALE.STANDARD\",\n  LOI_NORMALE_STANDARD_INVERSE = \"LOI.NORMALE.STANDARD.INVERSE\",\n  LOI_T = \"LOI.T\",\n  INVERSE_LOI_T = \"INVERSE.LOI.T\",\n  LOI_F = \"LOI.F\",\n  INVERSE_LOI_F = \"INVERSE.LOI.F\",\n  TEST_KHIDEUX = \"TEST.KHIDEUX\",\n  INVERSE_LOI_KHIDEUX = \"INVERSE.LOI.KHIDEUX\",\n  TEST_Z = \"TEST.Z\",\n  TEST_T = \"TEST.T\",\n  TEST_F = \"TEST.F\",\n  MOYENNE_GEOMETRIQUE = \"MOYENNE.GEOMETRIQUE\",\n  MOYENNE_HARMONIQUE = \"MOYENNE.HARMONIQUE\",\n  MOYENNE_TRIMMEE = \"MOYENNE.TRIMMEE\",\n  PETIT = \"PETIT\",\n  GRAND = \"GRAND\",\n  NBVAL_UNIQUE = \"NBVAL.UNIQUE\",\n  PAR_LIGNE = \"PAR.LIGNE\",\n  PAR_COLONNE = \"PAR.COLONNE\",\n  INTERVALLE_CONFIANCE = \"INTERVALLE.CONFIANCE\",\n  SOMME_CARRES_ECARTS = \"SOMME.CARRES.ECARTS\",\n  MOYENNE_ECARTS = \"MOYENNE.ECARTS\",\n  ECARTYPE_POP = \"ECARTYPE.POP\",\n  ECARTYPE_ECHE = \"ECARTYPE.ECHE\",\n  VAR_POP = \"VAR.POP\",\n  VAR_ECHE = \"VAR.ECHE\",\n  MOYENNEA = \"MOYENNEA\",\n  PRODUIT = \"PRODUIT\",\n  SOMME_CARRES = \"SOMME.CARRES\",\n  SOMME_DIFF_CARRES = \"SOMME.DIFF.CARRES\",\n  SOMME_SOMME_CARRES = \"SOMME.SOMME.CARRES\",\n  SOMME_DIFF_CARRES_Y = \"SOMME.DIFF.CARRES.Y\",\n  INVERSE_MATRICE = \"INVERSE.MATRICE\",\n  PRODUIT_MATRICE = \"PRODUIT.MATRICE\",\n  DETERMINANT_MATRICE = \"DETERMINANT.MATRICE\",\n}\n", "// Core types and interfaces for Excel Formula Parser\n\nimport { FormulaTypes } from \"./formula-types\";\n\nexport class ExcelExpression {\n  readonly original: string;\n  private childs: Array<ExcelExpression> = [];\n\n  constructor(original: string) {\n    this.original = original;\n  }\n\n  addChild(child: ExcelExpression): void {\n    this.childs.push(child);\n  }\n\n  getChilds(): Array<ExcelExpression> {\n    return this.childs;\n  }\n}\n\nexport class SubExpression extends ExcelExpression {}\n\nexport class FormulaExpr extends ExcelExpression {\n  readonly formula: FormulaTypes;\n\n  constructor(original: string, formula: FormulaTypes) {\n    super(original);\n    this.formula = formula;\n  }\n}\n\nexport class SimpleExpression extends ExcelExpression {}\n\nexport class OperatorExpression extends ExcelExpression {\n  readonly operator: string;\n\n  constructor(operator: string) {\n    super(operator);\n    this.operator = operator;\n  }\n}\n\nexport class CellReferenceExpression extends ExcelExpression {\n  readonly sheet?: string; // Sheet name (e.g., \"Sheet1\" in \"Sheet1!A1\")\n  readonly column: string; // Column letter(s) (e.g., \"A\", \"AB\")\n  readonly row: string; // Row number (e.g., \"1\", \"100\")\n  readonly isColumnAbsolute: boolean; // True if column has $ (e.g., \"$A1\")\n  readonly isRowAbsolute: boolean; // True if row has $ (e.g., \"A$1\")\n\n  constructor(\n    original: string,\n    sheet: string | undefined,\n    column: string,\n    row: string,\n    isColumnAbsolute: boolean,\n    isRowAbsolute: boolean,\n  ) {\n    super(original);\n    this.sheet = sheet;\n    this.column = column;\n    this.row = row;\n    this.isColumnAbsolute = isColumnAbsolute;\n    this.isRowAbsolute = isRowAbsolute;\n  }\n\n  getFullReference(): string {\n    const sheetPrefix = this.sheet ? `${this.sheet}!` : \"\";\n    const colPrefix = this.isColumnAbsolute ? \"$\" : \"\";\n    const rowPrefix = this.isRowAbsolute ? \"$\" : \"\";\n    return `${sheetPrefix}${colPrefix}${this.column}${rowPrefix}${this.row}`;\n  }\n}\n\nexport class CellRangeExpression extends ExcelExpression {\n  readonly sheet?: string; // Sheet name if specified\n  readonly startCell: CellReferenceExpression;\n  readonly endCell: CellReferenceExpression;\n\n  constructor(\n    original: string,\n    sheet: string | undefined,\n    startCell: CellReferenceExpression,\n    endCell: CellReferenceExpression,\n  ) {\n    super(original);\n    this.sheet = sheet;\n    this.startCell = startCell;\n    this.endCell = endCell;\n  }\n\n  getFullReference(): string {\n    const sheetPrefix = this.sheet ? `${this.sheet}!` : \"\";\n    return `${sheetPrefix}${this.startCell.getFullReference().replace(/^.*!/, \"\")}:${this.endCell.getFullReference().replace(/^.*!/, \"\")}`;\n  }\n}\n\nexport interface FormattingOptions {\n  useNestingIndicators?: boolean;\n  useOperatorSpacing?: boolean;\n  indentSize?: number;\n  maxInlineLength?: number;\n  maxInlineParams?: number;\n}\n\nexport const DEFAULT_FORMATTING_OPTIONS: FormattingOptions = {\n  useNestingIndicators: true,\n  useOperatorSpacing: true,\n  indentSize: 4,\n  maxInlineLength: 40,\n  maxInlineParams: 3,\n};\n", "// Excel Formula Parser - Pure parsing logic\n\nimport { FormulaTypes } from \"./formula-types\";\nimport {\n  ExcelExpression,\n  SubExpression,\n  FormulaExpr,\n  OperatorExpression,\n  CellReferenceExpression,\n  CellRangeExpression,\n} from \"./types\";\n\nexport class ExcelFormulaParser {\n  private static readonly formulaTypes: Array<string> = Object.values(FormulaTypes);\n  private static readonly formulaTypesMap: Record<string, FormulaTypes> = {\n    ...Object.entries(FormulaTypes).reduce(\n      (acc, [, value]) => {\n        acc[value] = value as FormulaTypes;\n        return acc;\n      },\n      {} as Record<string, FormulaTypes>,\n    ),\n  };\n\n  // Define operators in order of precedence (longest first to avoid partial matches)\n  private static readonly operators: Array<string> = [\n    \"<=\",\n    \">=\",\n    \"<>\",\n    \"!=\",\n    \"==\",\n    \"+\",\n    \"-\",\n    \"*\",\n    \"/\",\n    \"^\",\n    \"&\",\n    \"=\",\n    \"<\",\n    \">\",\n  ];\n\n  private static findOperatorAt(input: string, position: number): string | null {\n    // Check for 2-character operators first\n    if (position < input.length - 1) {\n      const twoChar = input.substring(position, position + 2);\n      if (this.operators.includes(twoChar)) {\n        return twoChar;\n      }\n    }\n\n    // Check for single-character operators\n    const oneChar = input.charAt(position);\n    if (this.operators.includes(oneChar)) {\n      return oneChar;\n    }\n\n    return null;\n  }\n\n  private static parseCellReference(text: string): CellReferenceExpression | CellRangeExpression | null {\n    // Remove any leading/trailing whitespace\n    text = text.trim();\n\n    // Check for range (contains :)\n    if (text.includes(\":\")) {\n      return this.parseCellRange(text);\n    }\n\n    // Parse single cell reference\n    return this.parseSingleCellReference(text);\n  }\n\n  private static parseCellRange(text: string): CellRangeExpression | null {\n    // Split on colon\n    const parts = text.split(\":\");\n    if (parts.length !== 2) {\n      return null;\n    }\n\n    const [startPart, endPart] = parts;\n    let sheet: string | undefined;\n    let start = startPart;\n    const end = endPart;\n\n    // Check if sheet is specified in the start part\n    if (start.includes(\"!\")) {\n      const sheetSplit = start.split(\"!\");\n      sheet = sheetSplit[0].replace(/^'|'$/g, \"\"); // Remove quotes\n      start = sheetSplit[1];\n    }\n\n    // Parse start and end cells\n    const startCell = this.parseSingleCellReference(start);\n    const endCell = this.parseSingleCellReference(end);\n\n    if (!startCell || !endCell) {\n      return null;\n    }\n\n    return new CellRangeExpression(text, sheet, startCell, endCell);\n  }\n\n  private static parseSingleCellReference(text: string): CellReferenceExpression | null {\n    // Pattern for cell reference: [Sheet!][$]Column[$]Row\n    // Examples: A1, $A1, A$1, $A$1, Sheet1!A1, 'Sheet Name'!$A$1\n    const cellPattern = /^(?:([^!]+)!)?(\\$?)([A-Z]+)(\\$?)(\\d+)$/i;\n    const match = text.match(cellPattern);\n\n    if (!match) {\n      return null;\n    }\n\n    const [, sheet, colAbsolute, column, rowAbsolute, row] = match;\n\n    // Clean sheet name (remove quotes if present)\n    const cleanSheet = sheet ? sheet.replace(/^'|'$/g, \"\") : undefined;\n\n    return new CellReferenceExpression(\n      text,\n      cleanSheet,\n      column.toUpperCase(),\n      row,\n      colAbsolute === \"$\",\n      rowAbsolute === \"$\",\n    );\n  }\n\n  private static parseExpressions(\n    parent: ExcelExpression,\n    startIndex: number,\n    input: string,\n    separator: string,\n  ): number {\n    let token = \"\";\n    let i: number = startIndex;\n    let inDoubleQuote = false;\n\n    while (i < input.length) {\n      const char = input[i];\n      const prevChar = i > 0 ? input[i - 1] : \"\";\n\n      // Handle quotes\n      if (char === '\"' && prevChar !== \"\\\\\") {\n        inDoubleQuote = !inDoubleQuote;\n        token += char;\n        i++;\n        continue;\n      }\n\n      // Skip operator/special char detection inside quotes\n      if (inDoubleQuote) {\n        token += char;\n        i++;\n        continue;\n      }\n\n      const operator = this.findOperatorAt(input, i);\n\n      if (char === \"(\") {\n        if (token.trim().length > 0) {\n          // Check if token is a function name\n          const upperToken = token.trim().toUpperCase();\n          if (this.formulaTypes.includes(upperToken)) {\n            const formulaType = this.formulaTypesMap[upperToken];\n            if (formulaType) {\n              i = this.parseFormula(parent, formulaType, i, input, separator);\n              token = \"\";\n            }\n          } else {\n            // Regular token before parentheses\n            const cellRef = this.parseCellReference(token.trim());\n            if (cellRef) {\n              parent.addChild(cellRef);\n            } else {\n              parent.addChild(new ExcelExpression(token.trim()));\n            }\n            token = \"\";\n            const expression = new SubExpression(\"\");\n            parent.addChild(expression);\n            i = this.parseExpressions(expression, i + 1, input, separator);\n          }\n        } else {\n          // Parentheses without preceding token\n          const expression = new SubExpression(\"\");\n          parent.addChild(expression);\n          i = this.parseExpressions(expression, i + 1, input, separator);\n        }\n      } else if (char === \")\") {\n        if (token.trim().length > 0) {\n          const cellRef = this.parseCellReference(token.trim());\n          if (cellRef) {\n            parent.addChild(cellRef);\n          } else {\n            parent.addChild(new ExcelExpression(token.trim()));\n          }\n        }\n        return i;\n      } else if (operator) {\n        // Found an operator\n        if (token.trim().length > 0) {\n          const cellRef = this.parseCellReference(token.trim());\n          if (cellRef) {\n            parent.addChild(cellRef);\n          } else {\n            parent.addChild(new ExcelExpression(token.trim()));\n          }\n          token = \"\";\n        }\n        parent.addChild(new OperatorExpression(operator));\n        i += operator.length - 1; // Skip the operator characters (-1 because i++ will happen)\n      } else if (char === \" \" || char === \"\\t\" || char === \"\\n\") {\n        token += char;\n      } else {\n        token += char;\n      }\n\n      i++;\n    }\n\n    if (token.trim().length > 0) {\n      const cellRef = this.parseCellReference(token.trim());\n      if (cellRef) {\n        parent.addChild(cellRef);\n      } else {\n        parent.addChild(new ExcelExpression(token.trim()));\n      }\n    }\n\n    return i;\n  }\n\n  private static parseFormula(\n    parent: ExcelExpression,\n    formula: FormulaTypes,\n    startIndex: number,\n    input: string,\n    separator: string,\n  ): number {\n    const formulaExpr = new FormulaExpr(\"\", formula);\n    parent.addChild(formulaExpr);\n\n    let i = this.parserAdvanceTo(\"(\", startIndex, input);\n    let token = \"\";\n    let braceCount = 0;\n\n    while (i < input.length) {\n      if (input[i] === separator && braceCount === 0) {\n        if (token.trim().length > 0) {\n          const paramExpression = new ExcelExpression(token.trim());\n          this.parseExpressions(paramExpression, 0, token, separator);\n\n          if (paramExpression.getChilds().length === 1) {\n            formulaExpr.addChild(paramExpression.getChilds()[0]);\n          } else if (paramExpression.getChilds().length > 1) {\n            formulaExpr.addChild(paramExpression);\n          } else {\n            // No children found, try to parse as cell reference or add as simple expression\n            const cellRef = this.parseCellReference(token.trim());\n            if (cellRef) {\n              formulaExpr.addChild(cellRef);\n            } else {\n              formulaExpr.addChild(new ExcelExpression(token.trim()));\n            }\n          }\n        }\n        token = \"\";\n      } else {\n        if (input[i] === \"(\") {\n          braceCount++;\n        } else if (input[i] === \")\") {\n          braceCount--;\n        }\n\n        if (braceCount < 0) {\n          // End of function parameters\n          if (token.trim().length > 0) {\n            const paramExpression = new ExcelExpression(token.trim());\n            this.parseExpressions(paramExpression, 0, token, separator);\n\n            if (paramExpression.getChilds().length === 1) {\n              formulaExpr.addChild(paramExpression.getChilds()[0]);\n            } else if (paramExpression.getChilds().length > 1) {\n              formulaExpr.addChild(paramExpression);\n            } else {\n              // No children found, try to parse as cell reference or add as simple expression\n              const cellRef = this.parseCellReference(token.trim());\n              if (cellRef) {\n                formulaExpr.addChild(cellRef);\n              } else {\n                formulaExpr.addChild(new ExcelExpression(token.trim()));\n              }\n            }\n          }\n          return i;\n        }\n\n        token += input[i];\n      }\n      i++;\n    }\n\n    // If we reach here, the function was not properly closed\n    throw new Error(`Function ${formula} is missing closing parenthesis`);\n  }\n\n  private static parserAdvanceTo(char: string, startIndex: number, input: string): number {\n    let i = startIndex;\n    while (i < input.length && input[i] !== char) {\n      i++;\n    }\n    return i + 1; // Move past the found character\n  }\n\n  private static validateFormula(formula: string): void {\n    // Check for balanced parentheses\n    let parenCount = 0;\n    let inSingleQuote = false;\n    let inDoubleQuote = false;\n\n    for (let i = 0; i < formula.length; i++) {\n      const char = formula[i];\n      const prevChar = i > 0 ? formula[i - 1] : \"\";\n\n      // Handle quotes (ignore escaped quotes)\n      if (char === \"'\" && prevChar !== \"\\\\\") {\n        inSingleQuote = !inSingleQuote;\n        continue;\n      }\n      if (char === '\"' && prevChar !== \"\\\\\") {\n        inDoubleQuote = !inDoubleQuote;\n        continue;\n      }\n\n      // Skip parentheses inside quotes\n      if (inSingleQuote || inDoubleQuote) {\n        continue;\n      }\n\n      if (char === \"(\") {\n        parenCount++;\n      } else if (char === \")\") {\n        parenCount--;\n        if (parenCount < 0) {\n          throw new Error(\"Unexpected closing parenthesis ')'\");\n        }\n      }\n    }\n\n    // Check for unclosed quotes\n    if (inSingleQuote) {\n      throw new Error(\"Unclosed single quote in formula\");\n    }\n    if (inDoubleQuote) {\n      throw new Error(\"Unclosed double quote in formula\");\n    }\n\n    // Check for unmatched parentheses\n    if (parenCount > 0) {\n      throw new Error(`Missing ${parenCount} closing parenthesis${parenCount > 1 ? \"es\" : \"\"} ')'`);\n    }\n\n    // Check for trailing operators\n    const trimmed = formula.trim();\n    if (trimmed.length > 0) {\n      const lastChar = trimmed[trimmed.length - 1];\n      if ([\"+\", \"-\", \"*\", \"/\", \"=\", \"<\", \">\", \"&\"].includes(lastChar)) {\n        throw new Error(`Formula cannot end with operator '${lastChar}'`);\n      }\n    }\n\n    // Check for empty parentheses in functions\n    const emptyParenPattern = /[A-Z][A-Z0-9_]*\\(\\s*\\)/gi;\n    if (emptyParenPattern.test(formula)) {\n      const match = formula.match(/([A-Z][A-Z0-9_]*)\\(\\s*\\)/gi);\n      if (match) {\n        throw new Error(`Function ${match[0].replace(\"()\", \"\")} has empty parentheses`);\n      }\n    }\n  }\n\n  static parse(formula: string): ExcelExpression {\n    // Remove leading = if present\n    let cleanFormula = formula.trim();\n    if (cleanFormula.startsWith(\"=\")) {\n      cleanFormula = cleanFormula.substring(1);\n    }\n\n    // Validate formula syntax before parsing\n    this.validateFormula(cleanFormula);\n\n    // Determine separator (European uses ; US uses ,)\n    const separator = cleanFormula.includes(\";\") ? \";\" : \",\";\n\n    try {\n      const baseExpression = new ExcelExpression(cleanFormula);\n      this.parseExpressions(baseExpression, 0, cleanFormula, separator);\n\n      return baseExpression;\n    } catch (error) {\n      // Re-throw validation errors with better messages\n      if (error instanceof Error) {\n        throw new Error(error.message);\n      }\n      throw new Error(\"Invalid formula syntax\");\n    }\n  }\n}\n", "// Excel Formula Formatter - Pure text formatting logic\n\nimport {\n  ExcelExpression,\n  SubExpression,\n  FormulaExpr,\n  OperatorExpression,\n  CellReferenceExpression,\n  CellRangeExpression,\n  FormattingOptions,\n  DEFAULT_FORMATTING_OPTIONS,\n} from \"./types\";\n\nexport class ExcelRawTextFormatter {\n  private options: FormattingOptions;\n\n  constructor(options: Partial<FormattingOptions> = {}) {\n    this.options = { ...DEFAULT_FORMATTING_OPTIONS, ...options };\n  }\n\n  format(expression: ExcelExpression, hasEqualsSign: boolean = false): string {\n    const result = this.prettyPrint(expression, 0);\n    return (hasEqualsSign ? \"=\" : \"\") + result;\n  }\n\n  private prettyPrint(expression: ExcelExpression, depth: number): string {\n    const children = expression.getChilds();\n\n    // If no children, return the original content\n    if (children.length === 0) {\n      return expression.original || \"\";\n    }\n\n    let result = \"\";\n\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n\n      if (child instanceof FormulaExpr) {\n        result += this.formatFunction(child, depth);\n      } else if (child instanceof SubExpression) {\n        result += this.formatSubExpression(child, depth);\n      } else if (child instanceof OperatorExpression) {\n        result += this.formatOperator(child, i, children);\n      } else if (child instanceof CellReferenceExpression) {\n        result += this.formatCellReference(child);\n      } else if (child instanceof CellRangeExpression) {\n        result += this.formatCellRange(child);\n      } else {\n        // For regular expressions, check if they have children or use original\n        if (child.getChilds().length === 0) {\n          result += child.original || \"\";\n        } else {\n          result += this.prettyPrint(child, depth);\n        }\n      }\n    }\n\n    return result;\n  }\n\n  private formatFunction(func: FormulaExpr, depth: number): string {\n    const params = func.getChilds();\n    if (params.length === 0) {\n      return func.formula + \"()\";\n    }\n\n    // Check if this function should be formatted inline\n    if (this.shouldFormatInline(func)) {\n      let result = func.formula + \"(\";\n      for (let i = 0; i < params.length; i++) {\n        const param = params[i];\n        const isLast = i === params.length - 1;\n\n        if (param instanceof FormulaExpr && this.shouldFormatInline(param)) {\n          result += this.formatFunction(param, depth + 1);\n        } else if (param instanceof SubExpression) {\n          result += this.formatSubExpression(param, depth);\n        } else {\n          const paramContent = param.getChilds().length === 0 ? param.original || \"\" : this.prettyPrint(param, depth);\n          result += paramContent || \"\";\n        }\n\n        if (!isLast) {\n          result += \"; \";\n        }\n      }\n      result += \")\";\n      return result;\n    }\n\n    // Multi-line formatting for complex functions\n    let result = func.formula + \"(\\n\";\n\n    for (let i = 0; i < params.length; i++) {\n      const param = params[i];\n      const isLast = i === params.length - 1;\n\n      // Add indentation and nesting indicator for parameters\n      result += this.indent(depth + 1);\n      if (this.options.useNestingIndicators) {\n        result += this.getNestingIndicator(depth + 1, isLast);\n      }\n\n      if (param instanceof FormulaExpr) {\n        // For nested functions, don't add extra indicator since formatFunction will handle it\n        const functionResult = this.formatFunction(param, depth + 1);\n        result += functionResult;\n      } else if (param instanceof SubExpression) {\n        const subResult = this.formatSubExpression(param, depth + 1);\n        result += subResult;\n      } else {\n        // For parameter content, preserve original or format children\n        const paramContent = param.getChilds().length === 0 ? param.original || \"\" : this.prettyPrint(param, depth + 1);\n        result += paramContent || \"\";\n      }\n\n      if (!isLast) {\n        result += \";\";\n        result += \"\\n\";\n      } else {\n        // Last parameter - add closing paren on same line\n        result += \")\";\n      }\n    }\n\n    return result;\n  }\n\n  private shouldFormatInline(func: FormulaExpr): boolean {\n    const params = func.getChilds();\n\n    // No parameters or only one parameter\n    if (params.length === 0 || params.length === 1) {\n      // Check if the single parameter is simple\n      if (params.length === 1) {\n        const param = params[0];\n        // If it's a nested function, don't inline\n        if (param instanceof FormulaExpr) {\n          return false;\n        }\n        // If it's a complex sub-expression, don't inline\n        if (param instanceof SubExpression && this.containsFunction(param)) {\n          return false;\n        }\n        // Check the content length\n        const content = param.original || this.prettyPrint(param, 0);\n        return content.length <= 30;\n      }\n      return true;\n    }\n\n    // Multiple parameters - only inline if all are very simple and short\n    if (params.length <= (this.options.maxInlineParams || 3)) {\n      let totalLength = 0;\n      for (const param of params) {\n        if (param instanceof FormulaExpr || (param instanceof SubExpression && this.containsFunction(param))) {\n          return false;\n        }\n        const content = param.original || this.prettyPrint(param, 0);\n        totalLength += content.length;\n        if (totalLength > (this.options.maxInlineLength || 40)) {\n          return false;\n        }\n      }\n      return totalLength <= (this.options.maxInlineLength || 40);\n    }\n\n    return false;\n  }\n\n  private formatSubExpression(subExpr: SubExpression, depth: number): string {\n    const content = this.prettyPrint(subExpr, depth);\n\n    // If it's simple, keep on one line\n    if (!content.includes(\"\\n\") && content.length < 50 && !this.containsFunction(subExpr)) {\n      return \"(\" + content + \")\";\n    }\n\n    // Complex sub-expression gets multi-line formatting\n    return \"(\\n\" + this.indent(depth + 1) + content + \"\\n\" + this.indent(depth) + \")\";\n  }\n\n  private formatOperator(operator: OperatorExpression, index: number, siblings: ExcelExpression[]): string {\n    if (!this.options.useOperatorSpacing) {\n      return operator.operator;\n    }\n\n    const op = operator.operator;\n    let result = \"\";\n\n    // Add space before operator (except for certain cases)\n    const prevSibling = index > 0 ? siblings[index - 1] : null;\n    const nextSibling = index + 1 < siblings.length ? siblings[index + 1] : null;\n\n    const shouldSpaceBefore = this.shouldSpaceBeforeOperator(op, prevSibling);\n    const shouldSpaceAfter = this.shouldSpaceAfterOperator(op);\n\n    if (shouldSpaceBefore) {\n      result += \" \";\n    }\n\n    result += op;\n\n    if (shouldSpaceAfter) {\n      result += \" \";\n    }\n\n    // If next sibling is a multi-line function, add line break (no extra indent, formatFunction handles it)\n    if (nextSibling instanceof FormulaExpr && !this.shouldFormatInline(nextSibling)) {\n      result += \"\\n\";\n    }\n\n    return result;\n  }\n\n  private shouldSpaceBeforeOperator(operator: string, prevSibling: ExcelExpression | null): boolean {\n    // Don't space before minus if it's at start or likely a negative number\n    if (operator === \"-\") {\n      if (!prevSibling) return false; // Beginning of expression\n      if (prevSibling instanceof OperatorExpression) {\n        const prevOp = prevSibling.operator;\n        // After another operator, likely unary minus\n        if ([\"+\", \"-\", \"*\", \"/\", \"^\", \"=\", \"<\", \">\", \"<=\", \">=\", \"<>\", \"!=\", \"==\", \"(\"].includes(prevOp)) {\n          return false;\n        }\n      }\n    }\n\n    // Don't space around colon in ranges (A1:B10)\n    if (operator === \":\") {\n      return false;\n    }\n\n    return true;\n  }\n\n  private shouldSpaceAfterOperator(operator: string): boolean {\n    // Don't space around colon in ranges (A1:B10)\n    if (operator === \":\") {\n      return false;\n    }\n\n    return true;\n  }\n\n  private formatCellReference(cellRef: CellReferenceExpression): string {\n    // Use the built-in method to get properly formatted reference\n    return cellRef.getFullReference();\n  }\n\n  private formatCellRange(cellRange: CellRangeExpression): string {\n    // Use the built-in method to get properly formatted range\n    return cellRange.getFullReference();\n  }\n\n  private containsFunction(expr: ExcelExpression): boolean {\n    if (expr instanceof FormulaExpr) {\n      return true;\n    }\n    return expr.getChilds().some((child) => this.containsFunction(child));\n  }\n\n  private needsSpacing(current: ExcelExpression, next: ExcelExpression): boolean {\n    if (current instanceof FormulaExpr || next instanceof FormulaExpr) {\n      return false; // Functions handle their own spacing\n    }\n\n    if (current instanceof OperatorExpression || next instanceof OperatorExpression) {\n      return false; // Operators handle their own spacing\n    }\n\n    return false; // Let operators handle all spacing needs\n  }\n\n  private indent(depth: number): string {\n    const indentChar = \" \".repeat(this.options.indentSize || 4);\n    return indentChar.repeat(depth);\n  }\n\n  private getNestingIndicator(depth: number, isLast: boolean = false): string {\n    if (depth === 0) return \"\";\n\n    // Create a simple but consistent nesting indicator\n    const prefix = \"  \".repeat(Math.max(0, depth - 1)); // 2 spaces per level\n\n    if (depth === 1) {\n      return isLast ? \"\u2514\u2500 \" : \"\u251C\u2500 \";\n    } else {\n      return prefix + (isLast ? \"\u2514\u2500 \" : \"\u251C\u2500 \");\n    }\n  }\n}\n", "// Excel Formula Parser and Beautifier - Main Entry Point\n\nimport { ExcelFormulaParser } from \"./parser\";\nimport { ExcelRawTextFormatter } from \"./raw-text-formatter\";\nimport { FormattingOptions } from \"./types\";\n\nexport class ExcelFormulaBeautifier {\n  static rawText(formula: string, options?: Partial<FormattingOptions>): string {\n    // Parse the formula - let errors bubble up to the caller\n    const hasEquals = formula.trim().startsWith(\"=\");\n    const parsedExpression = ExcelFormulaParser.parse(formula);\n\n    // Format the parsed expression\n    const formatter = new ExcelRawTextFormatter(options);\n    return formatter.format(parsedExpression, hasEquals);\n  }\n}\n", "export interface FormulaDoc {\n  name: string;\n  category: string;\n  description: string;\n  syntax: string;\n  example: string;\n}\n\nexport const FORMULAS_DOCUMENTATION: Record<string, FormulaDoc> = {\n  SUM: {\n    name: \"SUM\",\n    category: \"Basic\",\n    description: \"Adds values together\",\n    syntax: \"SUM(number1, [number2], ...)\",\n    example: \"=SUM(A1:A10)\",\n  },\n  AVERAGE: {\n    name: \"AVERAGE\",\n    category: \"Basic\",\n    description: \"Calculates the average of values\",\n    syntax: \"AVERAGE(number1, [number2], ...)\",\n    example: \"=AVERAGE(B1:B10)\",\n  },\n  COUNT: {\n    name: \"COUNT\",\n    category: \"Basic\",\n    description: \"Counts the number of cells with numbers\",\n    syntax: \"COUNT(value1, [value2], ...)\",\n    example: \"=COUNT(A1:A100)\",\n  },\n  COUNTA: {\n    name: \"COUNTA\",\n    category: \"Basic\",\n    description: \"Counts non-empty cells\",\n    syntax: \"COUNTA(value1, [value2], ...)\",\n    example: \"=COUNTA(A1:A100)\",\n  },\n  MAX: {\n    name: \"MAX\",\n    category: \"Basic\",\n    description: \"Returns the maximum value\",\n    syntax: \"MAX(number1, [number2], ...)\",\n    example: \"=MAX(A1:A10)\",\n  },\n  MIN: {\n    name: \"MIN\",\n    category: \"Basic\",\n    description: \"Returns the minimum value\",\n    syntax: \"MIN(number1, [number2], ...)\",\n    example: \"=MIN(A1:A10)\",\n  },\n  IF: {\n    name: \"IF\",\n    category: \"Conditional\",\n    description: \"Returns one value if a condition is true, another if false\",\n    syntax: \"IF(logical_test, [value_if_true], [value_if_false])\",\n    example: '=IF(A1>100, \"High\", \"Low\")',\n  },\n  IFERROR: {\n    name: \"IFERROR\",\n    category: \"Conditional\",\n    description: \"Returns a specified value if a formula results in an error\",\n    syntax: \"IFERROR(value, value_if_error)\",\n    example: '=IFERROR(A1/B1, \"N/A\")',\n  },\n  IFS: {\n    name: \"IFS\",\n    category: \"Conditional\",\n    description: \"Checks multiple conditions and returns the corresponding value\",\n    syntax: \"IFS(condition1, value1, [condition2, value2], ...)\",\n    example: '=IFS(A1>100, \"High\", A1>50, \"Medium\", \"Low\")',\n  },\n  VLOOKUP: {\n    name: \"VLOOKUP\",\n    category: \"Lookup\",\n    description: \"Searches for a value in the first column of a range and returns a value in the same row\",\n    syntax: \"VLOOKUP(lookup_value, table_array, col_index_num, [range_lookup])\",\n    example: \"=VLOOKUP(E1, Sheet1!A:B, 2, FALSE)\",\n  },\n  INDEX: {\n    name: \"INDEX\",\n    category: \"Lookup\",\n    description: \"Returns a value from a range at a specified position\",\n    syntax: \"INDEX(array, row_num, [column_num])\",\n    example: \"=INDEX(A1:B10, 3, 2)\",\n  },\n  MATCH: {\n    name: \"MATCH\",\n    category: \"Lookup\",\n    description: \"Returns the position of an item in a range\",\n    syntax: \"MATCH(lookup_value, lookup_array, [match_type])\",\n    example: '=MATCH(\"Apples\", A1:A10, 0)',\n  },\n  CONCATENATE: {\n    name: \"CONCATENATE\",\n    category: \"Text\",\n    description: \"Joins multiple text strings together\",\n    syntax: \"CONCATENATE(text1, [text2], ...)\",\n    example: '=CONCATENATE(\"Hello\", \" \", \"World\")',\n  },\n  UPPER: {\n    name: \"UPPER\",\n    category: \"Text\",\n    description: \"Converts text to uppercase\",\n    syntax: \"UPPER(text)\",\n    example: '=UPPER(\"hello\")',\n  },\n  LOWER: {\n    name: \"LOWER\",\n    category: \"Text\",\n    description: \"Converts text to lowercase\",\n    syntax: \"LOWER(text)\",\n    example: '=LOWER(\"HELLO\")',\n  },\n  TRIM: {\n    name: \"TRIM\",\n    category: \"Text\",\n    description: \"Removes leading and trailing spaces\",\n    syntax: \"TRIM(text)\",\n    example: '=TRIM(\" hello \")',\n  },\n  LEN: {\n    name: \"LEN\",\n    category: \"Text\",\n    description: \"Returns the length of a text string\",\n    syntax: \"LEN(text)\",\n    example: '=LEN(\"hello\")',\n  },\n  ROUND: {\n    name: \"ROUND\",\n    category: \"Math\",\n    description: \"Rounds a number to a specified number of digits\",\n    syntax: \"ROUND(number, num_digits)\",\n    example: \"=ROUND(3.14159, 2)\",\n  },\n  ABS: {\n    name: \"ABS\",\n    category: \"Math\",\n    description: \"Returns the absolute value of a number\",\n    syntax: \"ABS(number)\",\n    example: \"=ABS(-10)\",\n  },\n  SQRT: {\n    name: \"SQRT\",\n    category: \"Math\",\n    description: \"Returns the square root of a number\",\n    syntax: \"SQRT(number)\",\n    example: \"=SQRT(16)\",\n  },\n  TODAY: {\n    name: \"TODAY\",\n    category: \"Date\",\n    description: \"Returns the current date\",\n    syntax: \"TODAY()\",\n    example: \"=TODAY()\",\n  },\n  NOW: {\n    name: \"NOW\",\n    category: \"Date\",\n    description: \"Returns the current date and time\",\n    syntax: \"NOW()\",\n    example: \"=NOW()\",\n  },\n  DATE: {\n    name: \"DATE\",\n    category: \"Date\",\n    description: \"Creates a date from year, month, and day\",\n    syntax: \"DATE(year, month, day)\",\n    example: \"=DATE(2024, 11, 13)\",\n  },\n  AND: {\n    name: \"AND\",\n    category: \"Logical\",\n    description: \"Returns TRUE if all conditions are true\",\n    syntax: \"AND(logical1, [logical2], ...)\",\n    example: \"=AND(A1>10, B1<20)\",\n  },\n  OR: {\n    name: \"OR\",\n    category: \"Logical\",\n    description: \"Returns TRUE if any condition is true\",\n    syntax: \"OR(logical1, [logical2], ...)\",\n    example: \"=OR(A1=5, B1=10)\",\n  },\n  NOT: {\n    name: \"NOT\",\n    category: \"Logical\",\n    description: \"Reverses the logical value of an argument\",\n    syntax: \"NOT(logical)\",\n    example: \"=NOT(A1=TRUE)\",\n  },\n  IFNA: {\n    name: \"IFNA\",\n    category: \"Conditional\",\n    description: \"Returns a value if a formula results in #N/A error, otherwise returns the formula result\",\n    syntax: \"IFNA(value, value_if_na)\",\n    example: '=IFNA(VLOOKUP(E1, A:B, 2), \"Not Found\")',\n  },\n  ISERROR: {\n    name: \"ISERROR\",\n    category: \"Logical\",\n    description: \"Returns TRUE if the value is any type of error\",\n    syntax: \"ISERROR(value)\",\n    example: \"=ISERROR(A1/B1)\",\n  },\n  ISNA: {\n    name: \"ISNA\",\n    category: \"Logical\",\n    description: \"Returns TRUE if the value is #N/A error\",\n    syntax: \"ISNA(value)\",\n    example: \"=ISNA(VLOOKUP(E1, A:B, 2))\",\n  },\n  ISBLANK: {\n    name: \"ISBLANK\",\n    category: \"Logical\",\n    description: \"Returns TRUE if the cell is empty\",\n    syntax: \"ISBLANK(value)\",\n    example: \"=ISBLANK(A1)\",\n  },\n  ISNUMBER: {\n    name: \"ISNUMBER\",\n    category: \"Logical\",\n    description: \"Returns TRUE if the value is a number\",\n    syntax: \"ISNUMBER(value)\",\n    example: \"=ISNUMBER(A1)\",\n  },\n  ISTEXT: {\n    name: \"ISTEXT\",\n    category: \"Logical\",\n    description: \"Returns TRUE if the value is text\",\n    syntax: \"ISTEXT(value)\",\n    example: \"=ISTEXT(A1)\",\n  },\n  SUMIF: {\n    name: \"SUMIF\",\n    category: \"Math\",\n    description: \"Sums values that meet a single condition\",\n    syntax: \"SUMIF(range, criteria, [sum_range])\",\n    example: '=SUMIF(A1:A10, \">100\", B1:B10)',\n  },\n  SUMIFS: {\n    name: \"SUMIFS\",\n    category: \"Math\",\n    description: \"Sums values that meet multiple criteria\",\n    syntax: \"SUMIFS(sum_range, criteria_range1, criteria1, ...)\",\n    example: '=SUMIFS(C1:C10, A1:A10, \"North\", B1:B10, \">50\")',\n  },\n  SUMPRODUCT: {\n    name: \"SUMPRODUCT\",\n    category: \"Math\",\n    description: \"Multiplies arrays element-by-element and returns the sum\",\n    syntax: \"SUMPRODUCT(array1, [array2], ...)\",\n    example: \"=SUMPRODUCT(A1:A5, B1:B5)\",\n  },\n  AVERAGEIF: {\n    name: \"AVERAGEIF\",\n    category: \"Math\",\n    description: \"Calculates the average of values that meet a single criterion\",\n    syntax: \"AVERAGEIF(range, criteria, [average_range])\",\n    example: '=AVERAGEIF(A1:A10, \">50\", B1:B10)',\n  },\n  AVERAGEIFS: {\n    name: \"AVERAGEIFS\",\n    category: \"Math\",\n    description: \"Calculates the average of values that meet multiple criteria\",\n    syntax: \"AVERAGEIFS(average_range, criteria_range1, criteria1, ...)\",\n    example: '=AVERAGEIFS(C1:C10, A1:A10, \"North\", B1:B10, \">50\")',\n  },\n  COUNTBLANK: {\n    name: \"COUNTBLANK\",\n    category: \"Math\",\n    description: \"Counts empty cells in a range\",\n    syntax: \"COUNTBLANK(range)\",\n    example: \"=COUNTBLANK(A1:A100)\",\n  },\n  COUNTIF: {\n    name: \"COUNTIF\",\n    category: \"Math\",\n    description: \"Counts cells that meet a single criterion\",\n    syntax: \"COUNTIF(range, criteria)\",\n    example: '=COUNTIF(A1:A10, \"Apple\")',\n  },\n  COUNTIFS: {\n    name: \"COUNTIFS\",\n    category: \"Math\",\n    description: \"Counts cells that meet multiple criteria\",\n    syntax: \"COUNTIFS(criteria_range1, criteria1, ...)\",\n    example: '=COUNTIFS(A1:A10, \"North\", B1:B10, \">50\")',\n  },\n  MAXA: {\n    name: \"MAXA\",\n    category: \"Math\",\n    description: \"Returns the maximum value including text and logical values\",\n    syntax: \"MAXA(value1, [value2], ...)\",\n    example: \"=MAXA(A1:A10)\",\n  },\n  MINA: {\n    name: \"MINA\",\n    category: \"Math\",\n    description: \"Returns the minimum value including text and logical values\",\n    syntax: \"MINA(value1, [value2], ...)\",\n    example: \"=MINA(A1:A10)\",\n  },\n  MEDIAN: {\n    name: \"MEDIAN\",\n    category: \"Math\",\n    description: \"Returns the median (middle value) of a set of numbers\",\n    syntax: \"MEDIAN(number1, [number2], ...)\",\n    example: \"=MEDIAN(A1:A10)\",\n  },\n  MODE: {\n    name: \"MODE\",\n    category: \"Math\",\n    description: \"Returns the most frequently occurring value in a dataset\",\n    syntax: \"MODE(number1, [number2], ...)\",\n    example: \"=MODE(A1:A10)\",\n  },\n  STDEV: {\n    name: \"STDEV\",\n    category: \"Math\",\n    description: \"Calculates the standard deviation of a sample\",\n    syntax: \"STDEV(number1, [number2], ...)\",\n    example: \"=STDEV(A1:A10)\",\n  },\n  VAR: {\n    name: \"VAR\",\n    category: \"Math\",\n    description: \"Calculates the variance of a sample\",\n    syntax: \"VAR(number1, [number2], ...)\",\n    example: \"=VAR(A1:A10)\",\n  },\n  ROUNDUP: {\n    name: \"ROUNDUP\",\n    category: \"Math\",\n    description: \"Rounds a number up to a specified number of digits\",\n    syntax: \"ROUNDUP(number, num_digits)\",\n    example: \"=ROUNDUP(3.14, 1)\",\n  },\n  ROUNDDOWN: {\n    name: \"ROUNDDOWN\",\n    category: \"Math\",\n    description: \"Rounds a number down to a specified number of digits\",\n    syntax: \"ROUNDDOWN(number, num_digits)\",\n    example: \"=ROUNDDOWN(3.99, 0)\",\n  },\n  CEILING: {\n    name: \"CEILING\",\n    category: \"Math\",\n    description: \"Rounds a number up to the nearest multiple of significance\",\n    syntax: \"CEILING(number, significance)\",\n    example: \"=CEILING(2.5, 1)\",\n  },\n  FLOOR: {\n    name: \"FLOOR\",\n    category: \"Math\",\n    description: \"Rounds a number down to the nearest multiple of significance\",\n    syntax: \"FLOOR(number, significance)\",\n    example: \"=FLOOR(2.9, 1)\",\n  },\n  TRUNC: {\n    name: \"TRUNC\",\n    category: \"Math\",\n    description: \"Truncates a number to an integer by removing decimal part\",\n    syntax: \"TRUNC(number, [num_digits])\",\n    example: \"=TRUNC(3.14159, 2)\",\n  },\n  INT: {\n    name: \"INT\",\n    category: \"Math\",\n    description: \"Rounds a number down to the nearest integer\",\n    syntax: \"INT(number)\",\n    example: \"=INT(3.9)\",\n  },\n  POWER: {\n    name: \"POWER\",\n    category: \"Math\",\n    description: \"Raises a number to a specified power\",\n    syntax: \"POWER(number, power)\",\n    example: \"=POWER(2, 3)\",\n  },\n  EXP: {\n    name: \"EXP\",\n    category: \"Math\",\n    description: \"Returns e raised to the power of a number\",\n    syntax: \"EXP(number)\",\n    example: \"=EXP(1)\",\n  },\n  LN: {\n    name: \"LN\",\n    category: \"Math\",\n    description: \"Returns the natural logarithm of a number\",\n    syntax: \"LN(number)\",\n    example: \"=LN(10)\",\n  },\n  LOG: {\n    name: \"LOG\",\n    category: \"Math\",\n    description: \"Returns the logarithm of a number to a specified base\",\n    syntax: \"LOG(number, [base])\",\n    example: \"=LOG(100, 10)\",\n  },\n  LOG10: {\n    name: \"LOG10\",\n    category: \"Math\",\n    description: \"Returns the base-10 logarithm of a number\",\n    syntax: \"LOG10(number)\",\n    example: \"=LOG10(100)\",\n  },\n  MOD: {\n    name: \"MOD\",\n    category: \"Math\",\n    description: \"Returns the remainder of a division\",\n    syntax: \"MOD(number, divisor)\",\n    example: \"=MOD(10, 3)\",\n  },\n  RAND: {\n    name: \"RAND\",\n    category: \"Math\",\n    description: \"Returns a random number between 0 and 1\",\n    syntax: \"RAND()\",\n    example: \"=RAND()\",\n  },\n  RANDBETWEEN: {\n    name: \"RANDBETWEEN\",\n    category: \"Math\",\n    description: \"Returns a random integer between two specified numbers\",\n    syntax: \"RANDBETWEEN(bottom, top)\",\n    example: \"=RANDBETWEEN(1, 100)\",\n  },\n  HLOOKUP: {\n    name: \"HLOOKUP\",\n    category: \"Lookup\",\n    description: \"Searches for a value in the first row of a range and returns a value in the same column\",\n    syntax: \"HLOOKUP(lookup_value, table_array, row_index_num, [range_lookup])\",\n    example: '=HLOOKUP(\"Product\", A1:D10, 3, FALSE)',\n  },\n  XLOOKUP: {\n    name: \"XLOOKUP\",\n    category: \"Lookup\",\n    description: \"Searches for a value in an array and returns a corresponding value from another array\",\n    syntax: \"XLOOKUP(lookup_value, lookup_array, return_array, [if_not_found], [match_mode], [search_mode])\",\n    example: \"=XLOOKUP(E1, A:A, B:B)\",\n  },\n  LOOKUP: {\n    name: \"LOOKUP\",\n    category: \"Lookup\",\n    description: \"Searches for a value in a range and returns a corresponding value\",\n    syntax: \"LOOKUP(lookup_value, lookup_array, [return_array])\",\n    example: \"=LOOKUP(E1, A1:A10, B1:B10)\",\n  },\n  CHOOSE: {\n    name: \"CHOOSE\",\n    category: \"Lookup\",\n    description: \"Returns a value from a list based on a position number\",\n    syntax: \"CHOOSE(index_num, value1, [value2], ...)\",\n    example: '=CHOOSE(2, \"Red\", \"Green\", \"Blue\")',\n  },\n  INDIRECT: {\n    name: \"INDIRECT\",\n    category: \"Lookup\",\n    description: \"Returns a reference to a cell specified by a text string\",\n    syntax: \"INDIRECT(ref_text, [a1])\",\n    example: '=INDIRECT(\"A\" & ROW())',\n  },\n  OFFSET: {\n    name: \"OFFSET\",\n    category: \"Lookup\",\n    description: \"Returns a reference to a range that is a specified number of rows and columns from a cell\",\n    syntax: \"OFFSET(reference, rows, cols, [height], [width])\",\n    example: \"=OFFSET(A1, 1, 2, 3, 1)\",\n  },\n  ROW: {\n    name: \"ROW\",\n    category: \"Lookup\",\n    description: \"Returns the row number of a reference\",\n    syntax: \"ROW([reference])\",\n    example: \"=ROW(A5)\",\n  },\n  COLUMN: {\n    name: \"COLUMN\",\n    category: \"Lookup\",\n    description: \"Returns the column number of a reference\",\n    syntax: \"COLUMN([reference])\",\n    example: \"=COLUMN(C5)\",\n  },\n  ROWS: {\n    name: \"ROWS\",\n    category: \"Lookup\",\n    description: \"Returns the number of rows in a range\",\n    syntax: \"ROWS(array)\",\n    example: \"=ROWS(A1:A100)\",\n  },\n  COLUMNS: {\n    name: \"COLUMNS\",\n    category: \"Lookup\",\n    description: \"Returns the number of columns in a range\",\n    syntax: \"COLUMNS(array)\",\n    example: \"=COLUMNS(A1:D10)\",\n  },\n  CONCAT: {\n    name: \"CONCAT\",\n    category: \"Text\",\n    description: \"Joins text from multiple ranges or strings\",\n    syntax: \"CONCAT(text1, [text2], ...)\",\n    example: '=CONCAT(\"Hello\", \" \", \"World\")',\n  },\n  TEXTJOIN: {\n    name: \"TEXTJOIN\",\n    category: \"Text\",\n    description: \"Combines text from multiple ranges with a delimiter\",\n    syntax: \"TEXTJOIN(delimiter, ignore_empty, text1, [text2], ...)\",\n    example: '=TEXTJOIN(\", \", TRUE, A1:A10)',\n  },\n  LEFT: {\n    name: \"LEFT\",\n    category: \"Text\",\n    description: \"Returns the leftmost characters from a text string\",\n    syntax: \"LEFT(text, [num_chars])\",\n    example: '=LEFT(\"Hello\", 3)',\n  },\n  RIGHT: {\n    name: \"RIGHT\",\n    category: \"Text\",\n    description: \"Returns the rightmost characters from a text string\",\n    syntax: \"RIGHT(text, [num_chars])\",\n    example: '=RIGHT(\"Hello\", 2)',\n  },\n  MID: {\n    name: \"MID\",\n    category: \"Text\",\n    description: \"Returns a specific number of characters from a text string, starting at a specified position\",\n    syntax: \"MID(text, start_num, num_chars)\",\n    example: '=MID(\"Hello\", 2, 3)',\n  },\n  FIND: {\n    name: \"FIND\",\n    category: \"Text\",\n    description: \"Finds one text string within another (case-sensitive)\",\n    syntax: \"FIND(find_text, within_text, [start_num])\",\n    example: '=FIND(\"l\", \"Hello\")',\n  },\n  SEARCH: {\n    name: \"SEARCH\",\n    category: \"Text\",\n    description: \"Searches for one text string within another (case-insensitive)\",\n    syntax: \"SEARCH(find_text, within_text, [start_num])\",\n    example: '=SEARCH(\"llo\", \"Hello\")',\n  },\n  SUBSTITUTE: {\n    name: \"SUBSTITUTE\",\n    category: \"Text\",\n    description: \"Replaces old text with new text in a text string\",\n    syntax: \"SUBSTITUTE(text, old_text, new_text, [instance_num])\",\n    example: '=SUBSTITUTE(\"Hello World\", \"World\", \"Excel\")',\n  },\n  REPLACE: {\n    name: \"REPLACE\",\n    category: \"Text\",\n    description: \"Replaces part of a text string with a different text string\",\n    syntax: \"REPLACE(old_text, start_num, num_chars, new_text)\",\n    example: '=REPLACE(\"Hello\", 2, 2, \"a\")',\n  },\n  PROPER: {\n    name: \"PROPER\",\n    category: \"Text\",\n    description: \"Capitalizes the first letter of each word in a text string\",\n    syntax: \"PROPER(text)\",\n    example: '=PROPER(\"hello world\")',\n  },\n  CLEAN: {\n    name: \"CLEAN\",\n    category: \"Text\",\n    description: \"Removes non-printable characters from text\",\n    syntax: \"CLEAN(text)\",\n    example: \"=CLEAN(A1)\",\n  },\n  VALUE: {\n    name: \"VALUE\",\n    category: \"Text\",\n    description: \"Converts a text string that represents a number to a number\",\n    syntax: \"VALUE(text)\",\n    example: '=VALUE(\"1000\")',\n  },\n  TEXT: {\n    name: \"TEXT\",\n    category: \"Text\",\n    description: \"Formats a number as text using a specific number format\",\n    syntax: \"TEXT(value, format_text)\",\n    example: '=TEXT(1234.5, \"$#,##0.00\")',\n  },\n  CHAR: {\n    name: \"CHAR\",\n    category: \"Text\",\n    description: \"Returns the character specified by a code number\",\n    syntax: \"CHAR(number)\",\n    example: \"=CHAR(65)\",\n  },\n  CODE: {\n    name: \"CODE\",\n    category: \"Text\",\n    description: \"Returns a numeric code for the first character in a text string\",\n    syntax: \"CODE(text)\",\n    example: '=CODE(\"A\")',\n  },\n  EXACT: {\n    name: \"EXACT\",\n    category: \"Text\",\n    description: \"Compares two text strings and returns TRUE if they are exactly the same\",\n    syntax: \"EXACT(text1, text2)\",\n    example: '=EXACT(\"hello\", \"HELLO\")',\n  },\n  TIME: {\n    name: \"TIME\",\n    category: \"Date\",\n    description: \"Creates a time from hour, minute, and second\",\n    syntax: \"TIME(hour, minute, second)\",\n    example: \"=TIME(14, 30, 0)\",\n  },\n  YEAR: {\n    name: \"YEAR\",\n    category: \"Date\",\n    description: \"Returns the year of a date\",\n    syntax: \"YEAR(serial_number)\",\n    example: \"=YEAR(TODAY())\",\n  },\n  MONTH: {\n    name: \"MONTH\",\n    category: \"Date\",\n    description: \"Returns the month of a date\",\n    syntax: \"MONTH(serial_number)\",\n    example: \"=MONTH(TODAY())\",\n  },\n  DAY: {\n    name: \"DAY\",\n    category: \"Date\",\n    description: \"Returns the day of a date\",\n    syntax: \"DAY(serial_number)\",\n    example: \"=DAY(TODAY())\",\n  },\n  HOUR: {\n    name: \"HOUR\",\n    category: \"Date\",\n    description: \"Returns the hour of a time\",\n    syntax: \"HOUR(serial_number)\",\n    example: \"=HOUR(NOW())\",\n  },\n  MINUTE: {\n    name: \"MINUTE\",\n    category: \"Date\",\n    description: \"Returns the minute of a time\",\n    syntax: \"MINUTE(serial_number)\",\n    example: \"=MINUTE(NOW())\",\n  },\n  SECOND: {\n    name: \"SECOND\",\n    category: \"Date\",\n    description: \"Returns the second of a time\",\n    syntax: \"SECOND(serial_number)\",\n    example: \"=SECOND(NOW())\",\n  },\n  WEEKDAY: {\n    name: \"WEEKDAY\",\n    category: \"Date\",\n    description: \"Returns the day of the week as a number\",\n    syntax: \"WEEKDAY(serial_number, [return_type])\",\n    example: \"=WEEKDAY(TODAY())\",\n  },\n  WEEKNUM: {\n    name: \"WEEKNUM\",\n    category: \"Date\",\n    description: \"Returns the week number of the year\",\n    syntax: \"WEEKNUM(serial_number, [return_type])\",\n    example: \"=WEEKNUM(TODAY())\",\n  },\n  WORKDAY: {\n    name: \"WORKDAY\",\n    category: \"Date\",\n    description: \"Returns a date that is a specified number of working days before or after a start date\",\n    syntax: \"WORKDAY(start_date, days, [holidays])\",\n    example: \"=WORKDAY(TODAY(), 5)\",\n  },\n  NETWORKDAYS: {\n    name: \"NETWORKDAYS\",\n    category: \"Date\",\n    description: \"Returns the number of working days between two dates\",\n    syntax: \"NETWORKDAYS(start_date, end_date, [holidays])\",\n    example: \"=NETWORKDAYS(A1, A2)\",\n  },\n  EDATE: {\n    name: \"EDATE\",\n    category: \"Date\",\n    description: \"Returns the date that is a specified number of months before or after a given date\",\n    syntax: \"EDATE(start_date, months)\",\n    example: \"=EDATE(TODAY(), 3)\",\n  },\n  EOMONTH: {\n    name: \"EOMONTH\",\n    category: \"Date\",\n    description: \"Returns the last day of the month specified\",\n    syntax: \"EOMONTH(start_date, months)\",\n    example: \"=EOMONTH(TODAY(), 0)\",\n  },\n  DATEDIF: {\n    name: \"DATEDIF\",\n    category: \"Date\",\n    description: \"Calculates the difference between two dates\",\n    syntax: \"DATEDIF(start_date, end_date, unit)\",\n    example: '=DATEDIF(A1, A2, \"D\")',\n  },\n  DATEVALUE: {\n    name: \"DATEVALUE\",\n    category: \"Date\",\n    description: \"Converts a date stored as text to a date value\",\n    syntax: \"DATEVALUE(date_text)\",\n    example: '=DATEVALUE(\"2024-11-13\")',\n  },\n  TIMEVALUE: {\n    name: \"TIMEVALUE\",\n    category: \"Date\",\n    description: \"Converts a time stored as text to a time value\",\n    syntax: \"TIMEVALUE(time_text)\",\n    example: '=TIMEVALUE(\"14:30:00\")',\n  },\n  PMT: {\n    name: \"PMT\",\n    category: \"Financial\",\n    description: \"Calculates the payment for a loan based on constant payments\",\n    syntax: \"PMT(rate, nper, pv, [fv], [type])\",\n    example: \"=PMT(0.06/12, 360, 200000)\",\n  },\n  PV: {\n    name: \"PV\",\n    category: \"Financial\",\n    description: \"Returns the present value of an investment\",\n    syntax: \"PV(rate, nper, pmt, [fv], [type])\",\n    example: \"=PV(0.08, 10, -100)\",\n  },\n  FV: {\n    name: \"FV\",\n    category: \"Financial\",\n    description: \"Returns the future value of an investment\",\n    syntax: \"FV(rate, nper, pmt, [pv], [type])\",\n    example: \"=FV(0.08, 10, -100)\",\n  },\n  RATE: {\n    name: \"RATE\",\n    category: \"Financial\",\n    description: \"Returns the interest rate per period\",\n    syntax: \"RATE(nper, pmt, pv, [fv], [type], [guess])\",\n    example: \"=RATE(360, -665.30, 200000)\",\n  },\n  NPER: {\n    name: \"NPER\",\n    category: \"Financial\",\n    description: \"Returns the number of periods for an investment\",\n    syntax: \"NPER(rate, pmt, pv, [fv], [type])\",\n    example: \"=NPER(0.06/12, -200, 5000)\",\n  },\n  NPV: {\n    name: \"NPV\",\n    category: \"Financial\",\n    description: \"Returns the net present value of an investment\",\n    syntax: \"NPV(rate, value1, [value2], ...)\",\n    example: \"=NPV(0.1, -1000, 300, 400, 500)\",\n  },\n  IRR: {\n    name: \"IRR\",\n    category: \"Financial\",\n    description: \"Returns the internal rate of return for a series of cash flows\",\n    syntax: \"IRR(values, [guess])\",\n    example: \"=IRR(A1:A10)\",\n  },\n  XIRR: {\n    name: \"XIRR\",\n    category: \"Financial\",\n    description: \"Returns the internal rate of return for a series of cash flows that are not periodic\",\n    syntax: \"XIRR(values, dates, [guess])\",\n    example: \"=XIRR(A1:A10, B1:B10)\",\n  },\n  XNPV: {\n    name: \"XNPV\",\n    category: \"Financial\",\n    description: \"Returns the net present value for a series of cash flows with different dates\",\n    syntax: \"XNPV(rate, values, dates)\",\n    example: \"=XNPV(0.1, A1:A10, B1:B10)\",\n  },\n  DSUM: {\n    name: \"DSUM\",\n    category: \"Database\",\n    description: \"Sums values in a database based on specified criteria\",\n    syntax: \"DSUM(database, field, criteria)\",\n    example: '=DSUM(A1:C10, \"Amount\", E1:E2)',\n  },\n  DAVERAGE: {\n    name: \"DAVERAGE\",\n    category: \"Database\",\n    description: \"Calculates the average of values in a database based on specified criteria\",\n    syntax: \"DAVERAGE(database, field, criteria)\",\n    example: '=DAVERAGE(A1:C10, \"Amount\", E1:E2)',\n  },\n  DCOUNT: {\n    name: \"DCOUNT\",\n    category: \"Database\",\n    description: \"Counts cells containing numbers in a database based on specified criteria\",\n    syntax: \"DCOUNT(database, field, criteria)\",\n    example: '=DCOUNT(A1:C10, \"Amount\", E1:E2)',\n  },\n  DCOUNTA: {\n    name: \"DCOUNTA\",\n    category: \"Database\",\n    description: \"Counts non-empty cells in a database based on specified criteria\",\n    syntax: \"DCOUNTA(database, field, criteria)\",\n    example: '=DCOUNTA(A1:C10, \"Name\", E1:E2)',\n  },\n  DMAX: {\n    name: \"DMAX\",\n    category: \"Database\",\n    description: \"Returns the maximum value in a database based on specified criteria\",\n    syntax: \"DMAX(database, field, criteria)\",\n    example: '=DMAX(A1:C10, \"Amount\", E1:E2)',\n  },\n  DMIN: {\n    name: \"DMIN\",\n    category: \"Database\",\n    description: \"Returns the minimum value in a database based on specified criteria\",\n    syntax: \"DMIN(database, field, criteria)\",\n    example: '=DMIN(A1:C10, \"Amount\", E1:E2)',\n  },\n  CONVERT: {\n    name: \"CONVERT\",\n    category: \"Engineering\",\n    description: \"Converts a number from one measurement system to another\",\n    syntax: \"CONVERT(number, from_unit, to_unit)\",\n    example: '=CONVERT(100, \"kg\", \"lb\")',\n  },\n  FILTER: {\n    name: \"FILTER\",\n    category: \"Array\",\n    description: \"Filters an array based on specified criteria\",\n    syntax: \"FILTER(array, include, [if_empty])\",\n    example: \"=FILTER(A1:B10, A1:A10>50)\",\n  },\n  SORT: {\n    name: \"SORT\",\n    category: \"Array\",\n    description: \"Sorts the contents of a range or array\",\n    syntax: \"SORT(array, [sort_index], [sort_order], [by_col])\",\n    example: \"=SORT(A1:B10)\",\n  },\n  SORTBY: {\n    name: \"SORTBY\",\n    category: \"Array\",\n    description: \"Sorts the contents of a range based on another range or array\",\n    syntax: \"SORTBY(array, by_array1, [order1], ...)\",\n    example: \"=SORTBY(A1:B10, A1:A10, -1)\",\n  },\n  UNIQUE: {\n    name: \"UNIQUE\",\n    category: \"Array\",\n    description: \"Returns unique values from a list\",\n    syntax: \"UNIQUE(array, [by_col], [occurs_once])\",\n    example: \"=UNIQUE(A1:A10)\",\n  },\n  SEQUENCE: {\n    name: \"SEQUENCE\",\n    category: \"Array\",\n    description: \"Generates a list of sequential numbers in an array\",\n    syntax: \"SEQUENCE(rows, [columns], [start], [step])\",\n    example: \"=SEQUENCE(5, 1, 1, 1)\",\n  },\n  TRANSPOSE: {\n    name: \"TRANSPOSE\",\n    category: \"Array\",\n    description: \"Transposes an array (rows become columns and vice versa)\",\n    syntax: \"TRANSPOSE(array)\",\n    example: \"=TRANSPOSE(A1:B10)\",\n  },\n  LAMBDA: {\n    name: \"LAMBDA\",\n    category: \"Advanced\",\n    description: \"Creates a custom function that can be reused\",\n    syntax: \"LAMBDA([parameter1, parameter2], calculation)\",\n    example: \"=LAMBDA(x, x*2)\",\n  },\n  LET: {\n    name: \"LET\",\n    category: \"Advanced\",\n    description: \"Assigns names to calculation results to simplify formulas\",\n    syntax: \"LET(name1, value1, [name2, value2], calculation)\",\n    example: \"=LET(x, A1:A10, SUM(x))\",\n  },\n  MAKEARRAY: {\n    name: \"MAKEARRAY\",\n    category: \"Array\",\n    description: \"Creates an array by applying a calculation to each element\",\n    syntax: \"MAKEARRAY(rows, cols, function)\",\n    example: \"=MAKEARRAY(3, 3, LAMBDA(r,c, r*c))\",\n  },\n  MAP: {\n    name: \"MAP\",\n    category: \"Array\",\n    description: \"Maps each value in an array to a new value by applying a calculation\",\n    syntax: \"MAP(array, function)\",\n    example: \"=MAP(A1:A10, LAMBDA(x, x*2))\",\n  },\n  REDUCE: {\n    name: \"REDUCE\",\n    category: \"Array\",\n    description: \"Reduces an array to a single value by applying a calculation\",\n    syntax: \"REDUCE(initial_value, array, function)\",\n    example: \"=REDUCE(0, A1:A10, LAMBDA(a,v, a+v))\",\n  },\n  SCAN: {\n    name: \"SCAN\",\n    category: \"Array\",\n    description: \"Scans an array and returns intermediate results\",\n    syntax: \"SCAN(initial_value, array, function)\",\n    example: \"=SCAN(0, A1:A10, LAMBDA(a,v, a+v))\",\n  },\n  RANDARRAY: {\n    name: \"RANDARRAY\",\n    category: \"Array\",\n    description: \"Creates an array of random numbers\",\n    syntax: \"RANDARRAY([rows], [cols], [min], [max], [decimal_places])\",\n    example: \"=RANDARRAY(5, 1, 1, 100)\",\n  },\n  SWITCH: {\n    name: \"SWITCH\",\n    category: \"Logical\",\n    description: \"Evaluates an expression against a list of values and returns a corresponding result\",\n    syntax: \"SWITCH(expression, value1, result1, [value2, result2], [default])\",\n    example: '=SWITCH(A1, 1, \"One\", 2, \"Two\", \"Other\")',\n  },\n  AGGREGATE: {\n    name: \"AGGREGATE\",\n    category: \"Math\",\n    description: \"Calculates an aggregate value, ignoring errors and hidden rows\",\n    syntax: \"AGGREGATE(function_num, option, ref, [k])\",\n    example: \"=AGGREGATE(9, 6, A1:A10)\",\n  },\n  SUBTOTAL: {\n    name: \"SUBTOTAL\",\n    category: \"Math\",\n    description: \"Calculates subtotals, typically used with filtered data\",\n    syntax: \"SUBTOTAL(function_num, ref1, [ref2], ...)\",\n    example: \"=SUBTOTAL(9, A1:A10)\",\n  },\n  FORECAST: {\n    name: \"FORECAST\",\n    category: \"Statistical\",\n    description: \"Predicts a value using linear regression\",\n    syntax: \"FORECAST(x, known_y's, known_x's)\",\n    example: \"=FORECAST(30, B2:B10, A2:A10)\",\n  },\n  TREND: {\n    name: \"TREND\",\n    category: \"Statistical\",\n    description: \"Returns predicted values based on linear regression\",\n    syntax: \"TREND(known_y's, [known_x's], [new_x's], [const])\",\n    example: \"=TREND(B2:B10, A2:A10)\",\n  },\n  LINEST: {\n    name: \"LINEST\",\n    category: \"Statistical\",\n    description: \"Returns statistics for a linear regression\",\n    syntax: \"LINEST(known_y's, [known_x's], [const], [stats])\",\n    example: \"=LINEST(B2:B10, A2:A10)\",\n  },\n  LOGEST: {\n    name: \"LOGEST\",\n    category: \"Statistical\",\n    description: \"Returns statistics for an exponential regression\",\n    syntax: \"LOGEST(known_y's, [known_x's], [const], [stats])\",\n    example: \"=LOGEST(B2:B10, A2:A10)\",\n  },\n  GROWTH: {\n    name: \"GROWTH\",\n    category: \"Statistical\",\n    description: \"Returns predicted values based on exponential regression\",\n    syntax: \"GROWTH(known_y's, [known_x's], [new_x's], [const])\",\n    example: \"=GROWTH(B2:B10, A2:A10)\",\n  },\n  PERCENTILE: {\n    name: \"PERCENTILE\",\n    category: \"Statistical\",\n    description: \"Returns the k-th percentile of values\",\n    syntax: \"PERCENTILE(array, k)\",\n    example: \"=PERCENTILE(A1:A10, 0.5)\",\n  },\n  QUARTILE: {\n    name: \"QUARTILE\",\n    category: \"Statistical\",\n    description: \"Returns the quartile of a dataset\",\n    syntax: \"QUARTILE(array, quart)\",\n    example: \"=QUARTILE(A1:A10, 2)\",\n  },\n  RANK: {\n    name: \"RANK\",\n    category: \"Statistical\",\n    description: \"Returns the rank of a value in a dataset\",\n    syntax: \"RANK(number, ref, [order])\",\n    example: \"=RANK(A1, A1:A10)\",\n  },\n  PERCENTRANK: {\n    name: \"PERCENTRANK\",\n    category: \"Statistical\",\n    description: \"Returns the percentile rank of a value in a dataset\",\n    syntax: \"PERCENTRANK(array, value)\",\n    example: \"=PERCENTRANK(A1:A10, A1)\",\n  },\n  SKEW: {\n    name: \"SKEW\",\n    category: \"Statistical\",\n    description: \"Returns the skewness of a distribution\",\n    syntax: \"SKEW(number1, [number2], ...)\",\n    example: \"=SKEW(A1:A10)\",\n  },\n  KURT: {\n    name: \"KURT\",\n    category: \"Statistical\",\n    description: \"Returns the kurtosis of a distribution\",\n    syntax: \"KURT(number1, [number2], ...)\",\n    example: \"=KURT(A1:A10)\",\n  },\n  COVAR: {\n    name: \"COVAR\",\n    category: \"Statistical\",\n    description: \"Returns the covariance of two data sets\",\n    syntax: \"COVAR(array1, array2)\",\n    example: \"=COVAR(A1:A10, B1:B10)\",\n  },\n  CORREL: {\n    name: \"CORREL\",\n    category: \"Statistical\",\n    description: \"Returns the correlation between two data sets\",\n    syntax: \"CORREL(array1, array2)\",\n    example: \"=CORREL(A1:A10, B1:B10)\",\n  },\n  RSQ: {\n    name: \"RSQ\",\n    category: \"Statistical\",\n    description: \"Returns the R-squared value of a linear regression\",\n    syntax: \"RSQ(known_y's, known_x's)\",\n    example: \"=RSQ(B1:B10, A1:A10)\",\n  },\n  INTERCEPT: {\n    name: \"INTERCEPT\",\n    category: \"Statistical\",\n    description: \"Returns the y-intercept of a linear regression line\",\n    syntax: \"INTERCEPT(known_y's, known_x's)\",\n    example: \"=INTERCEPT(B1:B10, A1:A10)\",\n  },\n  SLOPE: {\n    name: \"SLOPE\",\n    category: \"Statistical\",\n    description: \"Returns the slope of a linear regression line\",\n    syntax: \"SLOPE(known_y's, known_x's)\",\n    example: \"=SLOPE(B1:B10, A1:A10)\",\n  },\n  STANDARDIZE: {\n    name: \"STANDARDIZE\",\n    category: \"Statistical\",\n    description: \"Returns a normalized value from a distribution\",\n    syntax: \"STANDARDIZE(x, mean, standard_dev)\",\n    example: \"=STANDARDIZE(100, 50, 10)\",\n  },\n  PROB: {\n    name: \"PROB\",\n    category: \"Statistical\",\n    description: \"Returns the probability of values in a range\",\n    syntax: \"PROB(x_range, prob_range, [lower_limit], [upper_limit])\",\n    example: \"=PROB(A1:A10, B1:B10, 1, 3)\",\n  },\n  POISSON: {\n    name: \"POISSON\",\n    category: \"Statistical\",\n    description: \"Returns the Poisson distribution\",\n    syntax: \"POISSON(x, mean, cumulative)\",\n    example: \"=POISSON(5, 2.5, FALSE)\",\n  },\n  BINOMIAL: {\n    name: \"BINOMIAL\",\n    category: \"Statistical\",\n    description: \"Returns the binomial distribution probability\",\n    syntax: \"BINOMIAL(number_s, trials, probability_s, [cumulative])\",\n    example: \"=BINOMIAL(6, 10, 0.5, FALSE)\",\n  },\n  COMBIN: {\n    name: \"COMBIN\",\n    category: \"Math\",\n    description: \"Returns the number of combinations for a given number of items\",\n    syntax: \"COMBIN(number, number_chosen)\",\n    example: \"=COMBIN(10, 3)\",\n  },\n  PERMUT: {\n    name: \"PERMUT\",\n    category: \"Math\",\n    description: \"Returns the number of permutations of objects\",\n    syntax: \"PERMUT(number, number_chosen)\",\n    example: \"=PERMUT(10, 3)\",\n  },\n  GEOMEAN: {\n    name: \"GEOMEAN\",\n    category: \"Statistical\",\n    description: \"Returns the geometric mean of a dataset\",\n    syntax: \"GEOMEAN(number1, [number2], ...)\",\n    example: \"=GEOMEAN(A1:A10)\",\n  },\n  HARMEAN: {\n    name: \"HARMEAN\",\n    category: \"Statistical\",\n    description: \"Returns the harmonic mean of a dataset\",\n    syntax: \"HARMEAN(number1, [number2], ...)\",\n    example: \"=HARMEAN(A1:A10)\",\n  },\n  TRIMMEAN: {\n    name: \"TRIMMEAN\",\n    category: \"Statistical\",\n    description: \"Returns the mean of a dataset excluding top and bottom values\",\n    syntax: \"TRIMMEAN(array, percent)\",\n    example: \"=TRIMMEAN(A1:A10, 0.2)\",\n  },\n  SMALL: {\n    name: \"SMALL\",\n    category: \"Statistical\",\n    description: \"Returns the k-th smallest value in a dataset\",\n    syntax: \"SMALL(array, k)\",\n    example: \"=SMALL(A1:A10, 2)\",\n  },\n  LARGE: {\n    name: \"LARGE\",\n    category: \"Statistical\",\n    description: \"Returns the k-th largest value in a dataset\",\n    syntax: \"LARGE(array, k)\",\n    example: \"=LARGE(A1:A10, 2)\",\n  },\n  COUNTUNIQUE: {\n    name: \"COUNTUNIQUE\",\n    category: \"Math\",\n    description: \"Counts unique values in a range\",\n    syntax: \"COUNTUNIQUE(value1, [value2], ...)\",\n    example: \"=COUNTUNIQUE(A1:A10)\",\n  },\n  BYROW: {\n    name: \"BYROW\",\n    category: \"Array\",\n    description: \"Applies a calculation to each row of an array\",\n    syntax: \"BYROW(array, function)\",\n    example: \"=BYROW(A1:D10, LAMBDA(r, SUM(r)))\",\n  },\n  BYCOL: {\n    name: \"BYCOL\",\n    category: \"Array\",\n    description: \"Applies a calculation to each column of an array\",\n    syntax: \"BYCOL(array, function)\",\n    example: \"=BYCOL(A1:D10, LAMBDA(c, SUM(c)))\",\n  },\n  CONFIDENCE: {\n    name: \"CONFIDENCE\",\n    category: \"Statistical\",\n    description: \"Returns the confidence interval for a population mean\",\n    syntax: \"CONFIDENCE(alpha, standard_dev, size)\",\n    example: \"=CONFIDENCE(0.05, 2.5, 50)\",\n  },\n  DEVSQ: {\n    name: \"DEVSQ\",\n    category: \"Statistical\",\n    description: \"Returns the sum of squared deviations from the mean\",\n    syntax: \"DEVSQ(number1, [number2], ...)\",\n    example: \"=DEVSQ(A1:A10)\",\n  },\n  AVEDEV: {\n    name: \"AVEDEV\",\n    category: \"Statistical\",\n    description: \"Returns the average deviation from the mean\",\n    syntax: \"AVEDEV(number1, [number2], ...)\",\n    example: \"=AVEDEV(A1:A10)\",\n  },\n  STDEVP: {\n    name: \"STDEVP\",\n    category: \"Statistical\",\n    description: \"Calculates the standard deviation of an entire population\",\n    syntax: \"STDEVP(number1, [number2], ...)\",\n    example: \"=STDEVP(A1:A10)\",\n  },\n  STDEVS: {\n    name: \"STDEVS\",\n    category: \"Statistical\",\n    description: \"Calculates the standard deviation of a sample\",\n    syntax: \"STDEVS(number1, [number2], ...)\",\n    example: \"=STDEVS(A1:A10)\",\n  },\n  VARP: {\n    name: \"VARP\",\n    category: \"Statistical\",\n    description: \"Calculates the variance of an entire population\",\n    syntax: \"VARP(number1, [number2], ...)\",\n    example: \"=VARP(A1:A10)\",\n  },\n  VARS: {\n    name: \"VARS\",\n    category: \"Statistical\",\n    description: \"Calculates the variance of a sample\",\n    syntax: \"VARS(number1, [number2], ...)\",\n    example: \"=VARS(A1:A10)\",\n  },\n  AVERAGEA: {\n    name: \"AVERAGEA\",\n    category: \"Math\",\n    description: \"Calculates the average including text and logical values\",\n    syntax: \"AVERAGEA(value1, [value2], ...)\",\n    example: \"=AVERAGEA(A1:A10)\",\n  },\n  PRODUCT: {\n    name: \"PRODUCT\",\n    category: \"Math\",\n    description: \"Multiplies values together\",\n    syntax: \"PRODUCT(number1, [number2], ...)\",\n    example: \"=PRODUCT(A1:A10)\",\n  },\n  SUMSQ: {\n    name: \"SUMSQ\",\n    category: \"Math\",\n    description: \"Returns the sum of squares of the arguments\",\n    syntax: \"SUMSQ(number1, [number2], ...)\",\n    example: \"=SUMSQ(A1:A10)\",\n  },\n  SUMX2MY2: {\n    name: \"SUMX2MY2\",\n    category: \"Math\",\n    description: \"Returns the sum of the difference of squares of corresponding values\",\n    syntax: \"SUMX2MY2(array_x, array_y)\",\n    example: \"=SUMX2MY2(A1:A10, B1:B10)\",\n  },\n  SUMX2PY2: {\n    name: \"SUMX2PY2\",\n    category: \"Math\",\n    description: \"Returns the sum of the sum of squares of corresponding values\",\n    syntax: \"SUMX2PY2(array_x, array_y)\",\n    example: \"=SUMX2PY2(A1:A10, B1:B10)\",\n  },\n  SUMXMY2: {\n    name: \"SUMXMY2\",\n    category: \"Math\",\n    description: \"Returns the sum of squares of differences of corresponding values\",\n    syntax: \"SUMXMY2(array_x, array_y)\",\n    example: \"=SUMXMY2(A1:A10, B1:B10)\",\n  },\n  MINVERSE: {\n    name: \"MINVERSE\",\n    category: \"Math\",\n    description: \"Returns the inverse of a matrix\",\n    syntax: \"MINVERSE(array)\",\n    example: \"=MINVERSE(A1:B2)\",\n  },\n  MMULT: {\n    name: \"MMULT\",\n    category: \"Math\",\n    description: \"Returns the matrix product of two arrays\",\n    syntax: \"MMULT(array1, array2)\",\n    example: \"=MMULT(A1:B2, B1:C2)\",\n  },\n  MDETERM: {\n    name: \"MDETERM\",\n    category: \"Math\",\n    description: \"Returns the determinant of a matrix\",\n    syntax: \"MDETERM(array)\",\n    example: \"=MDETERM(A1:B2)\",\n  },\n  TTEST: {\n    name: \"TTEST\",\n    category: \"Statistical\",\n    description: \"Returns the probability associated with a t-test\",\n    syntax: \"TTEST(array1, array2, tails, type)\",\n    example: \"=TTEST(A1:A10, B1:B10, 2, 1)\",\n  },\n  \"T.TEST\": {\n    name: \"T.TEST\",\n    category: \"Statistical\",\n    description: \"Returns the probability associated with a t-test (newer version)\",\n    syntax: \"T.TEST(array1, array2, tails, type)\",\n    example: \"=T.TEST(A1:A10, B1:B10, 2, 1)\",\n  },\n  FTEST: {\n    name: \"FTEST\",\n    category: \"Statistical\",\n    description: \"Returns the result of an F-test\",\n    syntax: \"FTEST(array1, array2)\",\n    example: \"=FTEST(A1:A10, B1:B10)\",\n  },\n  F_TEST: {\n    name: \"F.TEST\",\n    category: \"Statistical\",\n    description: \"Returns the result of an F-test (newer version)\",\n    syntax: \"F.TEST(array1, array2)\",\n    example: \"=F.TEST(A1:A10, B1:B10)\",\n  },\n  CHI_TEST: {\n    name: \"CHI.TEST\",\n    category: \"Statistical\",\n    description: \"Returns the result of a chi-square test\",\n    syntax: \"CHI.TEST(actual_range, expected_range)\",\n    example: \"=CHI.TEST(A1:A10, B1:B10)\",\n  },\n  ZTEST: {\n    name: \"ZTEST\",\n    category: \"Statistical\",\n    description: \"Returns the one-tailed probability-value of a z-test\",\n    syntax: \"ZTEST(array, x, [sigma])\",\n    example: \"=ZTEST(A1:A10, 50)\",\n  },\n  ZTEST_ALT: {\n    name: \"Z.TEST\",\n    category: \"Statistical\",\n    description: \"Returns the one-tailed probability-value of a z-test (newer version)\",\n    syntax: \"Z.TEST(array, x, [sigma])\",\n    example: \"=Z.TEST(A1:A10, 50)\",\n  },\n  CHITEST: {\n    name: \"CHITEST\",\n    category: \"Statistical\",\n    description: \"Returns the test for independence\",\n    syntax: \"CHITEST(actual_range, expected_range)\",\n    example: \"=CHITEST(A1:A10, B1:B10)\",\n  },\n  CHIINV: {\n    name: \"CHIINV\",\n    category: \"Statistical\",\n    description: \"Returns the inverse of the chi-square distribution\",\n    syntax: \"CHIINV(probability, deg_freedom)\",\n    example: \"=CHIINV(0.05, 5)\",\n  },\n  INVERSE_LOI_KHIDEUX: {\n    name: \"INVERSE.LOI.KHIDEUX\",\n    category: \"Statistical\",\n    description: \"Returns the inverse of the chi-square distribution (French)\",\n    syntax: \"INVERSE.LOI.KHIDEUX(probability, deg_freedom)\",\n    example: \"=INVERSE.LOI.KHIDEUX(0.05, 5)\",\n  },\n  TINV: {\n    name: \"TINV\",\n    category: \"Statistical\",\n    description: \"Returns the inverse of the t-distribution\",\n    syntax: \"TINV(probability, deg_freedom)\",\n    example: \"=TINV(0.05, 10)\",\n  },\n  INVERSE_LOI_T: {\n    name: \"INVERSE.LOI.T\",\n    category: \"Statistical\",\n    description: \"Returns the inverse of the t-distribution (French)\",\n    syntax: \"INVERSE.LOI.T(probability, deg_freedom)\",\n    example: \"=INVERSE.LOI.T(0.05, 10)\",\n  },\n  FINV: {\n    name: \"FINV\",\n    category: \"Statistical\",\n    description: \"Returns the inverse of the F-distribution\",\n    syntax: \"FINV(probability, deg_freedom1, deg_freedom2)\",\n    example: \"=FINV(0.05, 5, 10)\",\n  },\n  INVERSE_LOI_F: {\n    name: \"INVERSE.LOI.F\",\n    category: \"Statistical\",\n    description: \"Returns the inverse of the F-distribution (French)\",\n    syntax: \"INVERSE.LOI.F(probability, deg_freedom1, deg_freedom2)\",\n    example: \"=INVERSE.LOI.F(0.05, 5, 10)\",\n  },\n  TDIST: {\n    name: \"TDIST\",\n    category: \"Statistical\",\n    description: \"Returns the t-distribution\",\n    syntax: \"TDIST(x, deg_freedom, tails)\",\n    example: \"=TDIST(1.5, 10, 2)\",\n  },\n  LOI_T: {\n    name: \"LOI.T\",\n    category: \"Statistical\",\n    description: \"Returns the t-distribution (French)\",\n    syntax: \"LOI.T(x, deg_freedom, tails)\",\n    example: \"=LOI.T(1.5, 10, 2)\",\n  },\n  FDIST: {\n    name: \"FDIST\",\n    category: \"Statistical\",\n    description: \"Returns the F-distribution\",\n    syntax: \"FDIST(x, deg_freedom1, deg_freedom2)\",\n    example: \"=FDIST(1.5, 5, 10)\",\n  },\n  LOI_F: {\n    name: \"LOI.F\",\n    category: \"Statistical\",\n    description: \"Returns the F-distribution (French)\",\n    syntax: \"LOI.F(x, deg_freedom1, deg_freedom2)\",\n    example: \"=LOI.F(1.5, 5, 10)\",\n  },\n  NORMSINV: {\n    name: \"NORMSINV\",\n    category: \"Statistical\",\n    description: \"Returns the inverse of the standard normal distribution\",\n    syntax: \"NORMSINV(probability)\",\n    example: \"=NORMSINV(0.975)\",\n  },\n  LOI_NORMALE_STANDARD_INVERSE: {\n    name: \"LOI.NORMALE.STANDARD.INVERSE\",\n    category: \"Statistical\",\n    description: \"Returns the inverse of the standard normal distribution (French)\",\n    syntax: \"LOI.NORMALE.STANDARD.INVERSE(probability)\",\n    example: \"=LOI.NORMALE.STANDARD.INVERSE(0.975)\",\n  },\n  NORMSDIST: {\n    name: \"NORMSDIST\",\n    category: \"Statistical\",\n    description: \"Returns the standard normal cumulative distribution\",\n    syntax: \"NORMSDIST(z)\",\n    example: \"=NORMSDIST(1.5)\",\n  },\n  LOI_NORMALE_STANDARD: {\n    name: \"LOI.NORMALE.STANDARD\",\n    category: \"Statistical\",\n    description: \"Returns the standard normal cumulative distribution (French)\",\n    syntax: \"LOI.NORMALE.STANDARD(z)\",\n    example: \"=LOI.NORMALE.STANDARD(1.5)\",\n  },\n  NORMINV: {\n    name: \"NORMINV\",\n    category: \"Statistical\",\n    description: \"Returns the inverse of the normal distribution\",\n    syntax: \"NORMINV(probability, mean, standard_dev)\",\n    example: \"=NORMINV(0.975, 50, 10)\",\n  },\n  LOI_NORMALE_INVERSE: {\n    name: \"LOI.NORMALE.INVERSE\",\n    category: \"Statistical\",\n    description: \"Returns the inverse of the normal distribution (French)\",\n    syntax: \"LOI.NORMALE.INVERSE(probability, mean, standard_dev)\",\n    example: \"=LOI.NORMALE.INVERSE(0.975, 50, 10)\",\n  },\n  HYPGEOM: {\n    name: \"HYPGEOM\",\n    category: \"Statistical\",\n    description: \"Returns the hypergeometric distribution\",\n    syntax: \"HYPGEOM(sample_s, number_sample, population_s, number_pop)\",\n    example: \"=HYPGEOM(4, 20, 10, 50)\",\n  },\n  LOGNORM: {\n    name: \"LOGNORM\",\n    category: \"Statistical\",\n    description: \"Returns the lognormal distribution\",\n    syntax: \"LOGNORM(x, mean, standard_dev, [cumulative])\",\n    example: \"=LOGNORM(4, 2, 0.5)\",\n  },\n  WEIBULL: {\n    name: \"WEIBULL\",\n    category: \"Statistical\",\n    description: \"Returns the Weibull distribution\",\n    syntax: \"WEIBULL(x, alpha, beta, [cumulative])\",\n    example: \"=WEIBULL(5, 2, 1)\",\n  },\n  GAMMA: {\n    name: \"GAMMA\",\n    category: \"Statistical\",\n    description: \"Returns the gamma distribution\",\n    syntax: \"GAMMA(x, alpha, beta, [cumulative])\",\n    example: \"=GAMMA(5, 2, 1)\",\n  },\n  BETA: {\n    name: \"BETA\",\n    category: \"Statistical\",\n    description: \"Returns the beta distribution\",\n    syntax: \"BETA(x, alpha, beta, [a], [b])\",\n    example: \"=BETA(0.5, 2, 3)\",\n  },\n};\n\nexport function getFormulaDoc(formulaName: string): FormulaDoc | undefined {\n  return FORMULAS_DOCUMENTATION[formulaName.toUpperCase()];\n}\n\nexport function getAllFormulasInCategory(category: string): FormulaDoc[] {\n  return Object.values(FORMULAS_DOCUMENTATION).filter((doc) => doc.category === category);\n}\n\nexport function getAllCategories(): string[] {\n  const categories = new Set(Object.values(FORMULAS_DOCUMENTATION).map((doc) => doc.category));\n  return Array.from(categories).sort();\n}\n", "import { ExcelExpression, FormulaExpr } from \"./types\";\nimport { getFormulaDoc } from \"./formulas-documentation\";\n\nexport interface ExtractedFormula {\n  name: string;\n  doc?: ReturnType<typeof getFormulaDoc>;\n  count: number;\n}\n\nexport function extractFormulasFromExpression(expression: ExcelExpression): ExtractedFormula[] {\n  const formulasMap = new Map<string, ExtractedFormula>();\n\n  function traverse(expr: ExcelExpression) {\n    if (expr instanceof FormulaExpr) {\n      const formulaName = expr.formula;\n      const doc = getFormulaDoc(formulaName);\n\n      if (formulasMap.has(formulaName)) {\n        const existing = formulasMap.get(formulaName)!;\n        existing.count++;\n      } else {\n        formulasMap.set(formulaName, {\n          name: formulaName,\n          doc,\n          count: 1,\n        });\n      }\n    }\n\n    // Recursively traverse children\n    for (const child of expr.getChilds()) {\n      traverse(child);\n    }\n  }\n\n  traverse(expression);\n\n  // Sort by count (descending) then by name\n  return Array.from(formulasMap.values()).sort((a, b) => {\n    if (b.count !== a.count) {\n      return b.count - a.count;\n    }\n    return a.name.localeCompare(b.name);\n  });\n}\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GAAA,IAAAI,EAAyE,wBACzEC,EAAoC,iBCC7B,IAAKC,OAEVA,EAAA,GAAK,KACLA,EAAA,IAAM,MACNA,EAAA,IAAM,MACNA,EAAA,GAAK,KACLA,EAAA,IAAM,MACNA,EAAA,QAAU,UACVA,EAAA,KAAO,OACPA,EAAA,QAAU,UACVA,EAAA,KAAO,OACPA,EAAA,QAAU,UACVA,EAAA,SAAW,WACXA,EAAA,OAAS,SAGTA,EAAA,GAAK,KACLA,EAAA,IAAM,MACNA,EAAA,GAAK,KACLA,EAAA,GAAK,KACLA,EAAA,IAAM,MACNA,EAAA,SAAW,WACXA,EAAA,KAAO,OACPA,EAAA,UAAY,YACZA,EAAA,MAAQ,QACRA,EAAA,QAAU,UACVA,EAAA,OAAS,SACTA,EAAA,SAAW,WAGXA,EAAA,IAAM,MACNA,EAAA,MAAQ,QACRA,EAAA,OAAS,SACTA,EAAA,WAAa,aACbA,EAAA,QAAU,UACVA,EAAA,UAAY,YACZA,EAAA,WAAa,aACbA,EAAA,MAAQ,QACRA,EAAA,OAAS,SACTA,EAAA,WAAa,aACbA,EAAA,QAAU,UACVA,EAAA,SAAW,WACXA,EAAA,IAAM,MACNA,EAAA,KAAO,OACPA,EAAA,IAAM,MACNA,EAAA,KAAO,OACPA,EAAA,OAAS,SACTA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,IAAM,MAGNA,EAAA,MAAQ,QACRA,EAAA,SAAW,WACXA,EAAA,aAAe,eACfA,EAAA,UAAY,YACZA,EAAA,QAAU,UACVA,EAAA,WAAa,aACbA,EAAA,eAAiB,iBACjBA,EAAA,GAAK,KACLA,EAAA,MAAQ,QACRA,EAAA,QAAU,UACVA,EAAA,MAAQ,QACRA,EAAA,UAAY,YACZA,EAAA,QAAU,UACVA,EAAA,SAAW,WAGXA,EAAA,MAAQ,QACRA,EAAA,QAAU,UACVA,EAAA,UAAY,YACZA,EAAA,QAAU,UACVA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QACRA,EAAA,IAAM,MACNA,EAAA,IAAM,MACNA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,IAAM,MACNA,EAAA,GAAK,KACLA,EAAA,IAAM,MACNA,EAAA,MAAQ,QACRA,EAAA,IAAM,MACNA,EAAA,KAAO,OACPA,EAAA,YAAc,cAGdA,EAAA,QAAU,UACVA,EAAA,YAAc,cACdA,EAAA,YAAc,cACdA,EAAA,QAAU,UACVA,EAAA,SAAW,WACXA,EAAA,QAAU,UACVA,EAAA,IAAM,MACNA,EAAA,OAAS,SACTA,EAAA,UAAY,YACZA,EAAA,KAAO,OACPA,EAAA,kBAAoB,oBAGpBA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,OAAS,SACTA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QACRA,EAAA,OAAS,SACTA,EAAA,SAAW,WACXA,EAAA,OAAS,SACTA,EAAA,IAAM,MACNA,EAAA,OAAS,SACTA,EAAA,KAAO,OACPA,EAAA,QAAU,UAGVA,EAAA,WAAa,aACbA,EAAA,WAAa,aACbA,EAAA,WAAa,aACbA,EAAA,UAAY,YACZA,EAAA,MAAQ,QACRA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,MAAQ,QACRA,EAAA,QAAU,UACVA,EAAA,OAAS,SACTA,EAAA,SAAW,WAGXA,EAAA,YAAc,cACdA,EAAA,OAAS,SACTA,EAAA,SAAW,WACXA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,IAAM,MACNA,EAAA,IAAM,MACNA,EAAA,KAAO,OACPA,EAAA,OAAS,SACTA,EAAA,WAAa,aACbA,EAAA,QAAU,UACVA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QACRA,EAAA,OAAS,SACTA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QACRA,EAAA,KAAO,OACPA,EAAA,KAAO,OACPA,EAAA,KAAO,OACPA,EAAA,MAAQ,QAGRA,EAAA,WAAa,aACbA,EAAA,cAAgB,gBAChBA,EAAA,OAAS,SACTA,EAAA,OAAS,SACTA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,QAAU,UACVA,EAAA,OAAS,SACTA,EAAA,UAAY,YACZA,EAAA,UAAY,YACZA,EAAA,UAAY,YACZA,EAAA,UAAY,YACZA,EAAA,UAAY,YACZA,EAAA,YAAc,cACdA,EAAA,QAAU,UACVA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,IAAM,MAGNA,EAAA,MAAQ,QACRA,EAAA,IAAM,MACNA,EAAA,KAAO,OACPA,EAAA,KAAO,OACPA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,IAAM,MACNA,EAAA,KAAO,OACPA,EAAA,OAAS,SACTA,EAAA,OAAS,SACTA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,YAAc,cACdA,EAAA,MAAQ,QACRA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,UAAY,YACZA,EAAA,UAAY,YAGZA,EAAA,WAAa,aACbA,EAAA,WAAa,aACbA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QACRA,EAAA,KAAO,OACPA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,WAAa,aACbA,EAAA,iBAAmB,mBACnBA,EAAA,gBAAkB,kBAClBA,EAAA,aAAe,eACfA,EAAA,SAAW,WACXA,EAAA,QAAU,UACVA,EAAA,SAAW,WAGXA,EAAA,IAAM,MACNA,EAAA,GAAK,KACLA,EAAA,GAAK,KACLA,EAAA,KAAO,OACPA,EAAA,KAAO,OACPA,EAAA,IAAM,MACNA,EAAA,IAAM,MACNA,EAAA,KAAO,OACPA,EAAA,KAAO,OAGPA,EAAA,IAAM,MACNA,EAAA,GAAK,KACLA,EAAA,GAAK,KACLA,EAAA,KAAO,OACPA,EAAA,IAAM,MACNA,EAAA,IAAM,MACNA,EAAA,IAAM,MACNA,EAAA,KAAO,OACPA,EAAA,KAAO,OAGPA,EAAA,KAAO,OACPA,EAAA,SAAW,WACXA,EAAA,OAAS,SACTA,EAAA,QAAU,UACVA,EAAA,KAAO,OACPA,EAAA,KAAO,OAGPA,EAAA,QAAU,UACVA,EAAA,UAAY,YACZA,EAAA,KAAO,OACPA,EAAA,QAAU,UACVA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QAGRA,EAAA,QAAU,UAGVA,EAAA,OAAS,SACTA,EAAA,KAAO,OACPA,EAAA,OAAS,SACTA,EAAA,OAAS,SACTA,EAAA,SAAW,WACXA,EAAA,UAAY,YAGZA,EAAA,OAAS,SACTA,EAAA,MAAQ,QACRA,EAAA,UAAY,YAGZA,EAAA,OAAS,SACTA,EAAA,IAAM,MACNA,EAAA,UAAY,YACZA,EAAA,IAAM,MACNA,EAAA,OAAS,SACTA,EAAA,KAAO,OACPA,EAAA,UAAY,YACZA,EAAA,OAAS,SACTA,EAAA,UAAY,YACZA,EAAA,SAAW,WACXA,EAAA,SAAW,WACXA,EAAA,MAAQ,QACRA,EAAA,OAAS,SACTA,EAAA,OAAS,SACTA,EAAA,OAAS,SACTA,EAAA,WAAa,aACbA,EAAA,SAAW,WACXA,EAAA,KAAO,OACPA,EAAA,YAAc,cACdA,EAAA,KAAO,OACPA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,OAAS,SACTA,EAAA,IAAM,MACNA,EAAA,UAAY,YACZA,EAAA,MAAQ,QACRA,EAAA,YAAc,cACdA,EAAA,KAAO,OACPA,EAAA,QAAU,UACVA,EAAA,SAAW,WACXA,EAAA,OAAS,SACTA,EAAA,OAAS,SACTA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,UAAY,YACZA,EAAA,SAAW,WACXA,EAAA,MAAQ,QACRA,EAAA,KAAO,OACPA,EAAA,MAAQ,QACRA,EAAA,KAAO,OACPA,EAAA,QAAU,UACVA,EAAA,OAAS,SACTA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QACRA,EAAA,OAAS,SACTA,EAAA,MAAQ,QACRA,EAAA,OAAS,SACTA,EAAA,SAAW,WACXA,EAAA,UAAY,SACZA,EAAA,QAAU,UACVA,EAAA,QAAU,UACVA,EAAA,SAAW,WACXA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QACRA,EAAA,YAAc,cACdA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QACRA,EAAA,WAAa,aACbA,EAAA,MAAQ,QACRA,EAAA,OAAS,SACTA,EAAA,OAAS,SACTA,EAAA,OAAS,SACTA,EAAA,KAAO,OACPA,EAAA,KAAO,OACPA,EAAA,SAAW,WACXA,EAAA,QAAU,UACVA,EAAA,MAAQ,QACRA,EAAA,SAAW,WACXA,EAAA,SAAW,WACXA,EAAA,QAAU,UACVA,EAAA,SAAW,WACXA,EAAA,MAAQ,QACRA,EAAA,QAAU,UAGVA,EAAA,cAAgB,gBAChBA,EAAA,UAAY,YACZA,EAAA,QAAU,UACVA,EAAA,SAAW,WACXA,EAAA,mBAAqB,qBACrBA,EAAA,SAAW,WACXA,EAAA,WAAa,aACbA,EAAA,UAAY,YACZA,EAAA,SAAW,WACXA,EAAA,UAAY,YACZA,EAAA,OAAS,SACTA,EAAA,WAAa,aACbA,EAAA,KAAO,OACPA,EAAA,YAAc,cACdA,EAAA,YAAc,cACdA,EAAA,eAAiB,iBACjBA,EAAA,iBAAmB,mBACnBA,EAAA,MAAQ,QACRA,EAAA,gBAAkB,kBAClBA,EAAA,YAAc,cACdA,EAAA,WAAa,aACbA,EAAA,YAAc,cACdA,EAAA,oBAAsB,sBACtBA,EAAA,qBAAuB,uBACvBA,EAAA,6BAA+B,+BAC/BA,EAAA,MAAQ,QACRA,EAAA,cAAgB,gBAChBA,EAAA,MAAQ,QACRA,EAAA,cAAgB,gBAChBA,EAAA,aAAe,eACfA,EAAA,oBAAsB,sBACtBA,EAAA,OAAS,SACTA,EAAA,OAAS,SACTA,EAAA,OAAS,SACTA,EAAA,oBAAsB,sBACtBA,EAAA,mBAAqB,qBACrBA,EAAA,gBAAkB,kBAClBA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QACRA,EAAA,aAAe,eACfA,EAAA,UAAY,YACZA,EAAA,YAAc,cACdA,EAAA,qBAAuB,uBACvBA,EAAA,oBAAsB,sBACtBA,EAAA,eAAiB,iBACjBA,EAAA,aAAe,eACfA,EAAA,cAAgB,gBAChBA,EAAA,QAAU,UACVA,EAAA,SAAW,WACXA,EAAA,SAAW,WACXA,EAAA,QAAU,UACVA,EAAA,aAAe,eACfA,EAAA,kBAAoB,oBACpBA,EAAA,mBAAqB,qBACrBA,EAAA,oBAAsB,sBACtBA,EAAA,gBAAkB,kBAClBA,EAAA,gBAAkB,kBAClBA,EAAA,oBAAsB,sBAhZZA,OAAA,ICEL,IAAMC,EAAN,KAAsB,CAClB,SACD,OAAiC,CAAC,EAE1C,YAAYC,EAAkB,CAC5B,KAAK,SAAWA,CAClB,CAEA,SAASC,EAA8B,CACrC,KAAK,OAAO,KAAKA,CAAK,CACxB,CAEA,WAAoC,CAClC,OAAO,KAAK,MACd,CACF,EAEaC,EAAN,cAA4BH,CAAgB,CAAC,EAEvCI,EAAN,cAA0BJ,CAAgB,CACtC,QAET,YAAYC,EAAkBI,EAAuB,CACnD,MAAMJ,CAAQ,EACd,KAAK,QAAUI,CACjB,CACF,EAIO,IAAMC,EAAN,cAAiCC,CAAgB,CAC7C,SAET,YAAYC,EAAkB,CAC5B,MAAMA,CAAQ,EACd,KAAK,SAAWA,CAClB,CACF,EAEaC,EAAN,cAAsCF,CAAgB,CAClD,MACA,OACA,IACA,iBACA,cAET,YACEG,EACAC,EACAC,EACAC,EACAC,EACAC,EACA,CACA,MAAML,CAAQ,EACd,KAAK,MAAQC,EACb,KAAK,OAASC,EACd,KAAK,IAAMC,EACX,KAAK,iBAAmBC,EACxB,KAAK,cAAgBC,CACvB,CAEA,kBAA2B,CACzB,IAAMC,EAAc,KAAK,MAAQ,GAAG,KAAK,KAAK,IAAM,GAC9CC,EAAY,KAAK,iBAAmB,IAAM,GAC1CC,EAAY,KAAK,cAAgB,IAAM,GAC7C,MAAO,GAAGF,CAAW,GAAGC,CAAS,GAAG,KAAK,MAAM,GAAGC,CAAS,GAAG,KAAK,GAAG,EACxE,CACF,EAEaC,EAAN,cAAkCZ,CAAgB,CAC9C,MACA,UACA,QAET,YACEG,EACAC,EACAS,EACAC,EACA,CACA,MAAMX,CAAQ,EACd,KAAK,MAAQC,EACb,KAAK,UAAYS,EACjB,KAAK,QAAUC,CACjB,CAEA,kBAA2B,CAEzB,MAAO,GADa,KAAK,MAAQ,GAAG,KAAK,KAAK,IAAM,EAC/B,GAAG,KAAK,UAAU,iBAAiB,EAAE,QAAQ,OAAQ,EAAE,CAAC,IAAI,KAAK,QAAQ,iBAAiB,EAAE,QAAQ,OAAQ,EAAE,CAAC,EACtI,CACF,EAUaC,EAAgD,CAC3D,qBAAsB,GACtB,mBAAoB,GACpB,WAAY,EACZ,gBAAiB,GACjB,gBAAiB,CACnB,ECnGO,IAAMC,EAAN,KAAyB,CAC9B,OAAwB,aAA8B,OAAO,OAAOC,CAAY,EAChF,OAAwB,gBAAgD,CACtE,GAAG,OAAO,QAAQA,CAAY,EAAE,OAC9B,CAACC,EAAK,CAAC,CAAEC,CAAK,KACZD,EAAIC,CAAK,EAAIA,EACND,GAET,CAAC,CACH,CACF,EAGA,OAAwB,UAA2B,CACjD,KACA,KACA,KACA,KACA,KACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,GACF,EAEA,OAAe,eAAeE,EAAeC,EAAiC,CAE5E,GAAIA,EAAWD,EAAM,OAAS,EAAG,CAC/B,IAAME,EAAUF,EAAM,UAAUC,EAAUA,EAAW,CAAC,EACtD,GAAI,KAAK,UAAU,SAASC,CAAO,EACjC,OAAOA,CAEX,CAGA,IAAMC,EAAUH,EAAM,OAAOC,CAAQ,EACrC,OAAI,KAAK,UAAU,SAASE,CAAO,EAC1BA,EAGF,IACT,CAEA,OAAe,mBAAmBC,EAAoE,CAKpG,OAHAA,EAAOA,EAAK,KAAK,EAGbA,EAAK,SAAS,GAAG,EACZ,KAAK,eAAeA,CAAI,EAI1B,KAAK,yBAAyBA,CAAI,CAC3C,CAEA,OAAe,eAAeA,EAA0C,CAEtE,IAAMC,EAAQD,EAAK,MAAM,GAAG,EAC5B,GAAIC,EAAM,SAAW,EACnB,OAAO,KAGT,GAAM,CAACC,EAAWC,CAAO,EAAIF,EACzBG,EACAC,EAAQH,EACNI,EAAMH,EAGZ,GAAIE,EAAM,SAAS,GAAG,EAAG,CACvB,IAAME,EAAaF,EAAM,MAAM,GAAG,EAClCD,EAAQG,EAAW,CAAC,EAAE,QAAQ,SAAU,EAAE,EAC1CF,EAAQE,EAAW,CAAC,CACtB,CAGA,IAAMC,EAAY,KAAK,yBAAyBH,CAAK,EAC/CI,EAAU,KAAK,yBAAyBH,CAAG,EAEjD,MAAI,CAACE,GAAa,CAACC,EACV,KAGF,IAAIC,EAAoBV,EAAMI,EAAOI,EAAWC,CAAO,CAChE,CAEA,OAAe,yBAAyBT,EAA8C,CAGpF,IAAMW,EAAc,0CACdC,EAAQZ,EAAK,MAAMW,CAAW,EAEpC,GAAI,CAACC,EACH,OAAO,KAGT,GAAM,CAAC,CAAER,EAAOS,EAAaC,EAAQC,EAAaC,CAAG,EAAIJ,EAGnDK,EAAab,EAAQA,EAAM,QAAQ,SAAU,EAAE,EAAI,OAEzD,OAAO,IAAIc,EACTlB,EACAiB,EACAH,EAAO,YAAY,EACnBE,EACAH,IAAgB,IAChBE,IAAgB,GAClB,CACF,CAEA,OAAe,iBACbI,EACAC,EACAxB,EACAyB,EACQ,CACR,IAAIC,EAAQ,GACR,EAAYF,EACZG,EAAgB,GAEpB,KAAO,EAAI3B,EAAM,QAAQ,CACvB,IAAM4B,EAAO5B,EAAM,CAAC,EACd6B,EAAW,EAAI,EAAI7B,EAAM,EAAI,CAAC,EAAI,GAGxC,GAAI4B,IAAS,KAAOC,IAAa,KAAM,CACrCF,EAAgB,CAACA,EACjBD,GAASE,EACT,IACA,QACF,CAGA,GAAID,EAAe,CACjBD,GAASE,EACT,IACA,QACF,CAEA,IAAME,EAAW,KAAK,eAAe9B,EAAO,CAAC,EAE7C,GAAI4B,IAAS,IACX,GAAIF,EAAM,KAAK,EAAE,OAAS,EAAG,CAE3B,IAAMK,EAAaL,EAAM,KAAK,EAAE,YAAY,EAC5C,GAAI,KAAK,aAAa,SAASK,CAAU,EAAG,CAC1C,IAAMC,EAAc,KAAK,gBAAgBD,CAAU,EAC/CC,IACF,EAAI,KAAK,aAAaT,EAAQS,EAAa,EAAGhC,EAAOyB,CAAS,EAC9DC,EAAQ,GAEZ,KAAO,CAEL,IAAMO,EAAU,KAAK,mBAAmBP,EAAM,KAAK,CAAC,EAChDO,EACFV,EAAO,SAASU,CAAO,EAEvBV,EAAO,SAAS,IAAIW,EAAgBR,EAAM,KAAK,CAAC,CAAC,EAEnDA,EAAQ,GACR,IAAMS,EAAa,IAAIC,EAAc,EAAE,EACvCb,EAAO,SAASY,CAAU,EAC1B,EAAI,KAAK,iBAAiBA,EAAY,EAAI,EAAGnC,EAAOyB,CAAS,CAC/D,CACF,KAAO,CAEL,IAAMU,EAAa,IAAIC,EAAc,EAAE,EACvCb,EAAO,SAASY,CAAU,EAC1B,EAAI,KAAK,iBAAiBA,EAAY,EAAI,EAAGnC,EAAOyB,CAAS,CAC/D,SACSG,IAAS,IAAK,CACvB,GAAIF,EAAM,KAAK,EAAE,OAAS,EAAG,CAC3B,IAAMO,EAAU,KAAK,mBAAmBP,EAAM,KAAK,CAAC,EAChDO,EACFV,EAAO,SAASU,CAAO,EAEvBV,EAAO,SAAS,IAAIW,EAAgBR,EAAM,KAAK,CAAC,CAAC,CAErD,CACA,OAAO,CACT,SAAWI,EAAU,CAEnB,GAAIJ,EAAM,KAAK,EAAE,OAAS,EAAG,CAC3B,IAAMO,EAAU,KAAK,mBAAmBP,EAAM,KAAK,CAAC,EAChDO,EACFV,EAAO,SAASU,CAAO,EAEvBV,EAAO,SAAS,IAAIW,EAAgBR,EAAM,KAAK,CAAC,CAAC,EAEnDA,EAAQ,EACV,CACAH,EAAO,SAAS,IAAIc,EAAmBP,CAAQ,CAAC,EAChD,GAAKA,EAAS,OAAS,CACzB,MACEJ,GAASE,EAKX,GACF,CAEA,GAAIF,EAAM,KAAK,EAAE,OAAS,EAAG,CAC3B,IAAMO,EAAU,KAAK,mBAAmBP,EAAM,KAAK,CAAC,EAChDO,EACFV,EAAO,SAASU,CAAO,EAEvBV,EAAO,SAAS,IAAIW,EAAgBR,EAAM,KAAK,CAAC,CAAC,CAErD,CAEA,OAAO,CACT,CAEA,OAAe,aACbH,EACAe,EACAd,EACAxB,EACAyB,EACQ,CACR,IAAMc,EAAc,IAAIC,EAAY,GAAIF,CAAO,EAC/Cf,EAAO,SAASgB,CAAW,EAE3B,IAAIE,EAAI,KAAK,gBAAgB,IAAKjB,EAAYxB,CAAK,EAC/C0B,EAAQ,GACRgB,EAAa,EAEjB,KAAOD,EAAIzC,EAAM,QAAQ,CACvB,GAAIA,EAAMyC,CAAC,IAAMhB,GAAaiB,IAAe,EAAG,CAC9C,GAAIhB,EAAM,KAAK,EAAE,OAAS,EAAG,CAC3B,IAAMiB,EAAkB,IAAIT,EAAgBR,EAAM,KAAK,CAAC,EAGxD,GAFA,KAAK,iBAAiBiB,EAAiB,EAAGjB,EAAOD,CAAS,EAEtDkB,EAAgB,UAAU,EAAE,SAAW,EACzCJ,EAAY,SAASI,EAAgB,UAAU,EAAE,CAAC,CAAC,UAC1CA,EAAgB,UAAU,EAAE,OAAS,EAC9CJ,EAAY,SAASI,CAAe,MAC/B,CAEL,IAAMV,EAAU,KAAK,mBAAmBP,EAAM,KAAK,CAAC,EAChDO,EACFM,EAAY,SAASN,CAAO,EAE5BM,EAAY,SAAS,IAAIL,EAAgBR,EAAM,KAAK,CAAC,CAAC,CAE1D,CACF,CACAA,EAAQ,EACV,KAAO,CAOL,GANI1B,EAAMyC,CAAC,IAAM,IACfC,IACS1C,EAAMyC,CAAC,IAAM,KACtBC,IAGEA,EAAa,EAAG,CAElB,GAAIhB,EAAM,KAAK,EAAE,OAAS,EAAG,CAC3B,IAAMiB,EAAkB,IAAIT,EAAgBR,EAAM,KAAK,CAAC,EAGxD,GAFA,KAAK,iBAAiBiB,EAAiB,EAAGjB,EAAOD,CAAS,EAEtDkB,EAAgB,UAAU,EAAE,SAAW,EACzCJ,EAAY,SAASI,EAAgB,UAAU,EAAE,CAAC,CAAC,UAC1CA,EAAgB,UAAU,EAAE,OAAS,EAC9CJ,EAAY,SAASI,CAAe,MAC/B,CAEL,IAAMV,EAAU,KAAK,mBAAmBP,EAAM,KAAK,CAAC,EAChDO,EACFM,EAAY,SAASN,CAAO,EAE5BM,EAAY,SAAS,IAAIL,EAAgBR,EAAM,KAAK,CAAC,CAAC,CAE1D,CACF,CACA,OAAOe,CACT,CAEAf,GAAS1B,EAAMyC,CAAC,CAClB,CACAA,GACF,CAGA,MAAM,IAAI,MAAM,YAAYH,CAAO,iCAAiC,CACtE,CAEA,OAAe,gBAAgBV,EAAcJ,EAAoBxB,EAAuB,CACtF,IAAIyC,EAAIjB,EACR,KAAOiB,EAAIzC,EAAM,QAAUA,EAAMyC,CAAC,IAAMb,GACtCa,IAEF,OAAOA,EAAI,CACb,CAEA,OAAe,gBAAgBH,EAAuB,CAEpD,IAAIM,EAAa,EACbC,EAAgB,GAChBlB,EAAgB,GAEpB,QAASc,EAAI,EAAGA,EAAIH,EAAQ,OAAQG,IAAK,CACvC,IAAMb,EAAOU,EAAQG,CAAC,EAChBZ,EAAWY,EAAI,EAAIH,EAAQG,EAAI,CAAC,EAAI,GAG1C,GAAIb,IAAS,KAAOC,IAAa,KAAM,CACrCgB,EAAgB,CAACA,EACjB,QACF,CACA,GAAIjB,IAAS,KAAOC,IAAa,KAAM,CACrCF,EAAgB,CAACA,EACjB,QACF,CAGA,GAAI,EAAAkB,GAAiBlB,IAIrB,GAAIC,IAAS,IACXgB,YACShB,IAAS,MAClBgB,IACIA,EAAa,GACf,MAAM,IAAI,MAAM,oCAAoC,EAG1D,CAGA,GAAIC,EACF,MAAM,IAAI,MAAM,kCAAkC,EAEpD,GAAIlB,EACF,MAAM,IAAI,MAAM,kCAAkC,EAIpD,GAAIiB,EAAa,EACf,MAAM,IAAI,MAAM,WAAWA,CAAU,uBAAuBA,EAAa,EAAI,KAAO,EAAE,MAAM,EAI9F,IAAME,EAAUR,EAAQ,KAAK,EAC7B,GAAIQ,EAAQ,OAAS,EAAG,CACtB,IAAMC,EAAWD,EAAQA,EAAQ,OAAS,CAAC,EAC3C,GAAI,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAG,EAAE,SAASC,CAAQ,EAC5D,MAAM,IAAI,MAAM,qCAAqCA,CAAQ,GAAG,CAEpE,CAIA,GAD0B,2BACJ,KAAKT,CAAO,EAAG,CACnC,IAAMtB,EAAQsB,EAAQ,MAAM,4BAA4B,EACxD,GAAItB,EACF,MAAM,IAAI,MAAM,YAAYA,EAAM,CAAC,EAAE,QAAQ,KAAM,EAAE,CAAC,wBAAwB,CAElF,CACF,CAEA,OAAO,MAAMsB,EAAkC,CAE7C,IAAIU,EAAeV,EAAQ,KAAK,EAC5BU,EAAa,WAAW,GAAG,IAC7BA,EAAeA,EAAa,UAAU,CAAC,GAIzC,KAAK,gBAAgBA,CAAY,EAGjC,IAAMvB,EAAYuB,EAAa,SAAS,GAAG,EAAI,IAAM,IAErD,GAAI,CACF,IAAMC,EAAiB,IAAIf,EAAgBc,CAAY,EACvD,YAAK,iBAAiBC,EAAgB,EAAGD,EAAcvB,CAAS,EAEzDwB,CACT,OAASC,EAAO,CAEd,MAAIA,aAAiB,MACb,IAAI,MAAMA,EAAM,OAAO,EAEzB,IAAI,MAAM,wBAAwB,CAC1C,CACF,CACF,EC1YO,IAAMC,EAAN,KAA4B,CACzB,QAER,YAAYC,EAAsC,CAAC,EAAG,CACpD,KAAK,QAAU,CAAE,GAAGC,EAA4B,GAAGD,CAAQ,CAC7D,CAEA,OAAOE,EAA6BC,EAAyB,GAAe,CAC1E,IAAMC,EAAS,KAAK,YAAYF,EAAY,CAAC,EAC7C,OAAQC,EAAgB,IAAM,IAAMC,CACtC,CAEQ,YAAYF,EAA6BG,EAAuB,CACtE,IAAMC,EAAWJ,EAAW,UAAU,EAGtC,GAAII,EAAS,SAAW,EACtB,OAAOJ,EAAW,UAAY,GAGhC,IAAIE,EAAS,GAEb,QAASG,EAAI,EAAGA,EAAID,EAAS,OAAQC,IAAK,CACxC,IAAMC,EAAQF,EAASC,CAAC,EAEpBC,aAAiBC,EACnBL,GAAU,KAAK,eAAeI,EAAOH,CAAK,EACjCG,aAAiBE,EAC1BN,GAAU,KAAK,oBAAoBI,EAAOH,CAAK,EACtCG,aAAiBG,EAC1BP,GAAU,KAAK,eAAeI,EAAOD,EAAGD,CAAQ,EACvCE,aAAiBI,EAC1BR,GAAU,KAAK,oBAAoBI,CAAK,EAC/BA,aAAiBK,EAC1BT,GAAU,KAAK,gBAAgBI,CAAK,EAGhCA,EAAM,UAAU,EAAE,SAAW,EAC/BJ,GAAUI,EAAM,UAAY,GAE5BJ,GAAU,KAAK,YAAYI,EAAOH,CAAK,CAG7C,CAEA,OAAOD,CACT,CAEQ,eAAeU,EAAmBT,EAAuB,CAC/D,IAAMU,EAASD,EAAK,UAAU,EAC9B,GAAIC,EAAO,SAAW,EACpB,OAAOD,EAAK,QAAU,KAIxB,GAAI,KAAK,mBAAmBA,CAAI,EAAG,CACjC,IAAIV,EAASU,EAAK,QAAU,IAC5B,QAAS,EAAI,EAAG,EAAIC,EAAO,OAAQ,IAAK,CACtC,IAAMC,EAAQD,EAAO,CAAC,EAChBE,EAAS,IAAMF,EAAO,OAAS,EAErC,GAAIC,aAAiBP,GAAe,KAAK,mBAAmBO,CAAK,EAC/DZ,GAAU,KAAK,eAAeY,EAAOX,EAAQ,CAAC,UACrCW,aAAiBN,EAC1BN,GAAU,KAAK,oBAAoBY,EAAOX,CAAK,MAC1C,CACL,IAAMa,EAAeF,EAAM,UAAU,EAAE,SAAW,EAAIA,EAAM,UAAY,GAAK,KAAK,YAAYA,EAAOX,CAAK,EAC1GD,GAAUc,GAAgB,EAC5B,CAEKD,IACHb,GAAU,KAEd,CACA,OAAAA,GAAU,IACHA,CACT,CAGA,IAAIA,EAASU,EAAK,QAAU;AAAA,EAE5B,QAASP,EAAI,EAAGA,EAAIQ,EAAO,OAAQR,IAAK,CACtC,IAAMS,EAAQD,EAAOR,CAAC,EAChBU,EAASV,IAAMQ,EAAO,OAAS,EAQrC,GALAX,GAAU,KAAK,OAAOC,EAAQ,CAAC,EAC3B,KAAK,QAAQ,uBACfD,GAAU,KAAK,oBAAoBC,EAAQ,EAAGY,CAAM,GAGlDD,aAAiBP,EAAa,CAEhC,IAAMU,EAAiB,KAAK,eAAeH,EAAOX,EAAQ,CAAC,EAC3DD,GAAUe,CACZ,SAAWH,aAAiBN,EAAe,CACzC,IAAMU,EAAY,KAAK,oBAAoBJ,EAAOX,EAAQ,CAAC,EAC3DD,GAAUgB,CACZ,KAAO,CAEL,IAAMF,EAAeF,EAAM,UAAU,EAAE,SAAW,EAAIA,EAAM,UAAY,GAAK,KAAK,YAAYA,EAAOX,EAAQ,CAAC,EAC9GD,GAAUc,GAAgB,EAC5B,CAEKD,EAKHb,GAAU,KAJVA,GAAU,IACVA,GAAU;AAAA,EAKd,CAEA,OAAOA,CACT,CAEQ,mBAAmBU,EAA4B,CACrD,IAAMC,EAASD,EAAK,UAAU,EAG9B,GAAIC,EAAO,SAAW,GAAKA,EAAO,SAAW,EAAG,CAE9C,GAAIA,EAAO,SAAW,EAAG,CACvB,IAAMC,EAAQD,EAAO,CAAC,EAMtB,OAJIC,aAAiBP,GAIjBO,aAAiBN,GAAiB,KAAK,iBAAiBM,CAAK,EACxD,IAGOA,EAAM,UAAY,KAAK,YAAYA,EAAO,CAAC,GAC5C,QAAU,EAC3B,CACA,MAAO,EACT,CAGA,GAAID,EAAO,SAAW,KAAK,QAAQ,iBAAmB,GAAI,CACxD,IAAIM,EAAc,EAClB,QAAWL,KAASD,EAAQ,CAC1B,GAAIC,aAAiBP,GAAgBO,aAAiBN,GAAiB,KAAK,iBAAiBM,CAAK,EAChG,MAAO,GAET,IAAMM,EAAUN,EAAM,UAAY,KAAK,YAAYA,EAAO,CAAC,EAE3D,GADAK,GAAeC,EAAQ,OACnBD,GAAe,KAAK,QAAQ,iBAAmB,IACjD,MAAO,EAEX,CACA,OAAOA,IAAgB,KAAK,QAAQ,iBAAmB,GACzD,CAEA,MAAO,EACT,CAEQ,oBAAoBE,EAAwBlB,EAAuB,CACzE,IAAMiB,EAAU,KAAK,YAAYC,EAASlB,CAAK,EAG/C,MAAI,CAACiB,EAAQ,SAAS;AAAA,CAAI,GAAKA,EAAQ,OAAS,IAAM,CAAC,KAAK,iBAAiBC,CAAO,EAC3E,IAAMD,EAAU,IAIlB;AAAA,EAAQ,KAAK,OAAOjB,EAAQ,CAAC,EAAIiB,EAAU;AAAA,EAAO,KAAK,OAAOjB,CAAK,EAAI,GAChF,CAEQ,eAAemB,EAA8BC,EAAeC,EAAqC,CACvG,GAAI,CAAC,KAAK,QAAQ,mBAChB,OAAOF,EAAS,SAGlB,IAAMG,EAAKH,EAAS,SAChBpB,EAAS,GAGPwB,EAAcH,EAAQ,EAAIC,EAASD,EAAQ,CAAC,EAAI,KAChDI,EAAcJ,EAAQ,EAAIC,EAAS,OAASA,EAASD,EAAQ,CAAC,EAAI,KAElEK,EAAoB,KAAK,0BAA0BH,EAAIC,CAAW,EAClEG,EAAmB,KAAK,yBAAyBJ,CAAE,EAEzD,OAAIG,IACF1B,GAAU,KAGZA,GAAUuB,EAENI,IACF3B,GAAU,KAIRyB,aAAuBpB,GAAe,CAAC,KAAK,mBAAmBoB,CAAW,IAC5EzB,GAAU;AAAA,GAGLA,CACT,CAEQ,0BAA0BoB,EAAkBI,EAA8C,CAEhG,GAAIJ,IAAa,IAAK,CACpB,GAAI,CAACI,EAAa,MAAO,GACzB,GAAIA,aAAuBjB,EAAoB,CAC7C,IAAMqB,EAASJ,EAAY,SAE3B,GAAI,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,GAAG,EAAE,SAASI,CAAM,EAC7F,MAAO,EAEX,CACF,CAGA,OAAIR,IAAa,GAKnB,CAEQ,yBAAyBA,EAA2B,CAE1D,OAAIA,IAAa,GAKnB,CAEQ,oBAAoBS,EAA0C,CAEpE,OAAOA,EAAQ,iBAAiB,CAClC,CAEQ,gBAAgBC,EAAwC,CAE9D,OAAOA,EAAU,iBAAiB,CACpC,CAEQ,iBAAiBC,EAAgC,CACvD,OAAIA,aAAgB1B,EACX,GAEF0B,EAAK,UAAU,EAAE,KAAM3B,GAAU,KAAK,iBAAiBA,CAAK,CAAC,CACtE,CAEQ,aAAa4B,EAA0BC,EAAgC,CAK7E,OAJID,aAAmB3B,GAAe4B,aAAgB5B,GAIlD2B,aAAmBzB,GAAsB0B,aAAgB1B,EACpD,EAIX,CAEQ,OAAON,EAAuB,CAEpC,MADmB,IAAI,OAAO,KAAK,QAAQ,YAAc,CAAC,EACxC,OAAOA,CAAK,CAChC,CAEQ,oBAAoBA,EAAeY,EAAkB,GAAe,CAC1E,GAAIZ,IAAU,EAAG,MAAO,GAGxB,IAAMiC,EAAS,KAAK,OAAO,KAAK,IAAI,EAAGjC,EAAQ,CAAC,CAAC,EAEjD,OAAIA,IAAU,EACLY,EAAS,gBAAQ,gBAEjBqB,GAAUrB,EAAS,gBAAQ,gBAEtC,CACF,EC9RO,IAAMsB,EAAN,KAA6B,CAClC,OAAO,QAAQC,EAAiBC,EAA8C,CAE5E,IAAMC,EAAYF,EAAQ,KAAK,EAAE,WAAW,GAAG,EACzCG,EAAmBC,EAAmB,MAAMJ,CAAO,EAIzD,OADkB,IAAIK,EAAsBJ,CAAO,EAClC,OAAOE,EAAkBD,CAAS,CACrD,CACF,ECRO,IAAMI,EAAqD,CAChE,IAAK,CACH,KAAM,MACN,SAAU,QACV,YAAa,uBACb,OAAQ,+BACR,QAAS,cACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,QACV,YAAa,mCACb,OAAQ,mCACR,QAAS,kBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,QACV,YAAa,0CACb,OAAQ,+BACR,QAAS,iBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,QACV,YAAa,yBACb,OAAQ,gCACR,QAAS,kBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,QACV,YAAa,4BACb,OAAQ,+BACR,QAAS,cACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,QACV,YAAa,4BACb,OAAQ,+BACR,QAAS,cACX,EACA,GAAI,CACF,KAAM,KACN,SAAU,cACV,YAAa,6DACb,OAAQ,sDACR,QAAS,4BACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,cACV,YAAa,6DACb,OAAQ,iCACR,QAAS,wBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,cACV,YAAa,iEACb,OAAQ,qDACR,QAAS,8CACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,SACV,YAAa,0FACb,OAAQ,oEACR,QAAS,oCACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,SACV,YAAa,uDACb,OAAQ,sCACR,QAAS,sBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,SACV,YAAa,6CACb,OAAQ,kDACR,QAAS,6BACX,EACA,YAAa,CACX,KAAM,cACN,SAAU,OACV,YAAa,uCACb,OAAQ,mCACR,QAAS,qCACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,6BACb,OAAQ,cACR,QAAS,iBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,6BACb,OAAQ,cACR,QAAS,iBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,sCACb,OAAQ,aACR,QAAS,kBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,OACV,YAAa,sCACb,OAAQ,YACR,QAAS,eACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,kDACb,OAAQ,4BACR,QAAS,oBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,OACV,YAAa,yCACb,OAAQ,cACR,QAAS,WACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,sCACb,OAAQ,eACR,QAAS,WACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,2BACb,OAAQ,UACR,QAAS,UACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,OACV,YAAa,oCACb,OAAQ,QACR,QAAS,QACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,2CACb,OAAQ,yBACR,QAAS,qBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,UACV,YAAa,0CACb,OAAQ,iCACR,QAAS,oBACX,EACA,GAAI,CACF,KAAM,KACN,SAAU,UACV,YAAa,wCACb,OAAQ,gCACR,QAAS,kBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,UACV,YAAa,4CACb,OAAQ,eACR,QAAS,eACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,cACV,YAAa,2FACb,OAAQ,2BACR,QAAS,yCACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,UACV,YAAa,iDACb,OAAQ,iBACR,QAAS,iBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,UACV,YAAa,0CACb,OAAQ,cACR,QAAS,4BACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,UACV,YAAa,oCACb,OAAQ,iBACR,QAAS,cACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,UACV,YAAa,wCACb,OAAQ,kBACR,QAAS,eACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,UACV,YAAa,oCACb,OAAQ,gBACR,QAAS,aACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,2CACb,OAAQ,sCACR,QAAS,gCACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,OACV,YAAa,0CACb,OAAQ,qDACR,QAAS,iDACX,EACA,WAAY,CACV,KAAM,aACN,SAAU,OACV,YAAa,2DACb,OAAQ,oCACR,QAAS,2BACX,EACA,UAAW,CACT,KAAM,YACN,SAAU,OACV,YAAa,gEACb,OAAQ,8CACR,QAAS,mCACX,EACA,WAAY,CACV,KAAM,aACN,SAAU,OACV,YAAa,+DACb,OAAQ,6DACR,QAAS,qDACX,EACA,WAAY,CACV,KAAM,aACN,SAAU,OACV,YAAa,gCACb,OAAQ,oBACR,QAAS,sBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,4CACb,OAAQ,2BACR,QAAS,2BACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,OACV,YAAa,2CACb,OAAQ,4CACR,QAAS,2CACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,8DACb,OAAQ,8BACR,QAAS,eACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,8DACb,OAAQ,8BACR,QAAS,eACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,OACV,YAAa,wDACb,OAAQ,kCACR,QAAS,iBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,2DACb,OAAQ,gCACR,QAAS,eACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,gDACb,OAAQ,iCACR,QAAS,gBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,OACV,YAAa,sCACb,OAAQ,+BACR,QAAS,cACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,qDACb,OAAQ,8BACR,QAAS,mBACX,EACA,UAAW,CACT,KAAM,YACN,SAAU,OACV,YAAa,uDACb,OAAQ,gCACR,QAAS,qBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,6DACb,OAAQ,gCACR,QAAS,kBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,+DACb,OAAQ,8BACR,QAAS,gBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,4DACb,OAAQ,8BACR,QAAS,oBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,OACV,YAAa,8CACb,OAAQ,cACR,QAAS,WACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,uCACb,OAAQ,uBACR,QAAS,cACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,OACV,YAAa,4CACb,OAAQ,cACR,QAAS,SACX,EACA,GAAI,CACF,KAAM,KACN,SAAU,OACV,YAAa,4CACb,OAAQ,aACR,QAAS,SACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,OACV,YAAa,wDACb,OAAQ,sBACR,QAAS,eACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,4CACb,OAAQ,gBACR,QAAS,aACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,OACV,YAAa,sCACb,OAAQ,uBACR,QAAS,aACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,0CACb,OAAQ,SACR,QAAS,SACX,EACA,YAAa,CACX,KAAM,cACN,SAAU,OACV,YAAa,yDACb,OAAQ,2BACR,QAAS,sBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,SACV,YAAa,0FACb,OAAQ,oEACR,QAAS,uCACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,SACV,YAAa,wFACb,OAAQ,iGACR,QAAS,wBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,SACV,YAAa,oEACb,OAAQ,qDACR,QAAS,6BACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,SACV,YAAa,yDACb,OAAQ,2CACR,QAAS,oCACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,SACV,YAAa,2DACb,OAAQ,2BACR,QAAS,wBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,SACV,YAAa,4FACb,OAAQ,mDACR,QAAS,yBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,SACV,YAAa,wCACb,OAAQ,mBACR,QAAS,UACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,SACV,YAAa,2CACb,OAAQ,sBACR,QAAS,aACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,SACV,YAAa,wCACb,OAAQ,cACR,QAAS,gBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,SACV,YAAa,2CACb,OAAQ,iBACR,QAAS,kBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,OACV,YAAa,6CACb,OAAQ,8BACR,QAAS,gCACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,OACV,YAAa,sDACb,OAAQ,yDACR,QAAS,+BACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,qDACb,OAAQ,0BACR,QAAS,mBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,sDACb,OAAQ,2BACR,QAAS,oBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,OACV,YAAa,+FACb,OAAQ,kCACR,QAAS,qBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,wDACb,OAAQ,4CACR,QAAS,qBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,OACV,YAAa,iEACb,OAAQ,8CACR,QAAS,yBACX,EACA,WAAY,CACV,KAAM,aACN,SAAU,OACV,YAAa,mDACb,OAAQ,uDACR,QAAS,8CACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,8DACb,OAAQ,oDACR,QAAS,8BACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,OACV,YAAa,6DACb,OAAQ,eACR,QAAS,wBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,6CACb,OAAQ,cACR,QAAS,YACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,8DACb,OAAQ,cACR,QAAS,gBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,0DACb,OAAQ,2BACR,QAAS,4BACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,mDACb,OAAQ,eACR,QAAS,WACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,kEACb,OAAQ,aACR,QAAS,YACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,0EACb,OAAQ,sBACR,QAAS,0BACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,+CACb,OAAQ,6BACR,QAAS,kBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,6BACb,OAAQ,sBACR,QAAS,gBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,8BACb,OAAQ,uBACR,QAAS,iBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,OACV,YAAa,4BACb,OAAQ,qBACR,QAAS,eACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,OACV,YAAa,6BACb,OAAQ,sBACR,QAAS,cACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,OACV,YAAa,+BACb,OAAQ,wBACR,QAAS,gBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,OACV,YAAa,+BACb,OAAQ,wBACR,QAAS,gBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,0CACb,OAAQ,wCACR,QAAS,mBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,sCACb,OAAQ,wCACR,QAAS,mBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,yFACb,OAAQ,wCACR,QAAS,sBACX,EACA,YAAa,CACX,KAAM,cACN,SAAU,OACV,YAAa,uDACb,OAAQ,gDACR,QAAS,sBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,qFACb,OAAQ,4BACR,QAAS,oBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,8CACb,OAAQ,8BACR,QAAS,sBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,8CACb,OAAQ,sCACR,QAAS,uBACX,EACA,UAAW,CACT,KAAM,YACN,SAAU,OACV,YAAa,iDACb,OAAQ,uBACR,QAAS,0BACX,EACA,UAAW,CACT,KAAM,YACN,SAAU,OACV,YAAa,iDACb,OAAQ,uBACR,QAAS,wBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,YACV,YAAa,+DACb,OAAQ,oCACR,QAAS,4BACX,EACA,GAAI,CACF,KAAM,KACN,SAAU,YACV,YAAa,6CACb,OAAQ,oCACR,QAAS,qBACX,EACA,GAAI,CACF,KAAM,KACN,SAAU,YACV,YAAa,4CACb,OAAQ,oCACR,QAAS,qBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,YACV,YAAa,uCACb,OAAQ,6CACR,QAAS,6BACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,YACV,YAAa,kDACb,OAAQ,oCACR,QAAS,4BACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,YACV,YAAa,iDACb,OAAQ,mCACR,QAAS,iCACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,YACV,YAAa,iEACb,OAAQ,uBACR,QAAS,cACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,YACV,YAAa,uFACb,OAAQ,+BACR,QAAS,uBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,YACV,YAAa,gFACb,OAAQ,4BACR,QAAS,4BACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,WACV,YAAa,wDACb,OAAQ,kCACR,QAAS,gCACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,WACV,YAAa,6EACb,OAAQ,sCACR,QAAS,oCACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,WACV,YAAa,4EACb,OAAQ,oCACR,QAAS,kCACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,WACV,YAAa,mEACb,OAAQ,qCACR,QAAS,iCACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,WACV,YAAa,sEACb,OAAQ,kCACR,QAAS,gCACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,WACV,YAAa,sEACb,OAAQ,kCACR,QAAS,gCACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,cACV,YAAa,2DACb,OAAQ,sCACR,QAAS,2BACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,QACV,YAAa,+CACb,OAAQ,qCACR,QAAS,4BACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,QACV,YAAa,yCACb,OAAQ,oDACR,QAAS,eACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,QACV,YAAa,gEACb,OAAQ,0CACR,QAAS,6BACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,QACV,YAAa,oCACb,OAAQ,yCACR,QAAS,iBACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,QACV,YAAa,qDACb,OAAQ,6CACR,QAAS,uBACX,EACA,UAAW,CACT,KAAM,YACN,SAAU,QACV,YAAa,2DACb,OAAQ,mBACR,QAAS,oBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,WACV,YAAa,+CACb,OAAQ,gDACR,QAAS,iBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,WACV,YAAa,4DACb,OAAQ,mDACR,QAAS,yBACX,EACA,UAAW,CACT,KAAM,YACN,SAAU,QACV,YAAa,6DACb,OAAQ,kCACR,QAAS,oCACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,QACV,YAAa,uEACb,OAAQ,uBACR,QAAS,8BACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,QACV,YAAa,+DACb,OAAQ,yCACR,QAAS,sCACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,QACV,YAAa,kDACb,OAAQ,uCACR,QAAS,oCACX,EACA,UAAW,CACT,KAAM,YACN,SAAU,QACV,YAAa,qCACb,OAAQ,4DACR,QAAS,0BACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,UACV,YAAa,sFACb,OAAQ,oEACR,QAAS,0CACX,EACA,UAAW,CACT,KAAM,YACN,SAAU,OACV,YAAa,iEACb,OAAQ,4CACR,QAAS,0BACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,OACV,YAAa,0DACb,OAAQ,4CACR,QAAS,sBACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,cACV,YAAa,2CACb,OAAQ,oCACR,QAAS,+BACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,sDACb,OAAQ,oDACR,QAAS,wBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,cACV,YAAa,6CACb,OAAQ,mDACR,QAAS,yBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,cACV,YAAa,mDACb,OAAQ,mDACR,QAAS,yBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,cACV,YAAa,2DACb,OAAQ,qDACR,QAAS,yBACX,EACA,WAAY,CACV,KAAM,aACN,SAAU,cACV,YAAa,wCACb,OAAQ,uBACR,QAAS,0BACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,cACV,YAAa,oCACb,OAAQ,yBACR,QAAS,sBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,cACV,YAAa,2CACb,OAAQ,6BACR,QAAS,mBACX,EACA,YAAa,CACX,KAAM,cACN,SAAU,cACV,YAAa,sDACb,OAAQ,4BACR,QAAS,0BACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,cACV,YAAa,yCACb,OAAQ,gCACR,QAAS,eACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,cACV,YAAa,yCACb,OAAQ,gCACR,QAAS,eACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,0CACb,OAAQ,wBACR,QAAS,wBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,cACV,YAAa,gDACb,OAAQ,yBACR,QAAS,yBACX,EACA,IAAK,CACH,KAAM,MACN,SAAU,cACV,YAAa,qDACb,OAAQ,4BACR,QAAS,sBACX,EACA,UAAW,CACT,KAAM,YACN,SAAU,cACV,YAAa,sDACb,OAAQ,kCACR,QAAS,4BACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,gDACb,OAAQ,8BACR,QAAS,wBACX,EACA,YAAa,CACX,KAAM,cACN,SAAU,cACV,YAAa,iDACb,OAAQ,qCACR,QAAS,2BACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,cACV,YAAa,+CACb,OAAQ,0DACR,QAAS,6BACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,cACV,YAAa,mCACb,OAAQ,+BACR,QAAS,yBACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,cACV,YAAa,gDACb,OAAQ,0DACR,QAAS,8BACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,OACV,YAAa,iEACb,OAAQ,gCACR,QAAS,gBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,OACV,YAAa,gDACb,OAAQ,gCACR,QAAS,gBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,cACV,YAAa,0CACb,OAAQ,mCACR,QAAS,kBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,cACV,YAAa,yCACb,OAAQ,mCACR,QAAS,kBACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,cACV,YAAa,gEACb,OAAQ,2BACR,QAAS,wBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,+CACb,OAAQ,kBACR,QAAS,mBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,8CACb,OAAQ,kBACR,QAAS,mBACX,EACA,YAAa,CACX,KAAM,cACN,SAAU,OACV,YAAa,kCACb,OAAQ,qCACR,QAAS,sBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,QACV,YAAa,gDACb,OAAQ,yBACR,QAAS,mCACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,QACV,YAAa,mDACb,OAAQ,yBACR,QAAS,mCACX,EACA,WAAY,CACV,KAAM,aACN,SAAU,cACV,YAAa,wDACb,OAAQ,wCACR,QAAS,4BACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,sDACb,OAAQ,iCACR,QAAS,gBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,cACV,YAAa,8CACb,OAAQ,kCACR,QAAS,iBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,cACV,YAAa,4DACb,OAAQ,kCACR,QAAS,iBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,cACV,YAAa,gDACb,OAAQ,kCACR,QAAS,iBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,cACV,YAAa,kDACb,OAAQ,gCACR,QAAS,eACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,cACV,YAAa,sCACb,OAAQ,gCACR,QAAS,eACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,OACV,YAAa,2DACb,OAAQ,kCACR,QAAS,mBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,6BACb,OAAQ,mCACR,QAAS,kBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,8CACb,OAAQ,iCACR,QAAS,gBACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,OACV,YAAa,uEACb,OAAQ,6BACR,QAAS,2BACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,OACV,YAAa,gEACb,OAAQ,6BACR,QAAS,2BACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,oEACb,OAAQ,4BACR,QAAS,0BACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,OACV,YAAa,kCACb,OAAQ,kBACR,QAAS,kBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,OACV,YAAa,2CACb,OAAQ,wBACR,QAAS,sBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,OACV,YAAa,sCACb,OAAQ,iBACR,QAAS,iBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,mDACb,OAAQ,qCACR,QAAS,8BACX,EACA,SAAU,CACR,KAAM,SACN,SAAU,cACV,YAAa,mEACb,OAAQ,sCACR,QAAS,+BACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,kCACb,OAAQ,wBACR,QAAS,wBACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,cACV,YAAa,kDACb,OAAQ,yBACR,QAAS,yBACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,cACV,YAAa,0CACb,OAAQ,yCACR,QAAS,2BACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,uDACb,OAAQ,2BACR,QAAS,oBACX,EACA,UAAW,CACT,KAAM,SACN,SAAU,cACV,YAAa,uEACb,OAAQ,4BACR,QAAS,qBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,cACV,YAAa,oCACb,OAAQ,wCACR,QAAS,0BACX,EACA,OAAQ,CACN,KAAM,SACN,SAAU,cACV,YAAa,qDACb,OAAQ,mCACR,QAAS,kBACX,EACA,oBAAqB,CACnB,KAAM,sBACN,SAAU,cACV,YAAa,8DACb,OAAQ,gDACR,QAAS,+BACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,cACV,YAAa,4CACb,OAAQ,iCACR,QAAS,iBACX,EACA,cAAe,CACb,KAAM,gBACN,SAAU,cACV,YAAa,qDACb,OAAQ,0CACR,QAAS,0BACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,cACV,YAAa,4CACb,OAAQ,gDACR,QAAS,oBACX,EACA,cAAe,CACb,KAAM,gBACN,SAAU,cACV,YAAa,qDACb,OAAQ,yDACR,QAAS,6BACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,6BACb,OAAQ,+BACR,QAAS,oBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,sCACb,OAAQ,+BACR,QAAS,oBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,6BACb,OAAQ,uCACR,QAAS,oBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,sCACb,OAAQ,uCACR,QAAS,oBACX,EACA,SAAU,CACR,KAAM,WACN,SAAU,cACV,YAAa,0DACb,OAAQ,wBACR,QAAS,kBACX,EACA,6BAA8B,CAC5B,KAAM,+BACN,SAAU,cACV,YAAa,mEACb,OAAQ,4CACR,QAAS,sCACX,EACA,UAAW,CACT,KAAM,YACN,SAAU,cACV,YAAa,sDACb,OAAQ,eACR,QAAS,iBACX,EACA,qBAAsB,CACpB,KAAM,uBACN,SAAU,cACV,YAAa,+DACb,OAAQ,0BACR,QAAS,4BACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,cACV,YAAa,iDACb,OAAQ,2CACR,QAAS,yBACX,EACA,oBAAqB,CACnB,KAAM,sBACN,SAAU,cACV,YAAa,0DACb,OAAQ,uDACR,QAAS,qCACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,cACV,YAAa,0CACb,OAAQ,6DACR,QAAS,yBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,cACV,YAAa,qCACb,OAAQ,+CACR,QAAS,qBACX,EACA,QAAS,CACP,KAAM,UACN,SAAU,cACV,YAAa,mCACb,OAAQ,wCACR,QAAS,mBACX,EACA,MAAO,CACL,KAAM,QACN,SAAU,cACV,YAAa,iCACb,OAAQ,sCACR,QAAS,iBACX,EACA,KAAM,CACJ,KAAM,OACN,SAAU,cACV,YAAa,gCACb,OAAQ,iCACR,QAAS,kBACX,CACF,EAEO,SAASC,EAAcC,EAA6C,CACzE,OAAOF,EAAuBE,EAAY,YAAY,CAAC,CACzD,CC37CO,SAASC,EAA8BC,EAAiD,CAC7F,IAAMC,EAAc,IAAI,IAExB,SAASC,EAASC,EAAuB,CACvC,GAAIA,aAAgBC,EAAa,CAC/B,IAAMC,EAAcF,EAAK,QACnBG,EAAMC,EAAcF,CAAW,EAErC,GAAIJ,EAAY,IAAII,CAAW,EAAG,CAChC,IAAMG,EAAWP,EAAY,IAAII,CAAW,EAC5CG,EAAS,OACX,MACEP,EAAY,IAAII,EAAa,CAC3B,KAAMA,EACN,IAAAC,EACA,MAAO,CACT,CAAC,CAEL,CAGA,QAAWG,KAASN,EAAK,UAAU,EACjCD,EAASO,CAAK,CAElB,CAEA,OAAAP,EAASF,CAAU,EAGZ,MAAM,KAAKC,EAAY,OAAO,CAAC,EAAE,KAAK,CAACS,EAAGC,IAC3CA,EAAE,QAAUD,EAAE,MACTC,EAAE,MAAQD,EAAE,MAEdA,EAAE,KAAK,cAAcC,EAAE,IAAI,CACnC,CACH,CP4BW,IAAAC,EAAA,6BAlEI,SAARC,GAA2B,CAChC,GAAM,CAACC,EAAYC,CAAa,KAAI,YAAwB,IAAI,EAC1D,CAACC,EAAUC,CAAW,KAAI,YAA2D,CAAC,CAAC,EACvF,CAACC,EAAWC,CAAY,KAAI,YAAS,EAAI,EA8D/C,MA5DA,aAAU,IAAM,CACd,eAAeC,GAAsB,CACnC,GAAI,CACF,IAAMC,EAAmB,MAAM,YAAU,SAAS,EAClD,GAAI,CAACA,EAAkB,IACrB,aAAU,CACR,MAAO,QAAM,MAAM,QACnB,MAAO,QACP,QAAS,4BACX,CAAC,EACDF,EAAa,EAAK,EAClB,MACF,CAGA,IAAMG,EAAUD,EAAiB,KAAK,EACjCC,EAAQ,WAAW,GAAG,MACzB,aAAU,CACR,MAAO,QAAM,MAAM,SACnB,MAAO,UACP,QAAS,6DACX,CAAC,EAGH,GAAI,CAEF,IAAMC,EAASC,EAAuB,QAAQF,CAAO,EACrDP,EAAcQ,CAAM,EAGpB,IAAME,EAASC,EAAmB,MAAMJ,CAAO,EACzCK,EAAeC,EAA8BH,CAAM,EACzDR,EAAYU,CAAY,KAExB,aAAU,CACR,MAAO,QAAM,MAAM,QACnB,MAAO,UACP,QAAS,oBACX,CAAC,CACH,OAASE,EAAc,IACrB,aAAU,CACR,MAAO,QAAM,MAAM,QACnB,MAAO,wBACP,QAASA,aAAwB,MAAQA,EAAa,QAAU,OAAOA,CAAY,CACrF,CAAC,CACH,CACAV,EAAa,EAAK,CACpB,OAASW,EAAK,IACZ,aAAU,CACR,MAAO,QAAM,MAAM,QACnB,MAAO,QACP,QAAS,6BAA6BA,CAAG,EAC3C,CAAC,EACDX,EAAa,EAAK,CACpB,CACF,CAEAC,EAAoB,CACtB,EAAG,CAAC,CAAC,EAEDF,EACF,SAAO,OAAC,UAAO,UAAW,GAAM,SAAS,4BAA4B,EAGvE,GAAI,CAACJ,EACH,SAAO,OAAC,UAAO,SAAS,8BAA8B,EAGxD,IAAMiB,EAAW;AAAA;AAAA;AAAA,EAGjBjB,CAAU;AAAA;AAAA,EAIJkB,EAAoBC,IACiB,CACvC,MAAO,UACP,YAAa,UACb,OAAQ,UACR,KAAM,UACN,KAAM,UACN,KAAM,SACR,GACgBA,GAAY,EAAE,GAAK,UAG/BC,EAAsB,IAAM,CAChC,IAAMC,EAA8B,CAAC,EACrC,OAAAnB,EAAS,QAASoB,GAAY,CAC5BD,EAAS,QACP,OAAC,SAAO,SAAS,MAAhB,CAEC,MAAOC,EAAQ,KACf,KAAMA,EAAQ,KAAK,aAAe,8BAF7B,GAAGA,EAAQ,IAAI,OAGtB,CACF,EACIA,EAAQ,MACVD,EAAS,QACP,OAAC,SAAO,SAAS,QAAhB,CAAoD,MAAM,WACzD,mBAAC,SAAO,SAAS,QAAQ,KAAxB,CAA6B,KAAMC,EAAQ,IAAI,SAAU,MAAOJ,EAAiBI,EAAQ,IAAI,QAAQ,EAAG,GAD7E,GAAGA,EAAQ,IAAI,MAE7C,CACF,EACAD,EAAS,QAAK,OAAC,SAAO,SAAS,MAAhB,CAAkD,MAAM,SAAS,KAAMC,EAAQ,IAAI,QAAxD,GAAGA,EAAQ,IAAI,MAAiD,CAAE,EAC5GD,EAAS,QAAK,OAAC,SAAO,SAAS,MAAhB,CAAiD,MAAM,UAAU,KAAMC,EAAQ,IAAI,SAAxD,GAAGA,EAAQ,IAAI,KAAkD,CAAE,EAC7GD,EAAS,QAAK,OAAC,SAAO,SAAS,UAAhB,GAA+B,GAAGC,EAAQ,IAAI,MAAQ,CAAE,EAE3E,CAAC,EAEMD,CACT,EAEA,SACE,OAAC,UACC,SAAUJ,EACV,YACE,OAAC,SAAO,SAAP,CACE,SAAAf,EAAS,OAAS,MACjB,oBACE,oBAAC,SAAO,SAAS,QAAhB,CAAwB,MAAM,gBAC5B,SAAAA,EAAS,IAAKoB,MACb,OAAC,SAAO,SAAS,QAAQ,KAAxB,CAEC,KAAM,GAAGA,EAAQ,IAAI,GAAGA,EAAQ,MAAQ,EAAI,QAAKA,EAAQ,KAAK,GAAK,EAAE,GACrE,MAAOJ,EAAiBI,EAAQ,KAAK,QAAQ,GAFxCA,EAAQ,IAGf,CACD,EACH,KAEA,OAAC,SAAO,SAAS,UAAhB,EAA0B,EAE1BF,EAAoB,GACvB,EAEJ,EAEF,WACE,OAAC,eACC,mBAAC,SAAO,gBAAP,CACC,MAAM,0BACN,QAASpB,EACT,SAAU,CAAE,UAAW,CAAC,KAAK,EAAG,IAAK,GAAI,EAC3C,EACF,EAEJ,CAEJ",
  "names": ["excel_beautifier_clipboard_exports", "__export", "Command", "__toCommonJS", "import_api", "import_react", "FormulaTypes", "ExcelExpression", "original", "child", "SubExpression", "FormulaExpr", "formula", "OperatorExpression", "ExcelExpression", "operator", "CellReferenceExpression", "original", "sheet", "column", "row", "isColumnAbsolute", "isRowAbsolute", "sheetPrefix", "colPrefix", "rowPrefix", "CellRangeExpression", "startCell", "endCell", "DEFAULT_FORMATTING_OPTIONS", "ExcelFormulaParser", "FormulaTypes", "acc", "value", "input", "position", "twoChar", "oneChar", "text", "parts", "startPart", "endPart", "sheet", "start", "end", "sheetSplit", "startCell", "endCell", "CellRangeExpression", "cellPattern", "match", "colAbsolute", "column", "rowAbsolute", "row", "cleanSheet", "CellReferenceExpression", "parent", "startIndex", "separator", "token", "inDoubleQuote", "char", "prevChar", "operator", "upperToken", "formulaType", "cellRef", "ExcelExpression", "expression", "SubExpression", "OperatorExpression", "formula", "formulaExpr", "FormulaExpr", "i", "braceCount", "paramExpression", "parenCount", "inSingleQuote", "trimmed", "lastChar", "cleanFormula", "baseExpression", "error", "ExcelRawTextFormatter", "options", "DEFAULT_FORMATTING_OPTIONS", "expression", "hasEqualsSign", "result", "depth", "children", "i", "child", "FormulaExpr", "SubExpression", "OperatorExpression", "CellReferenceExpression", "CellRangeExpression", "func", "params", "param", "isLast", "paramContent", "functionResult", "subResult", "totalLength", "content", "subExpr", "operator", "index", "siblings", "op", "prevSibling", "nextSibling", "shouldSpaceBefore", "shouldSpaceAfter", "prevOp", "cellRef", "cellRange", "expr", "current", "next", "prefix", "ExcelFormulaBeautifier", "formula", "options", "hasEquals", "parsedExpression", "ExcelFormulaParser", "ExcelRawTextFormatter", "FORMULAS_DOCUMENTATION", "getFormulaDoc", "formulaName", "extractFormulasFromExpression", "expression", "formulasMap", "traverse", "expr", "FormulaExpr", "formulaName", "doc", "getFormulaDoc", "existing", "child", "a", "b", "import_jsx_runtime", "Command", "beautified", "setBeautified", "formulas", "setFormulas", "isLoading", "setIsLoading", "getClipboardContent", "clipboardContent", "trimmed", "result", "ExcelFormulaBeautifier", "parsed", "ExcelFormulaParser", "usedFormulas", "extractFormulasFromExpression", "formulaError", "err", "markdown", "getCategoryColor", "category", "renderDocumentation", "elements", "formula"]
}
