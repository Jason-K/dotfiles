"use strict";var x=Object.defineProperty;var a=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var b=Object.prototype.hasOwnProperty;var Y=(r,E)=>{for(var n in E)x(r,n,{get:E[n],enumerable:!0})},w=(r,E,n,i)=>{if(E&&typeof E=="object"||typeof E=="function")for(let e of G(E))!b.call(r,e)&&e!==n&&x(r,e,{get:()=>E[e],enumerable:!(i=a(E,e))||i.enumerable});return r};var X=r=>w(x({},"__esModule",{value:!0}),r);var v={};Y(v,{default:()=>H});module.exports=X(v);var c=require("@raycast/api"),D=require("react");var P=(t=>(t.IF="IF",t.IFS="IFS",t.AND="AND",t.OR="OR",t.NOT="NOT",t.IFERROR="IFERROR",t.IFNA="IFNA",t.ISERROR="ISERROR",t.ISNA="ISNA",t.ISBLANK="ISBLANK",t.ISNUMBER="ISNUMBER",t.ISTEXT="ISTEXT",t.SI="SI",t.SIS="SIS",t.ET="ET",t.OU="OU",t.NON="NON",t.SIERREUR="SIERREUR",t.SINA="SINA",t.ESTERREUR="ESTERREUR",t.ESTNA="ESTNA",t.ESTVIDE="ESTVIDE",t.ESTNUM="ESTNUM",t.ESTTEXTE="ESTTEXTE",t.SUM="SUM",t.SUMIF="SUMIF",t.SUMIFS="SUMIFS",t.SUMPRODUCT="SUMPRODUCT",t.AVERAGE="AVERAGE",t.AVERAGEIF="AVERAGEIF",t.AVERAGEIFS="AVERAGEIFS",t.COUNT="COUNT",t.COUNTA="COUNTA",t.COUNTBLANK="COUNTBLANK",t.COUNTIF="COUNTIF",t.COUNTIFS="COUNTIFS",t.MAX="MAX",t.MAXA="MAXA",t.MIN="MIN",t.MINA="MINA",t.MEDIAN="MEDIAN",t.MODE="MODE",t.STDEV="STDEV",t.VAR="VAR",t.SOMME="SOMME",t.SOMME_SI="SOMME.SI",t.SOMME_SI_ENS="SOMME.SI.ENS",t.SOMMEPROD="SOMMEPROD",t.MOYENNE="MOYENNE",t.MOYENNE_SI="MOYENNE.SI",t.MOYENNE_SI_ENS="MOYENNE.SI.ENS",t.NB="NB",t.NBVAL="NBVAL",t.NB_VIDE="NB.VIDE",t.NB_SI="NB.SI",t.NB_SI_ENS="NB.SI.ENS",t.MEDIANE="MEDIANE",t.ECARTYPE="ECARTYPE",t.ROUND="ROUND",t.ROUNDUP="ROUNDUP",t.ROUNDDOWN="ROUNDDOWN",t.CEILING="CEILING",t.FLOOR="FLOOR",t.TRUNC="TRUNC",t.INT="INT",t.ABS="ABS",t.SQRT="SQRT",t.POWER="POWER",t.EXP="EXP",t.LN="LN",t.LOG="LOG",t.LOG10="LOG10",t.MOD="MOD",t.RAND="RAND",t.RANDBETWEEN="RANDBETWEEN",t.ARRONDI="ARRONDI",t.ARRONDI_SUP="ARRONDI.SUP",t.ARRONDI_INF="ARRONDI.INF",t.PLAFOND="PLAFOND",t.PLANCHER="PLANCHER",t.TRONQUE="TRONQUE",t.ENT="ENT",t.RACINE="RACINE",t.PUISSANCE="PUISSANCE",t.ALEA="ALEA",t.ALEA_ENTRE_BORNES="ALEA.ENTRE.BORNES",t.VLOOKUP="VLOOKUP",t.HLOOKUP="HLOOKUP",t.XLOOKUP="XLOOKUP",t.LOOKUP="LOOKUP",t.INDEX="INDEX",t.MATCH="MATCH",t.CHOOSE="CHOOSE",t.INDIRECT="INDIRECT",t.OFFSET="OFFSET",t.ROW="ROW",t.COLUMN="COLUMN",t.ROWS="ROWS",t.COLUMNS="COLUMNS",t.RECHERCHEV="RECHERCHEV",t.RECHERCHEH="RECHERCHEH",t.RECHERCHEX="RECHERCHEX",t.RECHERCHE="RECHERCHE",t.EQUIV="EQUIV",t.CHOISIR="CHOISIR",t.DECALER="DECALER",t.LIGNE="LIGNE",t.COLONNE="COLONNE",t.LIGNES="LIGNES",t.COLONNES="COLONNES",t.CONCATENATE="CONCATENATE",t.CONCAT="CONCAT",t.TEXTJOIN="TEXTJOIN",t.LEFT="LEFT",t.RIGHT="RIGHT",t.MID="MID",t.LEN="LEN",t.FIND="FIND",t.SEARCH="SEARCH",t.SUBSTITUTE="SUBSTITUTE",t.REPLACE="REPLACE",t.UPPER="UPPER",t.LOWER="LOWER",t.PROPER="PROPER",t.TRIM="TRIM",t.CLEAN="CLEAN",t.VALUE="VALUE",t.TEXT="TEXT",t.CHAR="CHAR",t.CODE="CODE",t.EXACT="EXACT",t.CONCATENER="CONCATENER",t.JOINDRE_TEXTE="JOINDRE.TEXTE",t.GAUCHE="GAUCHE",t.DROITE="DROITE",t.STXT="STXT",t.NBCAR="NBCAR",t.CHERCHE="CHERCHE",t.TROUVE="TROUVE",t.SUBSTITUE="SUBSTITUE",t.REMPLACER="REMPLACER",t.MAJUSCULE="MAJUSCULE",t.MINUSCULE="MINUSCULE",t.NOMPROPRE="NOMPROPRE",t.SUPPRESPACE="SUPPRESPACE",t.EPURAGE="EPURAGE",t.CNUM="CNUM",t.TEXTE="TEXTE",t.CAR="CAR",t.TODAY="TODAY",t.NOW="NOW",t.DATE="DATE",t.TIME="TIME",t.YEAR="YEAR",t.MONTH="MONTH",t.DAY="DAY",t.HOUR="HOUR",t.MINUTE="MINUTE",t.SECOND="SECOND",t.WEEKDAY="WEEKDAY",t.WEEKNUM="WEEKNUM",t.WORKDAY="WORKDAY",t.NETWORKDAYS="NETWORKDAYS",t.EDATE="EDATE",t.EOMONTH="EOMONTH",t.DATEDIF="DATEDIF",t.DATEVALUE="DATEVALUE",t.TIMEVALUE="TIMEVALUE",t.AUJOURDHUI="AUJOURDHUI",t.MAINTENANT="MAINTENANT",t.TEMPS="TEMPS",t.ANNEE="ANNEE",t.MOIS="MOIS",t.JOUR="JOUR",t.HEURE="HEURE",t.SECONDE="SECONDE",t.JOURSEM="JOURSEM",t.NO_SEMAINE="NO.SEMAINE",t.SERIE_JOUR_OUVRE="SERIE.JOUR.OUVRE",t.NB_JOURS_OUVRES="NB.JOURS.OUVRES",t.MOIS_DECALER="MOIS.DECALER",t.FIN_MOIS="FIN.MOIS",t.DATEVAL="DATEVAL",t.TEMPSVAL="TEMPSVAL",t.PMT="PMT",t.PV="PV",t.FV="FV",t.RATE="RATE",t.NPER="NPER",t.NPV="NPV",t.IRR="IRR",t.XIRR="XIRR",t.XNPV="XNPV",t.VPM="VPM",t.VA="VA",t.VC="VC",t.TAUX="TAUX",t.NPM="NPM",t.VAN="VAN",t.TRI="TRI",t.TRID="TRID",t.VAND="VAND",t.DSUM="DSUM",t.DAVERAGE="DAVERAGE",t.DCOUNT="DCOUNT",t.DCOUNTA="DCOUNTA",t.DMAX="DMAX",t.DMIN="DMIN",t.BDSOMME="BDSOMME",t.BDMOYENNE="BDMOYENNE",t.BDNB="BDNB",t.BDNBVAL="BDNBVAL",t.BDMAX="BDMAX",t.BDMIN="BDMIN",t.CONVERT="CONVERT",t.FILTER="FILTER",t.SORT="SORT",t.SORTBY="SORTBY",t.UNIQUE="UNIQUE",t.SEQUENCE="SEQUENCE",t.TRANSPOSE="TRANSPOSE",t.FILTRE="FILTRE",t.TRIER="TRIER",t.TRIER_PAR="TRIER.PAR",t.LAMBDA="LAMBDA",t.LET="LET",t.MAKEARRAY="MAKEARRAY",t.MAP="MAP",t.REDUCE="REDUCE",t.SCAN="SCAN",t.RANDARRAY="RANDARRAY",t.SWITCH="SWITCH",t.AGGREGATE="AGGREGATE",t.SUBTOTAL="SUBTOTAL",t.FORECAST="FORECAST",t.TREND="TREND",t.LINEST="LINEST",t.LOGEST="LOGEST",t.GROWTH="GROWTH",t.PERCENTILE="PERCENTILE",t.QUARTILE="QUARTILE",t.RANK="RANK",t.PERCENTRANK="PERCENTRANK",t.SKEW="SKEW",t.KURT="KURT",t.COVAR="COVAR",t.CORREL="CORREL",t.RSQ="RSQ",t.INTERCEPT="INTERCEPT",t.SLOPE="SLOPE",t.STANDARDIZE="STANDARDIZE",t.PROB="PROB",t.POISSON="POISSON",t.BINOMIAL="BINOMIAL",t.COMBIN="COMBIN",t.PERMUT="PERMUT",t.BETA="BETA",t.GAMMA="GAMMA",t.WEIBULL="WEIBULL",t.LOGNORM="LOGNORM",t.HYPGEOM="HYPGEOM",t.NORMINV="NORMINV",t.NORMSDIST="NORMSDIST",t.NORMSINV="NORMSINV",t.TDIST="TDIST",t.TINV="TINV",t.FDIST="FDIST",t.FINV="FINV",t.CHITEST="CHITEST",t.CHIINV="CHIINV",t.ZTEST="ZTEST",t.TTEST="TTEST",t.T_TEST="T.TEST",t.FTEST="FTEST",t.F_TEST="F.TEST",t.CHI_TEST="CHI.TEST",t.ZTEST_ALT="Z.TEST",t.GEOMEAN="GEOMEAN",t.HARMEAN="HARMEAN",t.TRIMMEAN="TRIMMEAN",t.SMALL="SMALL",t.LARGE="LARGE",t.COUNTUNIQUE="COUNTUNIQUE",t.BYROW="BYROW",t.BYCOL="BYCOL",t.CONFIDENCE="CONFIDENCE",t.DEVSQ="DEVSQ",t.AVEDEV="AVEDEV",t.STDEVP="STDEVP",t.STDEVS="STDEVS",t.VARP="VARP",t.VARS="VARS",t.AVERAGEA="AVERAGEA",t.PRODUCT="PRODUCT",t.SUMSQ="SUMSQ",t.SUMX2MY2="SUMX2MY2",t.SUMX2PY2="SUMX2PY2",t.SUMXMY2="SUMXMY2",t.MINVERSE="MINVERSE",t.MMULT="MMULT",t.MDETERM="MDETERM",t.CREER_MATRICE="CREER.MATRICE",t.APPLIQUER="APPLIQUER",t.REDUIRE="REDUIRE",t.ANALYSER="ANALYSER",t.CREER_ALEA_MATRICE="CREER.ALEA.MATRICE",t.BASCULER="BASCULER",t.SOUS_TOTAL="SOUS.TOTAL",t.PREVISION="PREVISION",t.TENDANCE="TENDANCE",t.DROITEREG="DROITEREG",t.LOGREG="LOGREG",t.CROISSANCE="CROISSANCE",t.RANG="RANG",t.PERCENTRANG="PERCENTRANG",t.CORRELATION="CORRELATION",t.COEFFICIENT_R2="COEFFICIENT.R2",t.ORDONNEE_ORIGINE="ORDONNEE.ORIGINE",t.PENTE="PENTE",t.CENTRER_REDUIRE="CENTRER.REDUIRE",t.PROBABILITE="PROBABILITE",t.BINOM_DIST="BINOM.DIST",t.PERMUTATION="PERMUTATION",t.LOI_NORMALE_INVERSE="LOI.NORMALE.INVERSE",t.LOI_NORMALE_STANDARD="LOI.NORMALE.STANDARD",t.LOI_NORMALE_STANDARD_INVERSE="LOI.NORMALE.STANDARD.INVERSE",t.LOI_T="LOI.T",t.INVERSE_LOI_T="INVERSE.LOI.T",t.LOI_F="LOI.F",t.INVERSE_LOI_F="INVERSE.LOI.F",t.TEST_KHIDEUX="TEST.KHIDEUX",t.INVERSE_LOI_KHIDEUX="INVERSE.LOI.KHIDEUX",t.TEST_Z="TEST.Z",t.TEST_T="TEST.T",t.TEST_F="TEST.F",t.MOYENNE_GEOMETRIQUE="MOYENNE.GEOMETRIQUE",t.MOYENNE_HARMONIQUE="MOYENNE.HARMONIQUE",t.MOYENNE_TRIMMEE="MOYENNE.TRIMMEE",t.PETIT="PETIT",t.GRAND="GRAND",t.NBVAL_UNIQUE="NBVAL.UNIQUE",t.PAR_LIGNE="PAR.LIGNE",t.PAR_COLONNE="PAR.COLONNE",t.INTERVALLE_CONFIANCE="INTERVALLE.CONFIANCE",t.SOMME_CARRES_ECARTS="SOMME.CARRES.ECARTS",t.MOYENNE_ECARTS="MOYENNE.ECARTS",t.ECARTYPE_POP="ECARTYPE.POP",t.ECARTYPE_ECHE="ECARTYPE.ECHE",t.VAR_POP="VAR.POP",t.VAR_ECHE="VAR.ECHE",t.MOYENNEA="MOYENNEA",t.PRODUIT="PRODUIT",t.SOMME_CARRES="SOMME.CARRES",t.SOMME_DIFF_CARRES="SOMME.DIFF.CARRES",t.SOMME_SOMME_CARRES="SOMME.SOMME.CARRES",t.SOMME_DIFF_CARRES_Y="SOMME.DIFF.CARRES.Y",t.INVERSE_MATRICE="INVERSE.MATRICE",t.PRODUIT_MATRICE="PRODUIT.MATRICE",t.DETERMINANT_MATRICE="DETERMINANT.MATRICE",t))(P||{});var s=class{original;childs=[];constructor(E){this.original=E}addChild(E){this.childs.push(E)}getChilds(){return this.childs}},f=class extends s{},M=class extends s{formula;constructor(E,n){super(E),this.formula=n}};var U=class extends s{operator;constructor(E){super(E),this.operator=E}},d=class extends s{sheet;column;row;isColumnAbsolute;isRowAbsolute;constructor(E,n,i,e,N,R){super(E),this.sheet=n,this.column=i,this.row=e,this.isColumnAbsolute=N,this.isRowAbsolute=R}getFullReference(){let E=this.sheet?`${this.sheet}!`:"",n=this.isColumnAbsolute?"$":"",i=this.isRowAbsolute?"$":"";return`${E}${n}${this.column}${i}${this.row}`}},g=class extends s{sheet;startCell;endCell;constructor(E,n,i,e){super(E),this.sheet=n,this.startCell=i,this.endCell=e}getFullReference(){return`${this.sheet?`${this.sheet}!`:""}${this.startCell.getFullReference().replace(/^.*!/,"")}:${this.endCell.getFullReference().replace(/^.*!/,"")}`}},B={useNestingIndicators:!0,useOperatorSpacing:!0,indentSize:4,maxInlineLength:40,maxInlineParams:3};var o=class{static formulaTypes=Object.values(P);static formulaTypesMap={...Object.entries(P).reduce((E,[,n])=>(E[n]=n,E),{})};static operators=["<=",">=","<>","!=","==","+","-","*","/","^","&","=","<",">"];static findOperatorAt(E,n){if(n<E.length-1){let e=E.substring(n,n+2);if(this.operators.includes(e))return e}let i=E.charAt(n);return this.operators.includes(i)?i:null}static parseCellReference(E){return E=E.trim(),E.includes(":")?this.parseCellRange(E):this.parseSingleCellReference(E)}static parseCellRange(E){let n=E.split(":");if(n.length!==2)return null;let[i,e]=n,N,R=i,O=e;if(R.includes("!")){let S=R.split("!");N=S[0].replace(/^'|'$/g,""),R=S[1]}let A=this.parseSingleCellReference(R),I=this.parseSingleCellReference(O);return!A||!I?null:new g(E,N,A,I)}static parseSingleCellReference(E){let n=/^(?:([^!]+)!)?(\$?)([A-Z]+)(\$?)(\d+)$/i,i=E.match(n);if(!i)return null;let[,e,N,R,O,A]=i,I=e?e.replace(/^'|'$/g,""):void 0;return new d(E,I,R.toUpperCase(),A,N==="$",O==="$")}static parseExpressions(E,n,i,e){let N="",R=n,O=!1;for(;R<i.length;){let A=i[R],I=R>0?i[R-1]:"";if(A==='"'&&I!=="\\"){O=!O,N+=A,R++;continue}if(O){N+=A,R++;continue}let S=this.findOperatorAt(i,R);if(A==="(")if(N.trim().length>0){let C=N.trim().toUpperCase();if(this.formulaTypes.includes(C)){let L=this.formulaTypesMap[C];L&&(R=this.parseFormula(E,L,R,i,e),N="")}else{let L=this.parseCellReference(N.trim());L?E.addChild(L):E.addChild(new s(N.trim())),N="";let _=new f("");E.addChild(_),R=this.parseExpressions(_,R+1,i,e)}}else{let C=new f("");E.addChild(C),R=this.parseExpressions(C,R+1,i,e)}else if(A===")"){if(N.trim().length>0){let C=this.parseCellReference(N.trim());C?E.addChild(C):E.addChild(new s(N.trim()))}return R}else if(S){if(N.trim().length>0){let C=this.parseCellReference(N.trim());C?E.addChild(C):E.addChild(new s(N.trim())),N=""}E.addChild(new U(S)),R+=S.length-1}else N+=A;R++}if(N.trim().length>0){let A=this.parseCellReference(N.trim());A?E.addChild(A):E.addChild(new s(N.trim()))}return R}static parseFormula(E,n,i,e,N){let R=new M("",n);E.addChild(R);let O=this.parserAdvanceTo("(",i,e),A="",I=0;for(;O<e.length;){if(e[O]===N&&I===0){if(A.trim().length>0){let S=new s(A.trim());if(this.parseExpressions(S,0,A,N),S.getChilds().length===1)R.addChild(S.getChilds()[0]);else if(S.getChilds().length>1)R.addChild(S);else{let C=this.parseCellReference(A.trim());C?R.addChild(C):R.addChild(new s(A.trim()))}}A=""}else{if(e[O]==="("?I++:e[O]===")"&&I--,I<0){if(A.trim().length>0){let S=new s(A.trim());if(this.parseExpressions(S,0,A,N),S.getChilds().length===1)R.addChild(S.getChilds()[0]);else if(S.getChilds().length>1)R.addChild(S);else{let C=this.parseCellReference(A.trim());C?R.addChild(C):R.addChild(new s(A.trim()))}}return O}A+=e[O]}O++}throw new Error(`Function ${n} is missing closing parenthesis`)}static parserAdvanceTo(E,n,i){let e=n;for(;e<i.length&&i[e]!==E;)e++;return e+1}static validateFormula(E){let n=0,i=!1,e=!1;for(let O=0;O<E.length;O++){let A=E[O],I=O>0?E[O-1]:"";if(A==="'"&&I!=="\\"){i=!i;continue}if(A==='"'&&I!=="\\"){e=!e;continue}if(!(i||e)){if(A==="(")n++;else if(A===")"&&(n--,n<0))throw new Error("Unexpected closing parenthesis ')'")}}if(i)throw new Error("Unclosed single quote in formula");if(e)throw new Error("Unclosed double quote in formula");if(n>0)throw new Error(`Missing ${n} closing parenthesis${n>1?"es":""} ')'`);let N=E.trim();if(N.length>0){let O=N[N.length-1];if(["+","-","*","/","=","<",">","&"].includes(O))throw new Error(`Formula cannot end with operator '${O}'`)}if(/[A-Z][A-Z0-9_]*\(\s*\)/gi.test(E)){let O=E.match(/([A-Z][A-Z0-9_]*)\(\s*\)/gi);if(O)throw new Error(`Function ${O[0].replace("()","")} has empty parentheses`)}}static parse(E){let n=E.trim();n.startsWith("=")&&(n=n.substring(1)),this.validateFormula(n);let i=n.includes(";")?";":",";try{let e=new s(n);return this.parseExpressions(e,0,n,i),e}catch(e){throw e instanceof Error?new Error(e.message):new Error("Invalid formula syntax")}}};var l=class{options;constructor(E={}){this.options={...B,...E}}format(E,n=!1){let i=this.prettyPrint(E,0);return(n?"=":"")+i}prettyPrint(E,n){let i=E.getChilds();if(i.length===0)return E.original||"";let e="";for(let N=0;N<i.length;N++){let R=i[N];R instanceof M?e+=this.formatFunction(R,n):R instanceof f?e+=this.formatSubExpression(R,n):R instanceof U?e+=this.formatOperator(R,N,i):R instanceof d?e+=this.formatCellReference(R):R instanceof g?e+=this.formatCellRange(R):R.getChilds().length===0?e+=R.original||"":e+=this.prettyPrint(R,n)}return e}formatFunction(E,n){let i=E.getChilds();if(i.length===0)return E.formula+"()";if(this.shouldFormatInline(E)){let N=E.formula+"(";for(let R=0;R<i.length;R++){let O=i[R],A=R===i.length-1;if(O instanceof M&&this.shouldFormatInline(O))N+=this.formatFunction(O,n+1);else if(O instanceof f)N+=this.formatSubExpression(O,n);else{let I=O.getChilds().length===0?O.original||"":this.prettyPrint(O,n);N+=I||""}A||(N+="; ")}return N+=")",N}let e=E.formula+`(
`;for(let N=0;N<i.length;N++){let R=i[N],O=N===i.length-1;if(e+=this.indent(n+1),this.options.useNestingIndicators&&(e+=this.getNestingIndicator(n+1,O)),R instanceof M){let A=this.formatFunction(R,n+1);e+=A}else if(R instanceof f){let A=this.formatSubExpression(R,n+1);e+=A}else{let A=R.getChilds().length===0?R.original||"":this.prettyPrint(R,n+1);e+=A||""}O?e+=")":(e+=";",e+=`
`)}return e}shouldFormatInline(E){let n=E.getChilds();if(n.length===0||n.length===1){if(n.length===1){let i=n[0];return i instanceof M||i instanceof f&&this.containsFunction(i)?!1:(i.original||this.prettyPrint(i,0)).length<=30}return!0}if(n.length<=(this.options.maxInlineParams||3)){let i=0;for(let e of n){if(e instanceof M||e instanceof f&&this.containsFunction(e))return!1;let N=e.original||this.prettyPrint(e,0);if(i+=N.length,i>(this.options.maxInlineLength||40))return!1}return i<=(this.options.maxInlineLength||40)}return!1}formatSubExpression(E,n){let i=this.prettyPrint(E,n);return!i.includes(`
`)&&i.length<50&&!this.containsFunction(E)?"("+i+")":`(
`+this.indent(n+1)+i+`
`+this.indent(n)+")"}formatOperator(E,n,i){if(!this.options.useOperatorSpacing)return E.operator;let e=E.operator,N="",R=n>0?i[n-1]:null,O=n+1<i.length?i[n+1]:null,A=this.shouldSpaceBeforeOperator(e,R),I=this.shouldSpaceAfterOperator(e);return A&&(N+=" "),N+=e,I&&(N+=" "),O instanceof M&&!this.shouldFormatInline(O)&&(N+=`
`),N}shouldSpaceBeforeOperator(E,n){if(E==="-"){if(!n)return!1;if(n instanceof U){let i=n.operator;if(["+","-","*","/","^","=","<",">","<=",">=","<>","!=","==","("].includes(i))return!1}}return E!==":"}shouldSpaceAfterOperator(E){return E!==":"}formatCellReference(E){return E.getFullReference()}formatCellRange(E){return E.getFullReference()}containsFunction(E){return E instanceof M?!0:E.getChilds().some(n=>this.containsFunction(n))}needsSpacing(E,n){return E instanceof M||n instanceof M||E instanceof U||n instanceof U,!1}indent(E){return" ".repeat(this.options.indentSize||4).repeat(E)}getNestingIndicator(E,n=!1){if(E===0)return"";let i="  ".repeat(Math.max(0,E-1));return E===1?n?"\u2514\u2500 ":"\u251C\u2500 ":i+(n?"\u2514\u2500 ":"\u251C\u2500 ")}};var V=class{static rawText(E,n){let i=E.trim().startsWith("="),e=o.parse(E);return new l(n).format(e,i)}};var h=require("react/jsx-runtime");function H(){let[r,E]=(0,D.useState)(""),[n,i]=(0,D.useState)(""),e=(0,D.useCallback)(A=>{if(!A.trim()){i("");return}try{let I=A.trim().startsWith("=")?A.trim():"="+A.trim(),S=V.rawText(I);i(S),(0,c.showToast)({style:c.Toast.Style.Success,title:"Formula beautified"})}catch(I){i(""),(0,c.showToast)({style:c.Toast.Style.Failure,title:"Invalid Excel formula",message:I instanceof Error?I.message:String(I)})}},[]);(0,D.useEffect)(()=>{let A=setTimeout(()=>{e(r)},300);return()=>clearTimeout(A)},[r,e]);let N=A=>{E(A)},R=()=>{E(""),i("")},O=()=>n;return(0,h.jsxs)(c.Form,{actions:(0,h.jsxs)(c.ActionPanel,{children:[(0,h.jsx)(c.Action,{title:"Clear",onAction:R,shortcut:{modifiers:["cmd"],key:"l"}}),n&&(0,h.jsx)(c.Action.CopyToClipboard,{title:"Copy Beautified Formula",content:n,shortcut:{modifiers:["cmd"],key:"c"}}),r&&(0,h.jsx)(c.Action.CopyToClipboard,{title:"Copy Original Formula",content:r.trim().startsWith("=")?r.trim():"="+r.trim(),shortcut:{modifiers:["cmd","shift"],key:"c"}})]}),children:[(0,h.jsx)(c.Form.TextArea,{id:"formula",title:"Excel Formula",placeholder:"Enter your Excel formula here (e.g., =SUM(A1:B10)+IF(C1>0,D1*2,IF(C1>0,D1*2,0))",value:r,onChange:N,info:"Type your formula and see the beautified result below"}),(0,h.jsx)(c.Form.Separator,{}),n&&(0,h.jsx)(c.Form.TextArea,{id:"beautified",title:"Beautified Result",value:O(),onChange:()=>{}})]})}
